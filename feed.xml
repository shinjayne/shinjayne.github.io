<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.4.3">Jekyll</generator><link href="https://shinjayne.github.io//feed.xml" rel="self" type="application/atom+xml" /><link href="https://shinjayne.github.io//" rel="alternate" type="text/html" /><updated>2017-08-08T15:09:12+09:00</updated><id>https://shinjayne.github.io//</id><title type="html">shinjayne</title><subtitle>shinjayne`s Developer Blog. 신재인의 개발 블로그. Fly with Deep Learning! Deep Leanring / Server(Linux) / Android / etc ...</subtitle><entry><title type="html">open-AI 의 gym (python package) 이용해 강화학습 훈련하기 1: Q-learning</title><link href="https://shinjayne.github.io//deeplearning/2017/08/08/open-ai-gym.html" rel="alternate" type="text/html" title="open-AI 의 gym (python package) 이용해 강화학습 훈련하기 1: Q-learning " /><published>2017-08-08T03:43:50+09:00</published><updated>2017-08-08T03:43:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/08/08/open-ai-gym</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/08/08/open-ai-gym.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;open-AI 에서 파이썬 패키지로 제공하는 gym 을 이용하면 , 손쉽게 강화학습 환경을 구성할 수 있다.&lt;/p&gt;
&lt;p&gt;gym package 를 이용해서 강화학습 훈련 환경을 만들어보고, Q-learning 이라는 강화학습 알고리즘에 대해 알아보고 적용시켜보자.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;blockquote&gt;&lt;h3 id=&quot;&amp;#47785;&amp;#52264;&quot;&gt;&amp;#47785;&amp;#52264;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#47785;&amp;#52264;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;#1.-gym-package-이용하기&quot;&gt;1. gym package 이용하기&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#2.-Q-learning-이란?&quot;&gt;2. Q-learning 이란? &lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;#Q-learning-의-학습-(Greedy,-Dummy&quot;&gt;2-1. Q-learning 의 학습(Dummy Q learning)&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#Dummy-Q-learning-학습---python-code&quot;&gt;2-2. Dummy Q-learning python code&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;#3.-완벽한-Q-learning-(-Dummy-Q-learning-의-문제-&quot;&gt;3. 완벽한 Q-learning ( Dummy Q-learning 의 문제 )&lt;/a&gt;)&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;#해결책-1-:--E-greedy&quot;&gt;3-1. 해결책 1 :  E-greedy &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#해결책-2-:-add-Random-noise&quot;&gt;3-2. 해결책 2 : add Random Noise&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#새로운-문제-:-여러-경로가-생긴다&quot;&gt;3-3. 새로운 문제 : 여러 경로 &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#Q-learning-python-코드와-실행결과&quot;&gt;3-4. 완벽한 Q-learning python code &lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;1.-gym-package-&amp;#51060;&amp;#50857;&amp;#54616;&amp;#44592;&quot;&gt;1. gym package &amp;#51060;&amp;#50857;&amp;#54616;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-gym-package-&amp;#51060;&amp;#50857;&amp;#54616;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;open-AI 에서 만든 gym 이란 파이썬 패키지를 이용하면 강화학습( Reinforcement Learning ) 훈련을 수행할 수 있는 Agent와 Environment 를 제공받을 수 있다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://gym.openai.com/&quot;&gt;open-AI gym 홈페이지&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;gym 을 간단하게 pip install 통해서 설치할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# command line (bash)&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readchar&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;실제로 gym 을 사용해본다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# gym_example.py&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym.envs.registration&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;readchar&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DOWN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;RIGHT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;UP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;arrow_keys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1b&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;[A&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1b&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;[B&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DOWN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1b&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;[C&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RIGHT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x1b&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;[D&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LEFT&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FrozenLake-v3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;gym.envs.toy_text:FrozenLakeEnv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;map_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;4x4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;is_slippery&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;


&lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;여기서부터 gym 코드의 시작이다. env 는 agent 가 활동할 수 있는 environment 이다.&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;FrozenLake-v3&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#환경을 화면으로 출력&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readchar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readkey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#키보드 입력을 받는다 &lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arrow_keys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Game aborted!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        
    &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arrow_keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#에이젼트의 움직임&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#움직임에 따른 결과값들 &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#화면을 다시 출력&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;State:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Action&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Reward:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Info:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#도착하면 게임을 끝낸다. &lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Finished with reward&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위와 같은 코드로, 내가 직접 게임을 진행해볼 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;2.-Q-learning-&amp;#51060;&amp;#46976;?&quot;&gt;2. Q-learning &amp;#51060;&amp;#46976;?&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Q-learning-&amp;#51060;&amp;#46976;?&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/1.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위의 gym-example.py 코드같은 environment 에서, agent 가 무작위로 방향을 결정하면 학습이 잘 되지 않는다.&lt;/p&gt;
&lt;p&gt;시도 횟수는 엄청 많은데에 비해 reward는 성공할 때 한번만 지급되기 때문이다.&lt;/p&gt;
&lt;p&gt;그에 대한 해결책이 바로 Q-learning 이다.&lt;/p&gt;
&lt;p&gt;agent는 방향을 결정해야할 때마다 가상의 Q 에게 행보를 물어본다.&lt;/p&gt;
&lt;p&gt;Q 는 agent 의 state를 보고 그가 action1 을 취하면 기대되는 reward1(quality1) 을 알려주고, action2 를 취하면 기대되는 reward2(quality2) 를 알려준다.&lt;/p&gt;
&lt;p&gt;agent 는 Q의 도움을 받아 더 빠른 학습이 가능하다.&lt;/p&gt;
&lt;p&gt;수식적으로는&lt;/p&gt;
&lt;p&gt;Q(s, a) = π  처럼 쓸 수 있으며&lt;/p&gt;
&lt;p&gt;현재 s(state)에서 취할수 있는 가장 큰 reward 인 max Q  max(Q(s,a)) 로&lt;/p&gt;
&lt;p&gt;현재 s(state)에서 max(Q(s,a))로 가게 해주는 action 은 argmax(Q(s,a)) 로 표현한다.&lt;/p&gt;
&lt;p&gt;argmax(Q(s,a))는 π*(s) 로도 표현하며 여기서 *은 optimal 함을 의미한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/2.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Q-learning-&amp;#51032;-&amp;#54617;&amp;#49845;-(Greedy,-Dummy)&quot;&gt;Q-learning &amp;#51032; &amp;#54617;&amp;#49845; (Greedy, Dummy)&lt;a class=&quot;anchor-link&quot; href=&quot;#Q-learning-&amp;#51032;-&amp;#54617;&amp;#49845;-(Greedy,-Dummy)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Q-learning 알고리즘에서 학습한다는 것은 아래 그림처럼 모두 0으로 초기화되어있는 모든 Q 값들을 하나씩 업데이트시킨다는 것과 같다.&lt;/p&gt;
&lt;p&gt;모든 칸의 0은 각각의 Q(s,a) 값을 나타낸다.&lt;/p&gt;
&lt;p&gt;도착지점으로 넘어갈 때에만 reward = 1 이 주어지고, 나머지 부분으로 넘어갈 때에는 reward = 0 이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;우선 각 칸의 Q 값을 업데이트 하는 방법은 다음과같다.&lt;/p&gt;
&lt;p&gt;Q(s,a) 의 값은 (다음칸의 Q 중 가장 큰 값 + reward) 로 표현해서 적는다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;처음에는 어디로 가든 reward 도 0이고 max Q(s', a') 도 0이다. 그래서 agent가 무작위로 방향을 결정한다. 그러다 우연히 아래 그림처럼 도착지점 바로 왼쪽칸에 도착했다.&lt;/p&gt;
&lt;p&gt;이때 Q(s14, right) 의 값은 reward = 1 값 더하기 maxQ(s15,a') = 0 으로 1 로 업데이트된다.&lt;/p&gt;
&lt;p&gt;이게 첫번째 학습이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;한번 학습이 끝난 후 agent 는 다시 시작지점에서 출발한다. 역시나 대부분의 Q가 0으로 초기화되어있고, 주변의 reward 도 0이기 때문에 무작위로 나아간다.&lt;/p&gt;
&lt;p&gt;그러다 다시 우연히 s13 칸에 도착했다고 하자.&lt;/p&gt;
&lt;p&gt;이때 Q(s13,right) 를 계산해보았더니, reward = 0 이지만 max Q(s',a') 이 1이다.&lt;/p&gt;
&lt;p&gt;이렇게 다시 Q(s13,right) = 1 로 업데이트하고 다시 agent 를 시작점으로 보낸다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;이런식으로 계속해서 학습을 하다보면 결국 아래 그림처럼 시작 지점의 Q 까지 학습이 되고, 이렇게 Dummy Q-learning 의 학습이 끝난다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;루틴을 정리하자면 다음과 같다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dummy-Q-learning-&amp;#54617;&amp;#49845;---python-code&quot;&gt;Dummy Q-learning &amp;#54617;&amp;#49845; - python code&lt;a class=&quot;anchor-link&quot; href=&quot;#Dummy-Q-learning-&amp;#54617;&amp;#49845;---python-code&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# dummy_q_learning.py&lt;/span&gt;


&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym.envs.registration&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pr&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;qmax_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;four_q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; 상태 s 에서 네가지 a 에 따른 네가지 Q 중 가장 큰 것을 선택 (같으면 랜덤하게 선택)&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;maxq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;four_q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonzero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;four_q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FrozenLake-v3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gym.envs.toy_text:FrozenLakeEnv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;map_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;4x4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;is_slippery&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FrozenLake-v3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# shape = [States num, 4(left,down,right,up)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set learning parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create lists to contain total rewards and steps per episode&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reset environment and get first new observation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# The Q-Table learning algorithm&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;qmax_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Get new state and reward from environment&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Update Q-Table with new knowledge using learning rate&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Success rate: &amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Final Q-Table Values&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;LEFT DOWN RIGHT UP&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;3.-&amp;#50756;&amp;#48317;&amp;#54620;-Q-learning-(-Dummy-Q-learning-&amp;#51032;-&amp;#47928;&amp;#51228;-)&quot;&gt;3. &amp;#50756;&amp;#48317;&amp;#54620; Q-learning ( Dummy Q-learning &amp;#51032; &amp;#47928;&amp;#51228; )&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-&amp;#50756;&amp;#48317;&amp;#54620;-Q-learning-(-Dummy-Q-learning-&amp;#51032;-&amp;#47928;&amp;#51228;-)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;dummy Q-learning 의 문제는 아래 그림처럼 가장 optimal 한 경로를 따라 Q 가 업데이트 되지 않을 수 있는 가능성이 있다는 것이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/3_1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;해결할 수 있는 방법은 단 하나다.&lt;/p&gt;
&lt;p&gt;가끔은 최적의 Q로 이동하는 action 이 아닌 랜덤한 action을 취해주는 것이다.&lt;/p&gt;
&lt;p&gt;(예를들어 위 그림에서 첫번째 state 일때, 오른쪽으로 가지 않고 한번 아래로 가보는 action을 취해보는 것이다.)&lt;/p&gt;
&lt;p&gt;그 방법으로 2가지가 있다.&lt;/p&gt;
&lt;blockquote&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;E-greedy (랜덤한 확률로 아무데나 가본다.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;add Random noise (Q 에 random noise 를 더해 랜덤한 action 을 취한다.)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;위 두가지에 대해 자세히 알아보자.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;&amp;#54644;&amp;#44208;&amp;#52293;-1-:--E-greedy&quot;&gt;&amp;#54644;&amp;#44208;&amp;#52293; 1 :  E-greedy&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#54644;&amp;#44208;&amp;#52293;-1-:--E-greedy&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;일정 확률로 가끔은 최적의 action 을 따라가지 않도록 설정한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;&amp;#54644;&amp;#44208;&amp;#52293;-2-:-add-Random-noise&quot;&gt;&amp;#54644;&amp;#44208;&amp;#52293; 2 : add Random noise&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#54644;&amp;#44208;&amp;#52293;-2-:-add-Random-noise&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/9.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;action 을 결정할 때 참고하는 각 Q 값에 random 한 noise 를 주어서 action 이 조금 random 해지도록  한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;&amp;#49352;&amp;#47196;&amp;#50868;-&amp;#47928;&amp;#51228;-:-&amp;#50668;&amp;#47084;-&amp;#44221;&amp;#47196;&amp;#44032;-&amp;#49373;&amp;#44596;&amp;#45796;&quot;&gt;&amp;#49352;&amp;#47196;&amp;#50868; &amp;#47928;&amp;#51228; : &amp;#50668;&amp;#47084; &amp;#44221;&amp;#47196;&amp;#44032; &amp;#49373;&amp;#44596;&amp;#45796;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#49352;&amp;#47196;&amp;#50868;-&amp;#47928;&amp;#51228;-:-&amp;#50668;&amp;#47084;-&amp;#44221;&amp;#47196;&amp;#44032;-&amp;#49373;&amp;#44596;&amp;#45796;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위와 같이 dummy Q learning 문제를 보완하는 기법들을 사용하면 agent 가 최종적으로 경로를 결정하려고 할 때 선택의 문제에 놓인다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이런 상황을 막으려면 학습과정에서 Q를 업데이트할 때, 다음 max Q(s', a') 값에다 특정 감마(\&amp;lt;1) 값을 곱해준다.&lt;/p&gt;
&lt;p&gt;그러면 상대적으로 구불하고 긴 경로로 인도하는 Q 값들은 작아지고, 가장 짧은 경로로 인도하는 Q 값들은 커진다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/11.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Q-learning-python-&amp;#53076;&amp;#46300;&amp;#50752;-&amp;#49892;&amp;#54665;&amp;#44208;&amp;#44284;&quot;&gt;Q-learning python &amp;#53076;&amp;#46300;&amp;#50752; &amp;#49892;&amp;#54665;&amp;#44208;&amp;#44284;&lt;a class=&quot;anchor-link&quot; href=&quot;#Q-learning-python-&amp;#53076;&amp;#46300;&amp;#50752;-&amp;#49892;&amp;#54665;&amp;#44208;&amp;#44284;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# q_learning.py&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gym.envs.registration&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pr&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FrozenLake-v3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gym.envs.toy_text:FrozenLakeEnv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;map_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;4x4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;is_slippery&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gym&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FrozenLake-v3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize table with all zeros&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;1. Q 값이 업데이트될 때 maxQ(s&amp;#39;,a&amp;#39;) 에 곱할 감마 값을 설정한다.&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create lists to contain total rewards and steps per episode&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reset environment and get first new observation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;2. E-Greedy 를 위한 확률값을 만들어준다. (step i이 지남에 따라 decay 되도록 설정)&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  

    &lt;span class=&quot;c1&quot;&gt;# The Q-Table learning algorithm : 한번 수행할 때 마다 Q 한칸 업데이트&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;E-Greedy 를 따라 작은 확률로 랜덤하게 가고, 큰 확률로 높은 Q 를 따르는 쪽으로 간다.&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_space&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Get new state and reward from environment&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Update Q-Table with new knowledge using learning rate&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_state&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Success rate: &amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_episodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Final Q-Table Values&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/aigym/12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">open-AI 에서 파이썬 패키지로 제공하는 gym 을 이용하면 , 손쉽게 강화학습 환경을 구성할 수 있다. gym package 를 이용해서 강화학습 훈련 환경을 만들어보고, Q-learning 이라는 강화학습 알고리즘에 대해 알아보고 적용시켜보자. &amp;#47785;&amp;#52264;&amp;#182;1. gym package 이용하기 2. Q-learning 이란? 2-1. Q-learning 의 학습(Dummy Q learning)) 2-2. Dummy Q-learning python code 3. 완벽한 Q-learning ( Dummy Q-learning 의 문제 )) 3-1. 해결책 1 : E-greedy 3-2. 해결책 2 : add Random Noise 3-3. 새로운 문제 : 여러 경로 3-4. 완벽한 Q-learning python code 1. gym package &amp;#51060;&amp;#50857;&amp;#54616;&amp;#44592;&amp;#182; open-AI 에서 만든 gym 이란 파이썬 패키지를 이용하면 강화학습( Reinforcement Learning ) 훈련을 수행할 수 있는 Agent와 Environment 를 제공받을 수 있다. open-AI gym 홈페이지 gym 을 간단하게 pip install 통해서 설치할 수 있다. In&amp;nbsp;[&amp;nbsp;]: # command line (bash) $ pip install gym $ pip install readchar 실제로 gym 을 사용해본다. In&amp;nbsp;[&amp;nbsp;]: # gym_example.py import gym from gym.envs.registration import register import readchar LEFT = 0 DOWN = 1 RIGHT = 2 UP = 3 arrow_keys = { &amp;#39;\x1b[A&amp;#39; : UP, &amp;#39;\x1b[B&amp;#39; : DOWN, &amp;#39;\x1b[C&amp;#39; : RIGHT, &amp;#39;\x1b[D&amp;#39; : LEFT } register( id=&amp;#39;FrozenLake-v3&amp;#39;, entry_point=&amp;quot;gym.envs.toy_text:FrozenLakeEnv&amp;quot;, kwargs={&amp;#39;map_name&amp;#39;:&amp;#39;4x4&amp;#39;,&amp;#39;is_slippery&amp;#39;:False}) &amp;#39;&amp;#39;&amp;#39;여기서부터 gym 코드의 시작이다. env 는 agent 가 활동할 수 있는 environment 이다.&amp;#39;&amp;#39;&amp;#39; env = gym.make(&amp;quot;FrozenLake-v3&amp;quot;) env.render() #환경을 화면으로 출력 while True: key = readchar.readkey() #키보드 입력을 받는다 if key not in arrow_keys.keys(): print(&amp;quot;Game aborted!&amp;quot;) break action = arrow_keys[key] #에이젼트의 움직임 state, reward, done, info = env.step(action) #움직임에 따른 결과값들 env.render() #화면을 다시 출력 print(&amp;quot;State:&amp;quot;, state, &amp;quot;Action&amp;quot;, action, &amp;quot;Reward:&amp;quot;, reward, &amp;quot;Info:&amp;quot;, info) if done: #도착하면 게임을 끝낸다. print(&amp;quot;Finished with reward&amp;quot;, reward) break 위와 같은 코드로, 내가 직접 게임을 진행해볼 수 있다. 2. Q-learning &amp;#51060;&amp;#46976;?&amp;#182; 위의 gym-example.py 코드같은 environment 에서, agent 가 무작위로 방향을 결정하면 학습이 잘 되지 않는다. 시도 횟수는 엄청 많은데에 비해 reward는 성공할 때 한번만 지급되기 때문이다. 그에 대한 해결책이 바로 Q-learning 이다. agent는 방향을 결정해야할 때마다 가상의 Q 에게 행보를 물어본다. Q 는 agent 의 state를 보고 그가 action1 을 취하면 기대되는 reward1(quality1) 을 알려주고, action2 를 취하면 기대되는 reward2(quality2) 를 알려준다. agent 는 Q의 도움을 받아 더 빠른 학습이 가능하다. 수식적으로는 Q(s, a) = π 처럼 쓸 수 있으며 현재 s(state)에서 취할수 있는 가장 큰 reward 인 max Q max(Q(s,a)) 로 현재 s(state)에서 max(Q(s,a))로 가게 해주는 action 은 argmax(Q(s,a)) 로 표현한다. argmax(Q(s,a))는 π*(s) 로도 표현하며 여기서 *은 optimal 함을 의미한다. Q-learning &amp;#51032; &amp;#54617;&amp;#49845; (Greedy, Dummy)&amp;#182; Q-learning 알고리즘에서 학습한다는 것은 아래 그림처럼 모두 0으로 초기화되어있는 모든 Q 값들을 하나씩 업데이트시킨다는 것과 같다. 모든 칸의 0은 각각의 Q(s,a) 값을 나타낸다. 도착지점으로 넘어갈 때에만 reward = 1 이 주어지고, 나머지 부분으로 넘어갈 때에는 reward = 0 이다. 우선 각 칸의 Q 값을 업데이트 하는 방법은 다음과같다. Q(s,a) 의 값은 (다음칸의 Q 중 가장 큰 값 + reward) 로 표현해서 적는다. 처음에는 어디로 가든 reward 도 0이고 max Q(s', a') 도 0이다. 그래서 agent가 무작위로 방향을 결정한다. 그러다 우연히 아래 그림처럼 도착지점 바로 왼쪽칸에 도착했다. 이때 Q(s14, right) 의 값은 reward = 1 값 더하기 maxQ(s15,a') = 0 으로 1 로 업데이트된다. 이게 첫번째 학습이다. 한번 학습이 끝난 후 agent 는 다시 시작지점에서 출발한다. 역시나 대부분의 Q가 0으로 초기화되어있고, 주변의 reward 도 0이기 때문에 무작위로 나아간다. 그러다 다시 우연히 s13 칸에 도착했다고 하자. 이때 Q(s13,right) 를 계산해보았더니, reward = 0 이지만 max Q(s',a') 이 1이다. 이렇게 다시 Q(s13,right) = 1 로 업데이트하고 다시 agent 를 시작점으로 보낸다. 이런식으로 계속해서 학습을 하다보면 결국 아래 그림처럼 시작 지점의 Q 까지 학습이 되고, 이렇게 Dummy Q-learning 의 학습이 끝난다. 루틴을 정리하자면 다음과 같다. Dummy Q-learning &amp;#54617;&amp;#49845; - python code&amp;#182; In&amp;nbsp;[&amp;nbsp;]: # dummy_q_learning.py import gym import numpy as np import matplotlib.pyplot as plt from gym.envs.registration import register import random as pr def qmax_action(four_q): &amp;quot;&amp;quot;&amp;quot; 상태 s 에서 네가지 a 에 따른 네가지 Q 중 가장 큰 것을 선택 (같으면 랜덤하게 선택)&amp;quot;&amp;quot;&amp;quot; maxq = np.amax(four_q) indices = np.nonzero(four_q == maxq)[0] return pr.choice(indices) register( id=&amp;#39;FrozenLake-v3&amp;#39;, entry_point=&amp;#39;gym.envs.toy_text:FrozenLakeEnv&amp;#39;, kwargs={&amp;#39;map_name&amp;#39;: &amp;#39;4x4&amp;#39;, &amp;#39;is_slippery&amp;#39;: False} ) env = gym.make(&amp;#39;FrozenLake-v3&amp;#39;) # shape = [States num, 4(left,down,right,up)] Q = np.zeros([env.observation_space.n, env.action_space.n]) # Set learning parameters num_episodes = 2000 # create lists to contain total rewards and steps per episode rList = [] for i in range(num_episodes): # Reset environment and get first new observation state = env.reset() rAll = 0 done = False # The Q-Table learning algorithm while not done: action = qmax_action(Q[state, :]) # Get new state and reward from environment new_state, reward, done, _ = env.step(action) # Update Q-Table with new knowledge using learning rate Q[state, action] = reward + np.max(Q[new_state, :]) rAll += reward state = new_state rList.append(rAll) print(&amp;quot;Success rate: &amp;quot; + str(sum(rList) / num_episodes)) print(&amp;quot;Final Q-Table Values&amp;quot;) print(&amp;quot;LEFT DOWN RIGHT UP&amp;quot;) print(Q) plt.bar(range(len(rList)), rList, color=&amp;quot;blue&amp;quot;) plt.show() 3. &amp;#50756;&amp;#48317;&amp;#54620; Q-learning ( Dummy Q-learning &amp;#51032; &amp;#47928;&amp;#51228; )&amp;#182; dummy Q-learning 의 문제는 아래 그림처럼 가장 optimal 한 경로를 따라 Q 가 업데이트 되지 않을 수 있는 가능성이 있다는 것이다. 해결할 수 있는 방법은 단 하나다. 가끔은 최적의 Q로 이동하는 action 이 아닌 랜덤한 action을 취해주는 것이다. (예를들어 위 그림에서 첫번째 state 일때, 오른쪽으로 가지 않고 한번 아래로 가보는 action을 취해보는 것이다.) 그 방법으로 2가지가 있다. E-greedy (랜덤한 확률로 아무데나 가본다.) add Random noise (Q 에 random noise 를 더해 랜덤한 action 을 취한다.) 위 두가지에 대해 자세히 알아보자. &amp;#54644;&amp;#44208;&amp;#52293; 1 : E-greedy&amp;#182; 일정 확률로 가끔은 최적의 action 을 따라가지 않도록 설정한다. &amp;#54644;&amp;#44208;&amp;#52293; 2 : add Random noise&amp;#182; action 을 결정할 때 참고하는 각 Q 값에 random 한 noise 를 주어서 action 이 조금 random 해지도록 한다. &amp;#49352;&amp;#47196;&amp;#50868; &amp;#47928;&amp;#51228; : &amp;#50668;&amp;#47084; &amp;#44221;&amp;#47196;&amp;#44032; &amp;#49373;&amp;#44596;&amp;#45796;&amp;#182; 위와 같이 dummy Q learning 문제를 보완하는 기법들을 사용하면 agent 가 최종적으로 경로를 결정하려고 할 때 선택의 문제에 놓인다. 이런 상황을 막으려면 학습과정에서 Q를 업데이트할 때, 다음 max Q(s', a') 값에다 특정 감마(\&amp;lt;1) 값을 곱해준다. 그러면 상대적으로 구불하고 긴 경로로 인도하는 Q 값들은 작아지고, 가장 짧은 경로로 인도하는 Q 값들은 커진다. Q-learning python &amp;#53076;&amp;#46300;&amp;#50752; &amp;#49892;&amp;#54665;&amp;#44208;&amp;#44284;&amp;#182; In&amp;nbsp;[&amp;nbsp;]: # q_learning.py import gym import numpy as np import matplotlib.pyplot as plt from gym.envs.registration import register import random as pr register( id=&amp;#39;FrozenLake-v3&amp;#39;, entry_point=&amp;#39;gym.envs.toy_text:FrozenLakeEnv&amp;#39;, kwargs={&amp;#39;map_name&amp;#39;: &amp;#39;4x4&amp;#39;, &amp;#39;is_slippery&amp;#39;: False} ) env = gym.make(&amp;#39;FrozenLake-v3&amp;#39;) # Initialize table with all zeros Q = np.zeros([env.observation_space.n, env.action_space.n]) &amp;#39;&amp;#39;&amp;#39;1. Q 값이 업데이트될 때 maxQ(s&amp;#39;,a&amp;#39;) 에 곱할 감마 값을 설정한다.&amp;#39;&amp;#39;&amp;#39; dis = .99 num_episodes = 2000 # create lists to contain total rewards and steps per episode rList = [] for i in range(num_episodes): # Reset environment and get first new observation state = env.reset() rAll = 0 done = False &amp;#39;&amp;#39;&amp;#39;2. E-Greedy 를 위한 확률값을 만들어준다. (step i이 지남에 따라 decay 되도록 설정)&amp;#39;&amp;#39;&amp;#39; e = 1. / ((i // 100) + 1) # The Q-Table learning algorithm : 한번 수행할 때 마다 Q 한칸 업데이트 while not done: &amp;#39;&amp;#39;&amp;#39;E-Greedy 를 따라 작은 확률로 랜덤하게 가고, 큰 확률로 높은 Q 를 따르는 쪽으로 간다.&amp;#39;&amp;#39;&amp;#39; if np.random.rand(1) &amp;lt; e: action = env.action_space.sample() else: action = np.argmax(Q[state, :]) # Get new state and reward from environment new_state, reward, done, _ = env.step(action) # Update Q-Table with new knowledge using learning rate Q[state, action] = reward + dis * np.max(Q[new_state, :]) rAll += reward state = new_state rList.append(rAll) print(&amp;quot;Success rate: &amp;quot; + str(sum(rList) / num_episodes)) print(&amp;quot;Final Q-Table Values&amp;quot;) print(Q) plt.bar(range(len(rList)), rList, color=&amp;quot;blue&amp;quot;) plt.show()</summary></entry><entry><title type="html">Auto Encoder 에 대하여 : Auto Encoder 의 개념과 사용법, 그리고 Regularization</title><link href="https://shinjayne.github.io//deeplearning/2017/08/02/udemy-ae.html" rel="alternate" type="text/html" title="Auto Encoder 에 대하여 : Auto Encoder 의 개념과 사용법, 그리고 Regularization" /><published>2017-08-02T21:21:50+09:00</published><updated>2017-08-02T21:21:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/08/02/udemy-ae</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/08/02/udemy-ae.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Autoencoder 의 간략한 구조는 위와 같다.&lt;/p&gt;
&lt;p&gt;=&amp;gt; self supervised learning 에 가깝다.&lt;/p&gt;
&lt;p&gt;자기 자신을 target(label) 값으로 사용하기 때문이다.&lt;/p&gt;
&lt;p&gt;가운데 초록색 노드들(Hidden nodes) 을 coding layer, 또는 bottleneck 이라고 부른다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;1.-Autoencoder-&amp;#47484;-&amp;#50612;&amp;#46356;&amp;#50640;-&amp;#50416;&amp;#45208;&quot;&gt;1. Autoencoder &amp;#47484; &amp;#50612;&amp;#46356;&amp;#50640; &amp;#50416;&amp;#45208;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Autoencoder-&amp;#47484;-&amp;#50612;&amp;#46356;&amp;#50640;-&amp;#50416;&amp;#45208;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;
&lt;strong&gt;1.feature detection &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;학습된 autoencoder에서는 coding layer 가 input 의 중요한 feature 들을 나타내게된다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.recommendation system&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;추후 튜토리얼을 확인하자.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.encoding &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Decoder로 디코딩할수 있는 코드로 input 값을 encoding(암호화) 하는 기능을 할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;2.-Autoencoder-&amp;#51032;-&amp;#51089;&amp;#46041;&quot;&gt;2. Autoencoder &amp;#51032; &amp;#51089;&amp;#46041;&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Autoencoder-&amp;#51032;-&amp;#51089;&amp;#46041;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://probablydance.com/2016/04/30/neural-networks-are-impressively-good-at-compression/&quot;&gt;이 사이트&lt;/a&gt; 를 참고한 모델을 설명한다.&lt;/p&gt;
&lt;p&gt;주로 activation function 으로 tanh 를 사용한다. (hidden 직전과 visible 직전에)&lt;/p&gt;
&lt;p&gt;output 값에 softmax 를 사용한다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;3.-Autoencoder-&amp;#51032;-Bias&quot;&gt;3. Autoencoder &amp;#51032; Bias&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Autoencoder-&amp;#51032;-Bias&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이렇게 Bias 를 추가할 수도 있고, 그림으론 이렇게 표현한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;4.-Autoencoder-&amp;#51032;-Training&quot;&gt;4. Autoencoder &amp;#51032; Training&lt;a class=&quot;anchor-link&quot; href=&quot;#4.-Autoencoder-&amp;#51032;-Training&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;step&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;내용&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;부가&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;input vector x_u = (r1,r2,.., ri,...,rm) 은 user u 의 m개의 영화에 대한 rating이다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;rating은 1~5 사이의 값이고, rating 없으면 0이다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;input vector(user 단위) 가 하나 network 로 들어간다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;3&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;input vector x_u 는 vector z 로 인코딩된다.x 에서 z 로 갈 때 mapping function 에 의해 차원이 축소된다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;mapping function : z = f(Wx+b) (f : sigmoid, tanh , etc)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;z 가 output vector y로 decoding 된다. y는 x vector 와 같은 차원을 가진다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;y가 x의 복사본이 되게 하는 것이 학습의 목적이다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;5&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;reconstruction error d(x,y) 를 계산한다. 이 error function 을 최소화시킨다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;error function : d(x,y)=//x-y//&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;6&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;back-propagation 을 이용해, error 의 값이 역전파되고, W,b 값들이 tuning 된다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;learning rate 에 따라 학습 정도가 달라진다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;7&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;step 1~6 을 반복하면서 파라메터들을 업데이트한다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;만약 vector 하나씩 넣으면서 update 시키면 Reinforcement Learning 이고, 여러 batch 씩 한꺼번에 넣으면서 학습시키면 Batch Learning&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;8&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;전체 데이터셋을 한번 다 학습시켰다면, epoch 단위로 몇번 더 학습한다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;5.-Hidden-Layer-&amp;#51032;-&amp;#44079;&amp;#49688;&amp;#44032;-&amp;#47566;&amp;#51012;&amp;#49688;&amp;#47197;-&amp;#51339;&amp;#51012;&amp;#44620;?&quot;&gt;5. Hidden Layer &amp;#51032; &amp;#44079;&amp;#49688;&amp;#44032; &amp;#47566;&amp;#51012;&amp;#49688;&amp;#47197; &amp;#51339;&amp;#51012;&amp;#44620;?&lt;a class=&quot;anchor-link&quot; href=&quot;#5.-Hidden-Layer-&amp;#51032;-&amp;#44079;&amp;#49688;&amp;#44032;-&amp;#47566;&amp;#51012;&amp;#49688;&amp;#47197;-&amp;#51339;&amp;#51012;&amp;#44620;?&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;
&lt;img src=&quot;/images/ae/8.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위와같이 hidden node 의 갯수를 input 갯수보다 늘리면 좋을까?&lt;/p&gt;
&lt;p&gt;언뜻 생각하면, 더 많은 feature를 뽑아낼 수 있어서 좋겠다 라고 생각할 수 있지만 실제론 그렇지 않다.&lt;/p&gt;
&lt;p&gt;맨 상단과 맨 아래 있는 node 가 사용되지 않고, 가운데 5개의 node 가 input 을 output  으로 그대로 복사하는 문제가 생긴다.&lt;/p&gt;
&lt;p&gt;encoding 의 기능이 없어지는 것이다. 그렇게되면 의미있는 feature 를 뽑아낼 수 없다.&lt;/p&gt;
&lt;p&gt;이러한 문제, 즉 Autoencoder 의 Overfitting(과적합) 문제를 해결하기 위한 Regularization 방법들을 소개한다.&lt;/p&gt;
&lt;p&gt;Sparse AE,&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;6.-Regularization1-:-Sparse-Autoencoder&quot;&gt;6. Regularization1 : Sparse Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#6.-Regularization1-:-Sparse-Autoencoder&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;매우 유명하다. 굉장히 많이 사용된다.&lt;/p&gt;
&lt;p&gt;위처럼 데이터를 그대로 옮기는 hidden node 가 생기는  overfitting  문제를 해결한다.&lt;/p&gt;
&lt;p&gt;간단히 말하자면 hidden node 중 매번 일부 node 만 사용해서 학습한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/9.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;7.-Regularization2-:-Denoising-Autoencoder&quot;&gt;7. Regularization2 : Denoising Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#7.-Regularization2-:-Denoising-Autoencoder&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Stochastic 한 Auto Encoder 다.&lt;/p&gt;
&lt;p&gt;input X 중의 일부만 사용한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/10.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;8.-Regularization3-:-Contractive-Autoencoder&quot;&gt;8. Regularization3 : Contractive Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#8.-Regularization3-:-Contractive-Autoencoder&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;정리 후 내용을 추후 추가하겠다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;9.-Stacked-Autoencoder&quot;&gt;9. Stacked Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#9.-Stacked-Autoencoder&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Stacked Autoencoder 는 간단히 encoding layer를 하나 더 추가한 것인데, 성능은 매우 강력하다.&lt;/p&gt;
&lt;p&gt;이 간단한 모델이 Deep Belief Network 의 성능을 넘어서는 경우도 있다고 하니, 정말 대단하다.&lt;/p&gt;
&lt;p&gt;참고자료를 읽고, 다시 정리하겠다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/ae/11.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;10.-Deep-Autoencoder&quot;&gt;10. Deep Autoencoder&lt;a class=&quot;anchor-link&quot; href=&quot;#10.-Deep-Autoencoder&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Deep autoencoder 를 알기 전에 확실하게 짚고 넘어가야할 부분은, &lt;strong&gt;Deep Autoencoder 와 Stacked Autoencoder 는 전혀 다른것이다. &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;반드시 구분해야한다.&lt;/p&gt;
&lt;p&gt;Deep autoencoder 는 RBM ( Ristricted Boltzman Machine ) 을 쌓아 만들었고,&lt;/p&gt;
&lt;p&gt;Stacked autoencoder 는 autoencoder 의 encoding layer 를 깊게 쌓아 만든 것이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Python-&amp;#51032;-&amp;#49345;&amp;#49549;&quot;&gt;Python &amp;#51032; &amp;#49345;&amp;#49549;&lt;a class=&quot;anchor-link&quot; href=&quot;#Python-&amp;#51032;-&amp;#49345;&amp;#49549;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;&amp;#44053;&amp;#51228;&amp;#49345;&amp;#49549;-?-&amp;#51088;&amp;#46041;&amp;#49345;&amp;#49549;?&quot;&gt;&amp;#44053;&amp;#51228;&amp;#49345;&amp;#49549; ? &amp;#51088;&amp;#46041;&amp;#49345;&amp;#49549;?&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#44053;&amp;#51228;&amp;#49345;&amp;#49549;-?-&amp;#51088;&amp;#46041;&amp;#49345;&amp;#49549;?&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;강제상속 : 나에게 없을때, 부모클래스 namespace 로 거슬러 올라가 강제 사용&lt;/p&gt;
&lt;p&gt;자동상속 : 내가 부모 클래스 메서드를 덮어썼지만, 부모클래스메서드를 사용하고 싶을 때 super(__class__, self).method() 로 부모메서드 호출&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[42]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Base&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Sub1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[41]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#자동상속&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#s1 은 __init__ 이 없어서 Base 것을 참조한다&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sub1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;jayne&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#강제상속&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#s2 는 자체 __init__ 이 있어서 Base 것을 덮어쓴다. Base 것을 강제 이용하려면, super를 통해 강제상속시킬 수 있다. &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;jayne&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;182&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;&amp;#45796;&amp;#51473;&amp;#49345;&amp;#49549;&amp;#49884;-super-&amp;#45716;-&amp;#45572;&amp;#44396;&amp;#44163;&amp;#51012;-&amp;#44032;&amp;#51256;&amp;#50724;&amp;#45208;?&quot;&gt;&amp;#45796;&amp;#51473;&amp;#49345;&amp;#49549;&amp;#49884; super &amp;#45716; &amp;#45572;&amp;#44396;&amp;#44163;&amp;#51012; &amp;#44032;&amp;#51256;&amp;#50724;&amp;#45208;?&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#45796;&amp;#51473;&amp;#49345;&amp;#49549;&amp;#49884;-super-&amp;#45716;-&amp;#45572;&amp;#44396;&amp;#44163;&amp;#51012;-&amp;#44032;&amp;#51256;&amp;#50724;&amp;#45208;?&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[56]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Base&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Sub1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tall&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;
    


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SubSub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sub1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sub2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SubSub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위처럼 코드를 만들면, super는 누구의 init 메서드를 강제상속할까.&lt;/p&gt;
&lt;p&gt;후보는 Sub1 과 Sub2 이다.&lt;/p&gt;
&lt;p&gt;후보1 : Sub2 의 메서드를 강제 상속하므로 인자로 name, tall, age 모두 넘겨줘야한다.&lt;/p&gt;
&lt;p&gt;후보2 : Sub1 의 메서드를 찾다가, Base 의 init 메서드를 강제상속해오므로, name 만 넘겨주면 된다.&lt;/p&gt;
&lt;p&gt;이 답을 알아보는 방법은 help() 함수이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[57]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SubSub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;so&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[58]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Help on SubSub in module __main__ object:

class SubSub(Sub1, Sub2)
 |  Method resolution order:
 |      SubSub
 |      Sub1
 |      Sub2
 |      Base
 |      builtins.object
 |  
 |  Methods defined here:
 |  
 |  __init__(self, name)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from Base:
 |  
 |  __dict__
 |      dictionary for instance variables (if defined)
 |  
 |  __weakref__
 |      list of weak references to the object (if defined)

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Method resolution order 를 보면 알 있다.&lt;/p&gt;
&lt;p&gt;SubSub 는 자신에게 메서드가 없을 때(자동상속)나 부모의 메서드를 super 로 가져올 때 (강제상속) 위의 ordering 을 따르므로&lt;/p&gt;
&lt;p&gt;&lt;code&gt;super().__init__()&lt;/code&gt; 을 호출 할 때에도, Sub1 에 &lt;code&gt;__init__&lt;/code&gt; 이 있기에  그 init 부터 가져와 사용하게 된다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;&amp;#44208;&amp;#47200;-:-&amp;#47784;&amp;#46304;&amp;#44163;&amp;#51008;-namespace-&amp;#52280;&amp;#51312;-&amp;#49692;&amp;#49436;&amp;#50640;-&amp;#45804;&amp;#47160;&amp;#45796;.&quot;&gt;&amp;#44208;&amp;#47200; : &amp;#47784;&amp;#46304;&amp;#44163;&amp;#51008; namespace &amp;#52280;&amp;#51312; &amp;#49692;&amp;#49436;&amp;#50640; &amp;#45804;&amp;#47160;&amp;#45796;.&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#44208;&amp;#47200;-:-&amp;#47784;&amp;#46304;&amp;#44163;&amp;#51008;-namespace-&amp;#52280;&amp;#51312;-&amp;#49692;&amp;#49436;&amp;#50640;-&amp;#45804;&amp;#47160;&amp;#45796;.&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">Autoencoder 의 간략한 구조는 위와 같다. =&amp;gt; self supervised learning 에 가깝다. 자기 자신을 target(label) 값으로 사용하기 때문이다. 가운데 초록색 노드들(Hidden nodes) 을 coding layer, 또는 bottleneck 이라고 부른다. 1. Autoencoder &amp;#47484; &amp;#50612;&amp;#46356;&amp;#50640; &amp;#50416;&amp;#45208;&amp;#182; 1.feature detection 학습된 autoencoder에서는 coding layer 가 input 의 중요한 feature 들을 나타내게된다. 2.recommendation system 추후 튜토리얼을 확인하자. 3.encoding Decoder로 디코딩할수 있는 코드로 input 값을 encoding(암호화) 하는 기능을 할 수 있다. 2. Autoencoder &amp;#51032; &amp;#51089;&amp;#46041;&amp;#182; 이 사이트 를 참고한 모델을 설명한다. 주로 activation function 으로 tanh 를 사용한다. (hidden 직전과 visible 직전에) output 값에 softmax 를 사용한다. 3. Autoencoder &amp;#51032; Bias&amp;#182; 이렇게 Bias 를 추가할 수도 있고, 그림으론 이렇게 표현한다. 4. Autoencoder &amp;#51032; Training&amp;#182; step 내용 부가 1 input vector x_u = (r1,r2,.., ri,...,rm) 은 user u 의 m개의 영화에 대한 rating이다. rating은 1~5 사이의 값이고, rating 없으면 0이다. 2 input vector(user 단위) 가 하나 network 로 들어간다. 3 input vector x_u 는 vector z 로 인코딩된다.x 에서 z 로 갈 때 mapping function 에 의해 차원이 축소된다. mapping function : z = f(Wx+b) (f : sigmoid, tanh , etc) 4 z 가 output vector y로 decoding 된다. y는 x vector 와 같은 차원을 가진다. y가 x의 복사본이 되게 하는 것이 학습의 목적이다. 5 reconstruction error d(x,y) 를 계산한다. 이 error function 을 최소화시킨다. error function : d(x,y)=//x-y// 6 back-propagation 을 이용해, error 의 값이 역전파되고, W,b 값들이 tuning 된다. learning rate 에 따라 학습 정도가 달라진다. 7 step 1~6 을 반복하면서 파라메터들을 업데이트한다. 만약 vector 하나씩 넣으면서 update 시키면 Reinforcement Learning 이고, 여러 batch 씩 한꺼번에 넣으면서 학습시키면 Batch Learning 8 전체 데이터셋을 한번 다 학습시켰다면, epoch 단위로 몇번 더 학습한다. 5. Hidden Layer &amp;#51032; &amp;#44079;&amp;#49688;&amp;#44032; &amp;#47566;&amp;#51012;&amp;#49688;&amp;#47197; &amp;#51339;&amp;#51012;&amp;#44620;?&amp;#182; 위와같이 hidden node 의 갯수를 input 갯수보다 늘리면 좋을까? 언뜻 생각하면, 더 많은 feature를 뽑아낼 수 있어서 좋겠다 라고 생각할 수 있지만 실제론 그렇지 않다. 맨 상단과 맨 아래 있는 node 가 사용되지 않고, 가운데 5개의 node 가 input 을 output 으로 그대로 복사하는 문제가 생긴다. encoding 의 기능이 없어지는 것이다. 그렇게되면 의미있는 feature 를 뽑아낼 수 없다. 이러한 문제, 즉 Autoencoder 의 Overfitting(과적합) 문제를 해결하기 위한 Regularization 방법들을 소개한다. Sparse AE, 6. Regularization1 : Sparse Autoencoder&amp;#182; 매우 유명하다. 굉장히 많이 사용된다. 위처럼 데이터를 그대로 옮기는 hidden node 가 생기는 overfitting 문제를 해결한다. 간단히 말하자면 hidden node 중 매번 일부 node 만 사용해서 학습한다. 7. Regularization2 : Denoising Autoencoder&amp;#182; Stochastic 한 Auto Encoder 다. input X 중의 일부만 사용한다. 8. Regularization3 : Contractive Autoencoder&amp;#182; 정리 후 내용을 추후 추가하겠다. 9. Stacked Autoencoder&amp;#182; Stacked Autoencoder 는 간단히 encoding layer를 하나 더 추가한 것인데, 성능은 매우 강력하다. 이 간단한 모델이 Deep Belief Network 의 성능을 넘어서는 경우도 있다고 하니, 정말 대단하다. 참고자료를 읽고, 다시 정리하겠다. 10. Deep Autoencoder&amp;#182; Deep autoencoder 를 알기 전에 확실하게 짚고 넘어가야할 부분은, Deep Autoencoder 와 Stacked Autoencoder 는 전혀 다른것이다. 반드시 구분해야한다. Deep autoencoder 는 RBM ( Ristricted Boltzman Machine ) 을 쌓아 만들었고, Stacked autoencoder 는 autoencoder 의 encoding layer 를 깊게 쌓아 만든 것이다. Python &amp;#51032; &amp;#49345;&amp;#49549;&amp;#182; &amp;#44053;&amp;#51228;&amp;#49345;&amp;#49549; ? &amp;#51088;&amp;#46041;&amp;#49345;&amp;#49549;?&amp;#182;강제상속 : 나에게 없을때, 부모클래스 namespace 로 거슬러 올라가 강제 사용 자동상속 : 내가 부모 클래스 메서드를 덮어썼지만, 부모클래스메서드를 사용하고 싶을 때 super(__class__, self).method() 로 부모메서드 호출 In&amp;nbsp;[42]: class Base : def __init__(self, name) : self.name = name class Sub1(Base): pass class Sub2(Base): def __init__(self, name, tall, age) : super(Sub2, self).__init__(name) self.tall = tall self.age = age In&amp;nbsp;[41]: #자동상속 #s1 은 __init__ 이 없어서 Base 것을 참조한다 s1 = Sub1(&amp;quot;jayne&amp;quot;) #강제상속 #s2 는 자체 __init__ 이 있어서 Base 것을 덮어쓴다. Base 것을 강제 이용하려면, super를 통해 강제상속시킬 수 있다. s2 = Sub2(&amp;quot;jayne&amp;quot;,182, 22) &amp;#45796;&amp;#51473;&amp;#49345;&amp;#49549;&amp;#49884; super &amp;#45716; &amp;#45572;&amp;#44396;&amp;#44163;&amp;#51012; &amp;#44032;&amp;#51256;&amp;#50724;&amp;#45208;?&amp;#182; In&amp;nbsp;[56]: class Base : def __init__(self, name) : self.name = name class Sub1(Base): def __init__(self, name) : self.name = name class Sub2(Base): def __init__(self, name, tall, age) : super(Sub2, self).__init__(name) self.tall = tall self.age = age class SubSub(Sub1, Sub2): def __init__(self, name) : super(SubSub, self).__init__(name) 위처럼 코드를 만들면, super는 누구의 init 메서드를 강제상속할까. 후보는 Sub1 과 Sub2 이다. 후보1 : Sub2 의 메서드를 강제 상속하므로 인자로 name, tall, age 모두 넘겨줘야한다. 후보2 : Sub1 의 메서드를 찾다가, Base 의 init 메서드를 강제상속해오므로, name 만 넘겨주면 된다. 이 답을 알아보는 방법은 help() 함수이다. In&amp;nbsp;[57]: ss = SubSub(&amp;quot;so&amp;quot;) In&amp;nbsp;[58]: help(ss) Help on SubSub in module __main__ object: class SubSub(Sub1, Sub2) | Method resolution order: | SubSub | Sub1 | Sub2 | Base | builtins.object | | Methods defined here: | | __init__(self, name) | Initialize self. See help(type(self)) for accurate signature. | | ---------------------------------------------------------------------- | Data descriptors inherited from Base: | | __dict__ | dictionary for instance variables (if defined) | | __weakref__ | list of weak references to the object (if defined) Method resolution order 를 보면 알 있다. SubSub 는 자신에게 메서드가 없을 때(자동상속)나 부모의 메서드를 super 로 가져올 때 (강제상속) 위의 ordering 을 따르므로 super().__init__() 을 호출 할 때에도, Sub1 에 __init__ 이 있기에 그 init 부터 가져와 사용하게 된다. &amp;#44208;&amp;#47200; : &amp;#47784;&amp;#46304;&amp;#44163;&amp;#51008; namespace &amp;#52280;&amp;#51312; &amp;#49692;&amp;#49436;&amp;#50640; &amp;#45804;&amp;#47160;&amp;#45796;.&amp;#182; In&amp;nbsp;[&amp;nbsp;]:</summary></entry><entry><title type="html">tensorflow 로 checkpoint 파일(.ckpt)과 ckeckpoint state proto 이용하기 : Variable 저장과 재활용</title><link href="https://shinjayne.github.io//deeplearning/2017/07/29/tf-ckpt-use.html" rel="alternate" type="text/html" title="tensorflow 로 checkpoint 파일(.ckpt)과 ckeckpoint state proto 이용하기 : Variable 저장과 재활용" /><published>2017-07-29T02:59:50+09:00</published><updated>2017-07-29T02:59:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/07/29/tf-ckpt-use</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/07/29/tf-ckpt-use.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;tensorflow 로 학습시킨 딥러닝 모델을 저장하는 방법중 하나로 &lt;code&gt;Checkpoint&lt;/code&gt; 을 이용하는 방법이 있다.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Checkpoint&lt;/code&gt; 은 학습된 모델의 Variable 값을 저장하는 파일이다.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Checkpoint&lt;/code&gt; 파일을 저장하고 불러옴으로써 학습된 모델을 재사용하고, 지난 학습을 이어서 더 하고 하는 작업들이 가능해진다.&lt;/p&gt;
&lt;p&gt;이번 글에서는 &lt;code&gt;Checkpoint&lt;/code&gt; 파일을 다루는 tensorflow 모듈에 대해서 알아보고, 능숙하게 딥러닝 모델을 저장하고 불러오는 작업을 수행할 수 있도록 하는 것이 목표이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;0.-&amp;#47784;&amp;#45944;-&amp;#46356;&amp;#47113;&amp;#53552;&amp;#47532;-&amp;#44396;&amp;#51312;&quot;&gt;0. &amp;#47784;&amp;#45944; &amp;#46356;&amp;#47113;&amp;#53552;&amp;#47532; &amp;#44396;&amp;#51312;&lt;a class=&quot;anchor-link&quot; href=&quot;#0.-&amp;#47784;&amp;#45944;-&amp;#46356;&amp;#47113;&amp;#53552;&amp;#47532;-&amp;#44396;&amp;#51312;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;project(root)&lt;br/&gt;
ㄴmodel&lt;br/&gt;
~ ㄴgraph.py&lt;br/&gt;
~ ㄴrunner.py&lt;br/&gt;
~ ㄴutils.py&lt;br/&gt;
ㄴdata&lt;br/&gt;
~ ㄴtrain_data&lt;br/&gt;
~ ㄴtest_data&lt;br/&gt;
ㄴsaved&lt;br/&gt;
~ &lt;br/&gt;&lt;/p&gt;
&lt;p&gt;프로젝트 디렉터리 구조가 이렇다고 가정한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#/model/graph.py&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;v1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;v2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;1.-checkpoint-&amp;#51200;&amp;#51109;&quot;&gt;1. checkpoint &amp;#51200;&amp;#51109;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-checkpoint-&amp;#51200;&amp;#51109;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위의 모델 그래프를 학습시키면서, 학습된 모델의 Variable 들을 checkpoint에 저장해본다.&lt;/p&gt;
&lt;p&gt;첫번째 training job 의 이름을 train1 이라고 하자.&lt;/p&gt;
&lt;p&gt;train1 job 의 결과물은 &lt;code&gt;/saved/train1.ckpt&lt;/code&gt; 에 저장할 것이다.&lt;/p&gt;
&lt;p&gt;그러기 위해서는 &lt;code&gt;Checkpoint&lt;/code&gt;파일을 저장해주는 tf.train.Saver() 클래스를 이용해야한다.&lt;/p&gt;
&lt;p&gt;참고 : &lt;a href=&quot;https://www.tensorflow.org/versions/r0.12/api_docs/python/state_ops/saving_and_restoring_variables&quot;&gt;tensorflow api 공식 doc : tf.train.Saver&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#/model/train.py&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    
    &lt;span class=&quot;c1&quot;&gt;# Saver instance 를 생성한다. &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Saver.save(sess, ckpt_path) &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Saver.restore(sess, ckpt_path)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# 그래프를 돌리다가 Variable 을 저장하고 싶을 때 Saver.save() 메서드를 사용한다.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# args : tf.Session, job`s checkpoint file path&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# return : job`s checkpoint file path (String)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;saved/train1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;job`s ckpt files is save as : &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;job`s ckpt files is save as :  saved/train1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;위의 코드를 수행하고 나면 프로젝트의 /saved 디렉터리에 새로운 파일들이 생성된다.&lt;/p&gt;
&lt;p&gt;project(root)&lt;br/&gt;
ㄴmodel&lt;br/&gt;
~ ㄴgraph.py&lt;br/&gt;
~ ㄴrunner.py&lt;br/&gt;
~ ㄴutils.py&lt;br/&gt;
ㄴdata&lt;br/&gt;
~ ㄴtrain_data&lt;br/&gt;
~ ㄴtest_data&lt;br/&gt;
ㄴsaved&lt;br/&gt;
~ ㄴ&lt;strong&gt;checkpoint&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train1.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train1.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train1.ckpt.meta&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;이들중 job name 인 train1 으로 시작하는 세개의 파일이 train1 job 의 Checkpoint 파일이다.&lt;/p&gt;
&lt;p&gt;맨 위의 checkpoint 란 이름의 파일은 조금 이따 이야기한다.
&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;첫번째 training job : train1 의 결과가 만족스럽지 못해서, 모델을 조금 수정해서 다시 training 을 하려고 한다.&lt;/p&gt;
&lt;p&gt;이번 job 의 이름은 train2 라고 하자.&lt;/p&gt;
&lt;p&gt;train2 job 의 결과물을 /saved/train2.ckpt 에 저장하는데, 이번엔 매 iteration마다 Variables 의 값을 저장하고싶다.&lt;/p&gt;
&lt;p&gt;이럴땐 job의 이름을 유지한채로, iteration 별로 &lt;code&gt;Checkpoint file&lt;/code&gt;을 별도로 생성할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#/model/train.py(수정함)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    
    &lt;span class=&quot;c1&quot;&gt;# 위와 마찬가지로 Saver 생성&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; 
        
        &lt;span class=&quot;c1&quot;&gt;# 매 step 마다 모델 저장하고 싶다면 save 메서드에 step 인자를 하나 추가한다.&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# args : tf.Session, job`s checkpoint file path, step&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# return : job`s checkpoint file path (String)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;saved/train2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
        
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;save ckpt file:&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;save ckpt file: saved/train2-0
save ckpt file: saved/train2-1
save ckpt file: saved/train2-2
save ckpt file: saved/train2-3
save ckpt file: saved/train2-4
save ckpt file: saved/train2-5
save ckpt file: saved/train2-6
save ckpt file: saved/train2-7
save ckpt file: saved/train2-8
save ckpt file: saved/train2-9
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;보다시피 train1 job 과는 다르게 job name 뒤에 iteration의 step 이 적혀져서 총 10묶음의 체크포인트가 만들어진다.&lt;/p&gt;
&lt;p&gt;project(root)&lt;br/&gt;
ㄴmodel&lt;br/&gt;
~ ㄴgraph.py&lt;br/&gt;
~ ㄴrunner.py&lt;br/&gt;
~ ㄴutils.py&lt;br/&gt;
ㄴdata&lt;br/&gt;
~ ㄴtrain_data&lt;br/&gt;
~ ㄴtest_data&lt;br/&gt;
ㄴsaved&lt;br/&gt;
~ ㄴ&lt;strong&gt;checkpoint&lt;/strong&gt;&lt;br/&gt;
~ ㄴtrain1.ckpt.data-00000-of-00001&lt;br/&gt;
~ ㄴtrain1.ckpt.index&lt;br/&gt;
~ ㄴtrain1.ckpt.meta&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-0.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-0.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-0.ckpt.meta&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-1.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-1.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-1.ckpt.meta&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-2.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-2.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-2.ckpt.meta&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;.
.
.&lt;/p&gt;
&lt;p&gt;~ ㄴ&lt;strong&gt;train2-8.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-8.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-8.ckpt.meta&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-9.ckpt.data-00000-of-00001&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-9.ckpt.index&lt;/strong&gt;&lt;br/&gt;
~ ㄴ&lt;strong&gt;train2-9.ckpt.meta&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;2.-checkpoint-state-proto&quot;&gt;2. checkpoint state proto&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-checkpoint-state-proto&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/tf_ckpt_use/ckptstateproto.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;위의 사진은 &lt;a href=&quot;https://www.tensorflow.org/versions/r0.12/api_docs/python/state_ops/saving_and_restoring_variables&quot;&gt;tensorflow api 공식 doc : tf.train.Saver&lt;/a&gt; 사이트에서 볼 수 있는 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 에 대한 정보이다.&lt;/p&gt;
&lt;p&gt;이름도 거대한 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 에 대해서 알 필요가 있다.&lt;/p&gt;
&lt;p&gt;Saver 의 save 모듈을 이용해 모델을 저장할 때, Saver 는 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 를 /saved/checkpoint 파일에 담아 저장하고, 새로운 job으로 학습할 때 마다 업데이트해 저장한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 에는 두가지 정보가 담겨있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;model_checkpoint_path : 가장 최근에 저장된 job.ckpt 파일의 path 정보 &lt;/li&gt;
&lt;li&gt;all_model_checkpoint_paths : 최근에 저장된 job_i.ckpt 파일들의 path 정보 list&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;보통 saved 폴더에서 가장 최신의 체크포인트파일을 불러와 모델을 재학습시키거나 테스트해보려고 할때 사용한다.&lt;/p&gt;
&lt;p&gt;all_model_checkpoint_paths 의 가장 마지막 원소는 model_checkpoint_path 와 동일하다.&lt;/p&gt;
&lt;h3 id=&quot;Checkpoint-State-Protocol-Buffer-&amp;#51060;&amp;#50857;&amp;#48277;&quot;&gt;&lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; &amp;#51060;&amp;#50857;&amp;#48277;&lt;a class=&quot;anchor-link&quot; href=&quot;#Checkpoint-State-Protocol-Buffer-&amp;#51060;&amp;#50857;&amp;#48277;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;대표적으로 두가지 방법이 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;tf.train.get_checkpoint_state(saved_dir_path)&lt;/li&gt;
&lt;li&gt;tf.train.latest_checkpoint(saved_dir_path)&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;1.-tf.train.get_checkpoint_state(saved_dir_path)&quot;&gt;1. tf.train.get_checkpoint_state(saved_dir_path)&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-tf.train.get_checkpoint_state(saved_dir_path)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;saved_dir_path&lt;/code&gt; 에서 checkpoint 파일 안의 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 를 읽어온다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ckpt_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_checkpoint_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;saved&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ckpt_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;첫번째 정보 사용법:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_checkpoint_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;두번째 정보 사용법:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;all_model_checkpoint_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&amp;lt;class &amp;#39;tensorflow.python.training.checkpoint_state_pb2.CheckpointState&amp;#39;&amp;gt;
첫번째 정보 사용법: saved/train2-9
두번째 정보 사용법: [&amp;#39;saved/train2-5&amp;#39;, &amp;#39;saved/train2-6&amp;#39;, &amp;#39;saved/train2-7&amp;#39;, &amp;#39;saved/train2-8&amp;#39;, &amp;#39;saved/train2-9&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;2.-tf.train.latest_checkpoint(saved_dir_path)&quot;&gt;2. tf.train.latest_checkpoint(saved_dir_path)&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-tf.train.latest_checkpoint(saved_dir_path)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;saved_dir_path&lt;/code&gt; 에서 checkpoint 파일 안의 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 에서  model_checkpoint_path 정보만 string 으로 반환한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recent_ckpt_job_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;saved&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recent_ckpt_job_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;saved/train2-9
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;3.-checkpoint-&amp;#48520;&amp;#47084;&amp;#50724;&amp;#44592;&quot;&gt;3. checkpoint &amp;#48520;&amp;#47084;&amp;#50724;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-checkpoint-&amp;#48520;&amp;#47084;&amp;#50724;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;저장한 체크포인트 파일들에서 Variable 들을 다시 꺼내서 재사용하려면 tf.Saver 클래스의 restore 메서들을 이용한다.&lt;/p&gt;
&lt;p&gt;이때 위에서 언급한 &lt;strong&gt;&lt;em&gt;Checkpoint State Protocol Buffer&lt;/em&gt;&lt;/strong&gt; 가 매우 요긴하게 쓰인다.&lt;/p&gt;
&lt;p&gt;test1 job 을 수행하는데에 train2 job 에서 마지막에 저장한 변수 ckpt 결과물을 로드해 사용하고싶다.&lt;/p&gt;
&lt;p&gt;그렇다면 아래의 코드처럼 하면된다.&lt;/p&gt;
&lt;h3 id=&quot;case-1:-&amp;#51649;&amp;#51217;-&amp;#48520;&amp;#47084;&amp;#50732;-job.ckpt-&amp;#47749;&amp;#49884;&amp;#54644;&amp;#51452;&amp;#45716;-&amp;#44221;&amp;#50864;&quot;&gt;case 1: &amp;#51649;&amp;#51217; &amp;#48520;&amp;#47084;&amp;#50732; job.ckpt &amp;#47749;&amp;#49884;&amp;#54644;&amp;#51452;&amp;#45716; &amp;#44221;&amp;#50864;&lt;a class=&quot;anchor-link&quot; href=&quot;#case-1:-&amp;#51649;&amp;#51217;-&amp;#48520;&amp;#47084;&amp;#50732;-job.ckpt-&amp;#47749;&amp;#49884;&amp;#54644;&amp;#51452;&amp;#45716;-&amp;#44221;&amp;#50864;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#/model/test.py&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    
    &lt;span class=&quot;c1&quot;&gt;# Saver instance 를 생성한다. &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Saver.restore(sess, ckpt_path)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Saver.restore() &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# args : tf.Session, job`s checkpoint file path&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# return : None&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;saved/train2-9&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;INFO:tensorflow:Restoring parameters from saved/train2-9
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;case-2:-tf.train.latest_checkpoint(dir_path)-&amp;#51060;&amp;#50857;&amp;#54616;&amp;#45716;-&amp;#44221;&amp;#50864;&quot;&gt;case 2: tf.train.latest_checkpoint(dir_path) &amp;#51060;&amp;#50857;&amp;#54616;&amp;#45716; &amp;#44221;&amp;#50864;&lt;a class=&quot;anchor-link&quot; href=&quot;#case-2:-tf.train.latest_checkpoint(dir_path)-&amp;#51060;&amp;#50857;&amp;#54616;&amp;#45716;-&amp;#44221;&amp;#50864;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#/model/test.py&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    
    &lt;span class=&quot;c1&quot;&gt;# Saver instance 를 생성한다. &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Saver.restore(sess, ckpt_path)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Saver.restore() &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# args : tf.Session, job`s checkpoint file path&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# return : None&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;ckpt_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;saved&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;INFO:tensorflow:Restoring parameters from saved/train2-9
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">tensorflow 로 학습시킨 딥러닝 모델을 저장하는 방법중 하나로 Checkpoint 을 이용하는 방법이 있다. Checkpoint 은 학습된 모델의 Variable 값을 저장하는 파일이다. Checkpoint 파일을 저장하고 불러옴으로써 학습된 모델을 재사용하고, 지난 학습을 이어서 더 하고 하는 작업들이 가능해진다. 이번 글에서는 Checkpoint 파일을 다루는 tensorflow 모듈에 대해서 알아보고, 능숙하게 딥러닝 모델을 저장하고 불러오는 작업을 수행할 수 있도록 하는 것이 목표이다. 0. &amp;#47784;&amp;#45944; &amp;#46356;&amp;#47113;&amp;#53552;&amp;#47532; &amp;#44396;&amp;#51312;&amp;#182; project(root) ㄴmodel ~ ㄴgraph.py ~ ㄴrunner.py ~ ㄴutils.py ㄴdata ~ ㄴtrain_data ~ ㄴtest_data ㄴsaved ~ 프로젝트 디렉터리 구조가 이렇다고 가정한다. In&amp;nbsp;[1]: #/model/graph.py import tensorflow as tf g = tf.Graph() with g.as_default() : v1 = tf.Variable(10, name = &amp;quot;v1&amp;quot;) v2 = tf.Variable(11, name = &amp;quot;v2&amp;quot;) 1. checkpoint &amp;#51200;&amp;#51109;&amp;#182; 위의 모델 그래프를 학습시키면서, 학습된 모델의 Variable 들을 checkpoint에 저장해본다. 첫번째 training job 의 이름을 train1 이라고 하자. train1 job 의 결과물은 /saved/train1.ckpt 에 저장할 것이다. 그러기 위해서는 Checkpoint파일을 저장해주는 tf.train.Saver() 클래스를 이용해야한다. 참고 : tensorflow api 공식 doc : tf.train.Saver In&amp;nbsp;[2]: #/model/train.py with tf.Session(graph=g) as sess : # Saver instance 를 생성한다. # Saver.save(sess, ckpt_path) # Saver.restore(sess, ckpt_path) saver = tf.train.Saver() sess.run(tf.global_variables_initializer()) # 그래프를 돌리다가 Variable 을 저장하고 싶을 때 Saver.save() 메서드를 사용한다. # args : tf.Session, job`s checkpoint file path # return : job`s checkpoint file path (String) ckpt_path = saver.save(sess, &amp;quot;saved/train1&amp;quot;) print(&amp;quot;job`s ckpt files is save as : &amp;quot;, ckpt_path) job`s ckpt files is save as : saved/train1 위의 코드를 수행하고 나면 프로젝트의 /saved 디렉터리에 새로운 파일들이 생성된다. project(root) ㄴmodel ~ ㄴgraph.py ~ ㄴrunner.py ~ ㄴutils.py ㄴdata ~ ㄴtrain_data ~ ㄴtest_data ㄴsaved ~ ㄴcheckpoint ~ ㄴtrain1.ckpt.data-00000-of-00001 ~ ㄴtrain1.ckpt.index ~ ㄴtrain1.ckpt.meta 이들중 job name 인 train1 으로 시작하는 세개의 파일이 train1 job 의 Checkpoint 파일이다. 맨 위의 checkpoint 란 이름의 파일은 조금 이따 이야기한다. 첫번째 training job : train1 의 결과가 만족스럽지 못해서, 모델을 조금 수정해서 다시 training 을 하려고 한다. 이번 job 의 이름은 train2 라고 하자. train2 job 의 결과물을 /saved/train2.ckpt 에 저장하는데, 이번엔 매 iteration마다 Variables 의 값을 저장하고싶다. 이럴땐 job의 이름을 유지한채로, iteration 별로 Checkpoint file을 별도로 생성할 수 있다. In&amp;nbsp;[3]: #/model/train.py(수정함) with tf.Session(graph=g) as sess : # 위와 마찬가지로 Saver 생성 saver = tf.train.Saver() sess.run(tf.global_variables_initializer()) for step in range(10): # 매 step 마다 모델 저장하고 싶다면 save 메서드에 step 인자를 하나 추가한다. # args : tf.Session, job`s checkpoint file path, step # return : job`s checkpoint file path (String) ckpt_path = saver.save(sess, &amp;quot;saved/train2&amp;quot;, step) print(&amp;quot;save ckpt file:&amp;quot; , ckpt_path) save ckpt file: saved/train2-0 save ckpt file: saved/train2-1 save ckpt file: saved/train2-2 save ckpt file: saved/train2-3 save ckpt file: saved/train2-4 save ckpt file: saved/train2-5 save ckpt file: saved/train2-6 save ckpt file: saved/train2-7 save ckpt file: saved/train2-8 save ckpt file: saved/train2-9 보다시피 train1 job 과는 다르게 job name 뒤에 iteration의 step 이 적혀져서 총 10묶음의 체크포인트가 만들어진다. project(root) ㄴmodel ~ ㄴgraph.py ~ ㄴrunner.py ~ ㄴutils.py ㄴdata ~ ㄴtrain_data ~ ㄴtest_data ㄴsaved ~ ㄴcheckpoint ~ ㄴtrain1.ckpt.data-00000-of-00001 ~ ㄴtrain1.ckpt.index ~ ㄴtrain1.ckpt.meta ~ ㄴtrain2-0.ckpt.data-00000-of-00001 ~ ㄴtrain2-0.ckpt.index ~ ㄴtrain2-0.ckpt.meta ~ ㄴtrain2-1.ckpt.data-00000-of-00001 ~ ㄴtrain2-1.ckpt.index ~ ㄴtrain2-1.ckpt.meta ~ ㄴtrain2-2.ckpt.data-00000-of-00001 ~ ㄴtrain2-2.ckpt.index ~ ㄴtrain2-2.ckpt.meta . . . ~ ㄴtrain2-8.ckpt.data-00000-of-00001 ~ ㄴtrain2-8.ckpt.index ~ ㄴtrain2-8.ckpt.meta ~ ㄴtrain2-9.ckpt.data-00000-of-00001 ~ ㄴtrain2-9.ckpt.index ~ ㄴtrain2-9.ckpt.meta 2. checkpoint state proto&amp;#182; 위의 사진은 tensorflow api 공식 doc : tf.train.Saver 사이트에서 볼 수 있는 Checkpoint State Protocol Buffer 에 대한 정보이다. 이름도 거대한 Checkpoint State Protocol Buffer 에 대해서 알 필요가 있다. Saver 의 save 모듈을 이용해 모델을 저장할 때, Saver 는 Checkpoint State Protocol Buffer 를 /saved/checkpoint 파일에 담아 저장하고, 새로운 job으로 학습할 때 마다 업데이트해 저장한다. Checkpoint State Protocol Buffer 에는 두가지 정보가 담겨있다. model_checkpoint_path : 가장 최근에 저장된 job.ckpt 파일의 path 정보 all_model_checkpoint_paths : 최근에 저장된 job_i.ckpt 파일들의 path 정보 list 보통 saved 폴더에서 가장 최신의 체크포인트파일을 불러와 모델을 재학습시키거나 테스트해보려고 할때 사용한다. all_model_checkpoint_paths 의 가장 마지막 원소는 model_checkpoint_path 와 동일하다. Checkpoint State Protocol Buffer &amp;#51060;&amp;#50857;&amp;#48277;&amp;#182;대표적으로 두가지 방법이 있다. tf.train.get_checkpoint_state(saved_dir_path) tf.train.latest_checkpoint(saved_dir_path) 1. tf.train.get_checkpoint_state(saved_dir_path)&amp;#182;saved_dir_path 에서 checkpoint 파일 안의 Checkpoint State Protocol Buffer 를 읽어온다. In&amp;nbsp;[4]: ckpt_state = tf.train.get_checkpoint_state(&amp;quot;saved&amp;quot;) print(type(ckpt_state)) print(&amp;quot;첫번째 정보 사용법:&amp;quot;, ckpt_state.model_checkpoint_path) print(&amp;quot;두번째 정보 사용법:&amp;quot;, ckpt_state.all_model_checkpoint_paths) &amp;lt;class &amp;#39;tensorflow.python.training.checkpoint_state_pb2.CheckpointState&amp;#39;&amp;gt; 첫번째 정보 사용법: saved/train2-9 두번째 정보 사용법: [&amp;#39;saved/train2-5&amp;#39;, &amp;#39;saved/train2-6&amp;#39;, &amp;#39;saved/train2-7&amp;#39;, &amp;#39;saved/train2-8&amp;#39;, &amp;#39;saved/train2-9&amp;#39;] 2. tf.train.latest_checkpoint(saved_dir_path)&amp;#182;saved_dir_path 에서 checkpoint 파일 안의 Checkpoint State Protocol Buffer 에서 model_checkpoint_path 정보만 string 으로 반환한다. In&amp;nbsp;[5]: recent_ckpt_job_path = tf.train.latest_checkpoint(&amp;quot;saved&amp;quot;) print(recent_ckpt_job_path) saved/train2-9 3. checkpoint &amp;#48520;&amp;#47084;&amp;#50724;&amp;#44592;&amp;#182; 저장한 체크포인트 파일들에서 Variable 들을 다시 꺼내서 재사용하려면 tf.Saver 클래스의 restore 메서들을 이용한다. 이때 위에서 언급한 Checkpoint State Protocol Buffer 가 매우 요긴하게 쓰인다. test1 job 을 수행하는데에 train2 job 에서 마지막에 저장한 변수 ckpt 결과물을 로드해 사용하고싶다. 그렇다면 아래의 코드처럼 하면된다. case 1: &amp;#51649;&amp;#51217; &amp;#48520;&amp;#47084;&amp;#50732; job.ckpt &amp;#47749;&amp;#49884;&amp;#54644;&amp;#51452;&amp;#45716; &amp;#44221;&amp;#50864;&amp;#182; In&amp;nbsp;[6]: #/model/test.py with tf.Session(graph=g) as sess : # Saver instance 를 생성한다. # Saver.restore(sess, ckpt_path) saver = tf.train.Saver() sess.run(tf.global_variables_initializer()) # Saver.restore() # args : tf.Session, job`s checkpoint file path # return : None ckpt_path = saver.restore(sess, &amp;quot;saved/train2-9&amp;quot;) INFO:tensorflow:Restoring parameters from saved/train2-9 case 2: tf.train.latest_checkpoint(dir_path) &amp;#51060;&amp;#50857;&amp;#54616;&amp;#45716; &amp;#44221;&amp;#50864;&amp;#182; In&amp;nbsp;[7]: #/model/test.py with tf.Session(graph=g) as sess : # Saver instance 를 생성한다. # Saver.restore(sess, ckpt_path) saver = tf.train.Saver() sess.run(tf.global_variables_initializer()) # Saver.restore() # args : tf.Session, job`s checkpoint file path # return : None ckpt_path = saver.restore(sess, tf.train.latest_checkpoint(&amp;quot;saved&amp;quot;)) INFO:tensorflow:Restoring parameters from saved/train2-9</summary></entry><entry><title type="html">SOM: Self Organazing Map 으로 Clustering 코드구현 까지</title><link href="https://shinjayne.github.io//deeplearning/2017/07/27/udemy-som.html" rel="alternate" type="text/html" title="SOM: Self Organazing Map 으로 Clustering 코드구현 까지" /><published>2017-07-27T00:51:50+09:00</published><updated>2017-07-27T00:51:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/07/27/udemy-som</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/07/27/udemy-som.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Self Organizing Map 에 대해서 알아보겠습니다.&lt;/p&gt;
&lt;p&gt;Udemy 의 &lt;a href=&quot;https://www.udemy.com/deeplearning/learn/v4/overview&quot;&gt;Deep-Learning-A-to-Z 강의&lt;/a&gt; 의 SOM 파트를 수강하고 작성하였습니다.&lt;/p&gt;
&lt;p&gt;Self Organizing Map은 줄여서 SOM 이라고 부릅니다.&lt;/p&gt;
&lt;p&gt;Unsupervised learning 방법 중 하나이며 Clustering 에 쓰입니다.&lt;/p&gt;
&lt;p&gt;Clustering 작업을 수행하는, SOM 보다 조금 단순한 K-mean 알고리즘을 보고 SOM 을 보면 이해가 쉽습니다.&lt;/p&gt;
&lt;h1 id=&quot;K-mean-Cluster&quot;&gt;K-mean Cluster&lt;a class=&quot;anchor-link&quot; href=&quot;#K-mean-Cluster&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;K-mean-&amp;#51032;-&amp;#44208;&amp;#44284;-=-Clustering&quot;&gt;K-mean &amp;#51032; &amp;#44208;&amp;#44284; = Clustering&lt;a class=&quot;anchor-link&quot; href=&quot;#K-mean-&amp;#51032;-&amp;#44208;&amp;#44284;-=-Clustering&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;아래의 그림은 K-mean 알고리즘으로 클러스터링 한 결과를 보여줍니다.
&lt;img src=&quot;/images/udemy-som/1.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;K-mean-&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#44284;&amp;#51221;&quot;&gt;K-mean &amp;#51032; &amp;#54617;&amp;#49845; &amp;#44284;&amp;#51221;&lt;a class=&quot;anchor-link&quot; href=&quot;#K-mean-&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#44284;&amp;#51221;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/udemy-som/2.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;K-mean 의 학습과정은 단순합니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;과정&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;step1&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;몇개의 군집으로 나눌것인지 K 를 설정해줍니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;step2&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;군집으로 나눌 데이터 분포들 사이에 K개의 랜덤한 &lt;strong&gt;센트로이드 포인트&lt;/strong&gt;들을 잡습니다.(랜덤하게 잡으면 엉뚱하게 Clustering하는 에러도 있기도 합니다)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;step3&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;각각의 데이터 포인트틀과 가장 가까운 센트로이드 포인트를 찾습니다. (이것이 K Cluser 형태가 됩니다)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;step4&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;K 개로 나뉜 각 군집의 새로운 중심점을 찾아 새로운 센트로이드 포인트로 지정합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;step5&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;새로운 센트로이드 포인트에 대해 다시 step3 처럼 가까운 데이터포인트들을 묶습니다.(K Cluster 형태가 됩니다)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;...&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;센트로이드 포인트 이동이 멈추기 전까지 step4 로 다시 돌아갑니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;SOM-Structrue&quot;&gt;SOM Structrue&lt;a class=&quot;anchor-link&quot; href=&quot;#SOM-Structrue&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;SOM 은 조금 다릅니다.&lt;/p&gt;
&lt;p&gt;SOM 은 우선 Map size 를 설정해줍니다. (2차원으로 x=3, y=3 크기의 Map 이라고 가정합시다)&lt;/p&gt;
&lt;p&gt;Map Size 를 설정해, 전혀 학습하지 않은 생 Map 을 Default Map 이라고 칭하겠습니다.&lt;/p&gt;
&lt;p&gt;이제 이 Default Map 을 조금씩 수정해서(학습해서) 데이터 분포 형태에 Map 을 근사시키려고 합니다.&lt;/p&gt;
&lt;p&gt;3*3 사이즈의 map 은 9개의 map point = Node 로 이루어졍있고, 각 Node 는 데이터의 차원수와 동일한 parameter 갯수를 가집니다.&lt;/p&gt;
&lt;p&gt;사진에서는 3차원 X(x1,x2,x3) 데이터 이므로  Node_i(w_i1, w_i2, w_i3) 가 i=1~9 로 존재합니다.&lt;/p&gt;
&lt;p&gt;이제 이 각각의 Node 들과 각 데이터 X 사이의 거리를 구합니다.&lt;/p&gt;
&lt;p&gt;이들중 데이터와 가장 가까운 node 를 winning node 라고 마킹합니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/udemy-som/3.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;점(w1i,w2i,w3i)들과 데이터의 feature인 (x1,x2,x3) 점과의 distance 를 좁혀나갑니다.&lt;/p&gt;
&lt;p&gt;아래는 map 을 데이터에 맞게 점점 fitting 시키는 모습입니다.&lt;/p&gt;
&lt;p&gt;특정 데이터 점 하나가 SOMap 의 한 점을 점점 끌어당기는 모습입니다.&lt;/p&gt;
&lt;p&gt;(실제론 winning node 와 그 주변 node 까지 동시에 끌어당깁니다.)&lt;/p&gt;
&lt;p&gt;이런식으로 모든 데이터에 대해 SOMap 의 각 점을 끌어오면 SOMap 완성됩니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/udemy-som/4.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;SOM&amp;#51032;-&amp;#53945;&amp;#51669;&quot;&gt;SOM&amp;#51032; &amp;#53945;&amp;#51669;&lt;a class=&quot;anchor-link&quot; href=&quot;#SOM&amp;#51032;-&amp;#53945;&amp;#51669;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;SOM 의 특징은 아래와 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SOM 은 Input 데이터들 사이의 위상을 잘 나타냅니다. &lt;/li&gt;
&lt;li&gt;SOM 은 잘 구별되지 않는 데이터간의 correlation 을 찾아낼 수 있습니다.&lt;/li&gt;
&lt;li&gt;SOM 은 비지도 학습으로 Clustering 을 수행할 수 있습니다.&lt;/li&gt;
&lt;li&gt;비지도이고, Label Data 가 없으므로, Back propagation 과정도 없습니다.&lt;/li&gt;
&lt;li&gt;output node 간에 후속 연결이 없습니다.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/udemy-som/5.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Training-&amp;#51204;&amp;#47029;&quot;&gt;Training &amp;#51204;&amp;#47029;&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-&amp;#51204;&amp;#47029;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;자세한  SOM 의 학습 과정은 아래와 같습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/udemy-som/6.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;Python-Code&quot;&gt;Python Code&lt;a class=&quot;anchor-link&quot; href=&quot;#Python-Code&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;SOM model code&lt;/li&gt;
&lt;li&gt;SOM model use code&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;1.-SOM-model-code&quot;&gt;1. SOM model code&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-SOM-model-code&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[24]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unravel_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;meshgrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultdict&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warn&lt;/span&gt;


&lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Minimalistic implementation of the Self Organizing Maps (SOM).&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Returns norm-2 of a 1-D numpy array.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    * faster than linalg.norm in case of 1-D arrays (numpy 1.9.2rc1).&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MiniSom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decay_function&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Initializes a Self Organizing Maps.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            x,y - dimensions of the SOM&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            input_len - number of the elements of the vectors in input&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            sigma - spread of the neighborhood function (Gaussian), needs to be adequate to the dimensions of the map.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            (at the iteration t we have sigma(t) = sigma / (1 + t/T) where T is #num_iteration/2)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            learning_rate - initial learning rate&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            (at the iteration t we have learning_rate(t) = learning_rate / (1 + t/T) where T is #num_iteration/2)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            decay_function, function that reduces learning_rate and sigma at each iteration&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;                            default function: lambda x,current_iteration,max_iter: x/(1+current_iteration/max_iter)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            random_seed, random seed to use.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;warn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Warning: sigma is too high for the dimension of the map.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decay_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_decay_function&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decay_function&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_decay_function&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_generator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# random initialization&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# normalization&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# used to evaluate the neighborhood function&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neighborhood&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gaussian&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Updates matrix activation_map, in this matrix the element i,j is the response of the neuron i,j to x &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subtract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# x - w&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;multi_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# || x - w ||&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iternext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Returns the activation map to x &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gaussian&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Returns a Gaussian centered in c &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# the external product gives a matrix&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;diff_gaussian&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Mexican hat centered in c (unused) &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;meshgrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neigy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Computes the coordinates of the winning neuron for the sample x &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_activate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unravel_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;win&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Updates the weights of the neurons.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            x - current pattern to learn&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            win - position of the winning neuron for x (array or tuple).&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            t - iteration index&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_decay_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_decay_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# sigma and learning rate decrease with the same rule&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neighborhood&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;win&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# improves the performances&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;multi_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# eta * neighborhood_function * (x-w)&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# normalization&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iternext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;quantization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Assigns a code book (weights vector of the winning neuron) to each sample in data. &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;random_weights_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Initializes the weights of the SOM picking random samples from data &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activation_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;multi_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_generator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iternext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Trains the SOM picking samples at random from data &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_init_T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;rand_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_generator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pick a random sample&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Trains using all the vectors in data sequentially &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_init_T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_init_T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Initializes the parameter T needed to adjust the learning rate &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# keeps the learning rate nearly constant for the last half of the iterations&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;distance_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Returns the distance map of the weights.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Each cell is the normalised sum of the distances between a neuron and its neighbours.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;um&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nditer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;um&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;multi_index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finished&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jj&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;um&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iternext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;um&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;um&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;um&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;um&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;activation_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Returns a matrix where the element i,j is the number of times&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            that the neuron i,j have been winner.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;quantization_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Returns the quantization error computed as the average distance between&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            each input sample and its best matching unit.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fast_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;win_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            Returns a dictionary wm where wm[(i,j)] is a list with all the patterns&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            that have been mapped in the position i,j.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;winmap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultdict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;winmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;winmap&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;### unit tests&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;from numpy.testing import assert_almost_equal, assert_array_almost_equal, assert_array_equal&lt;/span&gt;


&lt;span class=&quot;sd&quot;&gt;class TestMinisom:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    def setup_method(self, method):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som = MiniSom(5, 5, 1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        for i in range(5):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            for j in range(5):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;                assert_almost_equal(1.0, linalg.norm(self.som.weights[i,j]))  # checking weights normalization&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som.weights = zeros((5, 5))  # fake weights&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som.weights[2, 3] = 5.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som.weights[1, 1] = 2.0&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_decay_function(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert self.som._decay_function(1., 2., 3.) == 1./(1.+2./3.)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_fast_norm(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert fast_norm(array([1, 3])) == sqrt(1+9)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_gaussian(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        bell = self.som.gaussian((2, 2), 1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert bell.max() == 1.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert bell.argmax() == 12  # unravel(12) = (2,2)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_win_map(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        winners = self.som.win_map([5.0, 2.0])&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert winners[(2, 3)][0] == 5.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert winners[(1, 1)][0] == 2.0&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_activation_reponse(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        response = self.som.activation_response([5.0, 2.0])&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert response[2, 3] == 1&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert response[1, 1] == 1&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_activate(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert self.som.activate(5.0).argmin() == 13.0  # unravel(13) = (2,3)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_quantization_error(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som.quantization_error([5, 2]) == 0.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        self.som.quantization_error([4, 1]) == 0.5&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_quantization(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        q = self.som.quantization(array([4, 2]))&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert q[0] == 5.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert q[1] == 2.0&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_random_seed(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som1 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som2 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert_array_almost_equal(som1.weights, som2.weights)  # same initialization&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        data = random.rand(100,2)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som1 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som1.train_random(data,10)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som2 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som2.train_random(data,10)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert_array_almost_equal(som1.weights,som2.weights)  # same state after training&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_train_batch(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        data = array([[4, 2], [3, 1]])&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        q1 = som.quantization_error(data)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som.train_batch(data, 10)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert q1 &amp;gt; som.quantization_error(data)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_train_random(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        data = array([[4, 2], [3, 1]])&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        q1 = som.quantization_error(data)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som.train_random(data, 10)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        assert q1 &amp;gt; som.quantization_error(data)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    def test_random_weights_init(self):&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som = MiniSom(2, 2, 2, random_seed=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        som.random_weights_init(array([[1.0, .0]]))&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        for w in som.weights:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            assert_array_equal(w[0], array([1.0, .0]))&lt;/span&gt;



&lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;2.-SOM-model-use-code&quot;&gt;2. SOM model use code&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-SOM-model-use-code&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;만든 SOM model 을 이용해 Credit card 발급 신청자 데이터를 Clustering 해보고, 수상한 사람을 찾아내보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;우선 데이터를 불러옵니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Importing the dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Credit_Card_Applications.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[16]:&lt;/div&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style&gt;
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;CustomerID&lt;/th&gt;
      &lt;th&gt;A1&lt;/th&gt;
      &lt;th&gt;A2&lt;/th&gt;
      &lt;th&gt;A3&lt;/th&gt;
      &lt;th&gt;A4&lt;/th&gt;
      &lt;th&gt;A5&lt;/th&gt;
      &lt;th&gt;A6&lt;/th&gt;
      &lt;th&gt;A7&lt;/th&gt;
      &lt;th&gt;A8&lt;/th&gt;
      &lt;th&gt;A9&lt;/th&gt;
      &lt;th&gt;A10&lt;/th&gt;
      &lt;th&gt;A11&lt;/th&gt;
      &lt;th&gt;A12&lt;/th&gt;
      &lt;th&gt;A13&lt;/th&gt;
      &lt;th&gt;A14&lt;/th&gt;
      &lt;th&gt;Class&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;15776156&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;22.08&lt;/td&gt;
      &lt;td&gt;11.460&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.585&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;1213&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;15739548&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;22.67&lt;/td&gt;
      &lt;td&gt;7.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.165&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;15662854&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;29.58&lt;/td&gt;
      &lt;td&gt;1.750&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.250&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;280&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;15687688&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;21.67&lt;/td&gt;
      &lt;td&gt;11.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;15715750&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20.17&lt;/td&gt;
      &lt;td&gt;8.170&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.960&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;159&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;15571121&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;15.83&lt;/td&gt;
      &lt;td&gt;0.585&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;15726466&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.42&lt;/td&gt;
      &lt;td&gt;6.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;101&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;15660390&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;58.67&lt;/td&gt;
      &lt;td&gt;4.460&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3.040&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;43&lt;/td&gt;
      &lt;td&gt;561&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;15663942&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;27.83&lt;/td&gt;
      &lt;td&gt;1.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3.000&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;176&lt;/td&gt;
      &lt;td&gt;538&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;15638610&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;55.75&lt;/td&gt;
      &lt;td&gt;7.080&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;6.750&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;51&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;15644446&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;33.50&lt;/td&gt;
      &lt;td&gt;1.750&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;253&lt;/td&gt;
      &lt;td&gt;858&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;15585892&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;41.42&lt;/td&gt;
      &lt;td&gt;5.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;5.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;470&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;15609356&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20.67&lt;/td&gt;
      &lt;td&gt;1.250&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1.375&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;140&lt;/td&gt;
      &lt;td&gt;211&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;15803378&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;34.92&lt;/td&gt;
      &lt;td&gt;5.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;7.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1001&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;15599440&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;58.58&lt;/td&gt;
      &lt;td&gt;2.710&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;2.415&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;320&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;15692408&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;48.08&lt;/td&gt;
      &lt;td&gt;6.040&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.040&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2691&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;15683168&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;29.58&lt;/td&gt;
      &lt;td&gt;4.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;7.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;330&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;15790254&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;18.92&lt;/td&gt;
      &lt;td&gt;9.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.750&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;88&lt;/td&gt;
      &lt;td&gt;592&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;15767729&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20.00&lt;/td&gt;
      &lt;td&gt;1.250&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;140&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;15768600&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;22.42&lt;/td&gt;
      &lt;td&gt;5.665&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;2.585&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;129&lt;/td&gt;
      &lt;td&gt;3258&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;15699839&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;28.17&lt;/td&gt;
      &lt;td&gt;0.585&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.040&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;260&lt;/td&gt;
      &lt;td&gt;1005&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;15786237&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;19.17&lt;/td&gt;
      &lt;td&gt;0.585&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.585&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;15694530&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;41.17&lt;/td&gt;
      &lt;td&gt;1.335&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.165&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;168&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;15796813&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;41.58&lt;/td&gt;
      &lt;td&gt;1.750&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.210&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;15605791&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;19.50&lt;/td&gt;
      &lt;td&gt;9.585&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.790&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;351&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;25&lt;/th&gt;
      &lt;td&gt;15714087&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;32.75&lt;/td&gt;
      &lt;td&gt;1.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;5.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;26&lt;/th&gt;
      &lt;td&gt;15711446&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;22.50&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;71&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;27&lt;/th&gt;
      &lt;td&gt;15588123&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;33.17&lt;/td&gt;
      &lt;td&gt;3.040&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;2.040&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;180&lt;/td&gt;
      &lt;td&gt;18028&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;28&lt;/th&gt;
      &lt;td&gt;15748552&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;30.67&lt;/td&gt;
      &lt;td&gt;12.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;2.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;220&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;29&lt;/th&gt;
      &lt;td&gt;15618410&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;23.08&lt;/td&gt;
      &lt;td&gt;2.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.085&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;2185&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;660&lt;/th&gt;
      &lt;td&gt;15598586&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;26.67&lt;/td&gt;
      &lt;td&gt;2.710&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5.250&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;211&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;661&lt;/th&gt;
      &lt;td&gt;15665014&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;22.50&lt;/td&gt;
      &lt;td&gt;0.415&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.335&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;144&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;662&lt;/th&gt;
      &lt;td&gt;15701738&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;39.92&lt;/td&gt;
      &lt;td&gt;0.540&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1001&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;663&lt;/th&gt;
      &lt;td&gt;15650591&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;26.08&lt;/td&gt;
      &lt;td&gt;8.665&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.415&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;151&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;664&lt;/th&gt;
      &lt;td&gt;15652667&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20.00&lt;/td&gt;
      &lt;td&gt;0.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.500&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;144&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;665&lt;/th&gt;
      &lt;td&gt;15679622&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;31.57&lt;/td&gt;
      &lt;td&gt;4.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.085&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;411&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;666&lt;/th&gt;
      &lt;td&gt;15730150&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;26.75&lt;/td&gt;
      &lt;td&gt;4.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;2.500&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;200&lt;/td&gt;
      &lt;td&gt;1211&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;667&lt;/th&gt;
      &lt;td&gt;15813192&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;24.92&lt;/td&gt;
      &lt;td&gt;1.250&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;668&lt;/th&gt;
      &lt;td&gt;15606554&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;32.25&lt;/td&gt;
      &lt;td&gt;1.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.250&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;372&lt;/td&gt;
      &lt;td&gt;123&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;669&lt;/th&gt;
      &lt;td&gt;15611794&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.67&lt;/td&gt;
      &lt;td&gt;4.460&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.250&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;670&lt;/th&gt;
      &lt;td&gt;15672357&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;37.75&lt;/td&gt;
      &lt;td&gt;5.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;228&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;671&lt;/th&gt;
      &lt;td&gt;15711759&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;22.67&lt;/td&gt;
      &lt;td&gt;2.540&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;2.585&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;672&lt;/th&gt;
      &lt;td&gt;15615296&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;17.92&lt;/td&gt;
      &lt;td&gt;10.210&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0.000&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;51&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;673&lt;/th&gt;
      &lt;td&gt;15699294&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;24.42&lt;/td&gt;
      &lt;td&gt;12.335&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1.585&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;120&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;674&lt;/th&gt;
      &lt;td&gt;15788634&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;25.75&lt;/td&gt;
      &lt;td&gt;0.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;0.875&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;491&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;675&lt;/th&gt;
      &lt;td&gt;15660871&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;26.17&lt;/td&gt;
      &lt;td&gt;12.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1.250&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;18&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;676&lt;/th&gt;
      &lt;td&gt;15618258&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;22.75&lt;/td&gt;
      &lt;td&gt;6.165&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.165&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;220&lt;/td&gt;
      &lt;td&gt;1001&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;677&lt;/th&gt;
      &lt;td&gt;15722535&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;23.00&lt;/td&gt;
      &lt;td&gt;0.750&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;320&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;678&lt;/th&gt;
      &lt;td&gt;15711977&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;25.67&lt;/td&gt;
      &lt;td&gt;0.290&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1.500&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;679&lt;/th&gt;
      &lt;td&gt;15690169&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;48.58&lt;/td&gt;
      &lt;td&gt;0.205&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.250&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;380&lt;/td&gt;
      &lt;td&gt;2733&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;680&lt;/th&gt;
      &lt;td&gt;15790689&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;21.17&lt;/td&gt;
      &lt;td&gt;0.000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.500&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;681&lt;/th&gt;
      &lt;td&gt;15665181&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;35.25&lt;/td&gt;
      &lt;td&gt;16.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4.000&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;682&lt;/th&gt;
      &lt;td&gt;15633608&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;22.92&lt;/td&gt;
      &lt;td&gt;11.585&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.040&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;1350&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;683&lt;/th&gt;
      &lt;td&gt;15805261&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;48.17&lt;/td&gt;
      &lt;td&gt;1.335&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;0.335&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;121&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;684&lt;/th&gt;
      &lt;td&gt;15740356&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;43.00&lt;/td&gt;
      &lt;td&gt;0.290&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1.750&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;376&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;685&lt;/th&gt;
      &lt;td&gt;15808223&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;31.57&lt;/td&gt;
      &lt;td&gt;10.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;6.500&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;686&lt;/th&gt;
      &lt;td&gt;15769980&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;20.67&lt;/td&gt;
      &lt;td&gt;0.415&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.125&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;687&lt;/th&gt;
      &lt;td&gt;15675450&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;18.83&lt;/td&gt;
      &lt;td&gt;9.540&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.085&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;100&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;688&lt;/th&gt;
      &lt;td&gt;15776494&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;27.42&lt;/td&gt;
      &lt;td&gt;14.500&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3.085&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;120&lt;/td&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;689&lt;/th&gt;
      &lt;td&gt;15592412&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;41.00&lt;/td&gt;
      &lt;td&gt;0.040&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.040&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;560&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;690 rows × 16 columns&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;데이터를 보시면 첫번째줄은 고객 식별번호id 이고 마지막줄은 카드발급 승인 여부입니다.&lt;/p&gt;
&lt;p&gt;이중 마지막 카드발급 승인여부는 따로 y 로 빼둡니다.&lt;/p&gt;
&lt;p&gt;Clustering 에 고려할 feature 가 아니기 때문입니다. 그리고 나중에 Clustering 이 잘 되었는지 확인해 볼 때 사용합니다.&lt;/p&gt;
&lt;p&gt;데이터를 Min=0, Max=1 이 되도록 Scaling 해줍니다.&lt;/p&gt;
&lt;p&gt;불필요한 연산량을 줄이는데 도움됩니다.&lt;/p&gt;
&lt;p&gt;sklearn 의 preprocessing 모듈을 이용하면 편리하게 scaling 작업을 하실 수 있습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Feature Scaling&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.preprocessing&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MinMaxScaler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MinMaxScaler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feature_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#checking the scaling result of A2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[23]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;lt;matplotlib.lines.Line2D at 0x11775c048&amp;gt;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
NCB8AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;그래프를 보시면 0과 1사이의 값으로 잘 Scaling 된것을 보실 수 있습니다.&lt;/p&gt;
&lt;p&gt;이제 데이터 준비가 완료되었으니, 준비된 데이터들을 clustering 해봅시다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[25]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Training the SOM&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#from minisom import MiniSom&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;som&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MiniSom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;som&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_weights_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;som&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;만들어놓은 MiniSom model 을 불러오고 Default map 사이즈와 input dimension을 지정해줍니다.&lt;/p&gt;
&lt;p&gt;random_weight_init 으로 각 node 들을 초기화시켜준 후&lt;/p&gt;
&lt;p&gt;train_random 메서드로 SOM 학습을 시작합니다.&lt;/p&gt;
&lt;h2 id=&quot;3.-&amp;#54869;&amp;#51064;&quot;&gt;3. &amp;#54869;&amp;#51064;&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-&amp;#54869;&amp;#51064;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;학습이 끝나고 학습의 결과를 pylab 모듈을 통해 확인하겠습니다.&lt;/p&gt;
&lt;p&gt;우선 10*10 map 을 평면 위에 표현하고&lt;/p&gt;
&lt;p&gt;node 에 최근접한 data point 들이 많을수록 짙게, 적을수록 옅게 표시해줍니다.&lt;/p&gt;
&lt;p&gt;Map 의 진한 부분엔 데이터들이 모여있다는 뜻입니다. (Clustering 된것입니다.)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;따로 빼놓은 y : 카드 발급 여부 데이터를 이제 사용합니다.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Map 위에 data point 들에 대응되는 y 를 표현합니다.&lt;/p&gt;
&lt;p&gt;data point 와 최근접한 node 위에 data point가 발급 승인된 고객이면 초록네모, 발급 거절된 고객이면 빨간동그라미로 마킹합니다.&lt;/p&gt;
&lt;p&gt;진한 node 위에 마킹이 많이 될 것입니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[26]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Visualizing the results&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pylab&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pcolor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pcolor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;som&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;markers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;s&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;g&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;som&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;markers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;markeredgecolor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;markerfacecolor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;None&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;markeredgewidth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
hoD4P64beYXJrrfPAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이제 결과를 보시면, Map의 진한부분은 데이터가 많이 모인부분, 연한부분은 데이터가 거의 없는 부분이라고 보시면 되는데&lt;/p&gt;
&lt;p&gt;이상한 점은 node 가 하얗게 표시된, 연결된 데이터포인트가 거의 없는, 즉 응집이 전혀 없는 부분에 존재하는 데이터들입니다.&lt;/p&gt;
&lt;p&gt;저 고객들은 다른 고객들과 전혀 다른 feature 의 구성을 띄고 있어서, 어느 cluster 에도 끼지 못했습니다.&lt;/p&gt;
&lt;p&gt;저런 고객들은 수상하죠. 잠재 위험 고객으로 분류합니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[28]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Finding the frauds&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mappings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;som&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;win_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frauds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concatenate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mappings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mappings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frauds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inverse_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frauds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[30]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frauds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#수상한 data 56개 : 다른 데이터들과 거리가 멀다&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[30]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(56, 15)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;수상한 데이터 56개가 검출되었습니다.&lt;/p&gt;
&lt;p&gt;아래를 보시면 node(1,4) 에 38개가 수상하고, node(2,9)에 18개가 수상합니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[33]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mappings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(1,4) node 가 winning node(가장가까운노드) 인 data의 갯수 : 38개 &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[33]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(38, 15)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[34]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mappings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(2,9) node 가 winning node(가장가까운노드) 인 data의 갯수 : 18개 &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[34]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(18, 15)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;수상한 고객들의 id 를 뽑아서 확인해보겠습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[35]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frauds_customers_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frauds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[36]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frauds_customers_id&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[36]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ 15739548.,  15699839.,  15648069.,  15731586.,  15705918.,
        15706762.,  15672894.,  15575605.,  15644453.,  15783883.,
        15756538.,  15694666.,  15728523.,  15646594.,  15593959.,
        15629750.,  15675926.,  15794204.,  15734008.,  15592999.,
        15757434.,  15769548.,  15742009.,  15593834.,  15673907.,
        15737909.,  15599272.,  15660528.,  15779207.,  15711299.,
        15609987.,  15752578.,  15721504.,  15666096.,  15609758.,
        15611682.,  15618258.,  15805261.,  15767729.,  15711446.,
        15720529.,  15787693.,  15688210.,  15704509.,  15793366.,
        15793317.,  15735106.,  15688059.,  15646521.,  15683276.,
        15652289.,  15768777.,  15791326.,  15678779.,  15779586.,
        15730150.])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;&amp;#47560;&amp;#52824;&amp;#47728;&quot;&gt;&amp;#47560;&amp;#52824;&amp;#47728;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#47560;&amp;#52824;&amp;#47728;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;이렇게 SOM 을 간단하게 살펴보았습니다.&lt;/p&gt;
&lt;p&gt;궁금한 점 댓글로 남겨주시기 바랍니다. 감사합니다^^.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">Self Organizing Map 에 대해서 알아보겠습니다. Udemy 의 Deep-Learning-A-to-Z 강의 의 SOM 파트를 수강하고 작성하였습니다. Self Organizing Map은 줄여서 SOM 이라고 부릅니다. Unsupervised learning 방법 중 하나이며 Clustering 에 쓰입니다. Clustering 작업을 수행하는, SOM 보다 조금 단순한 K-mean 알고리즘을 보고 SOM 을 보면 이해가 쉽습니다. K-mean Cluster&amp;#182;K-mean &amp;#51032; &amp;#44208;&amp;#44284; = Clustering&amp;#182;아래의 그림은 K-mean 알고리즘으로 클러스터링 한 결과를 보여줍니다. K-mean &amp;#51032; &amp;#54617;&amp;#49845; &amp;#44284;&amp;#51221;&amp;#182; K-mean 의 학습과정은 단순합니다. 과정 step1 몇개의 군집으로 나눌것인지 K 를 설정해줍니다. step2 군집으로 나눌 데이터 분포들 사이에 K개의 랜덤한 센트로이드 포인트들을 잡습니다.(랜덤하게 잡으면 엉뚱하게 Clustering하는 에러도 있기도 합니다) step3 각각의 데이터 포인트틀과 가장 가까운 센트로이드 포인트를 찾습니다. (이것이 K Cluser 형태가 됩니다) step4 K 개로 나뉜 각 군집의 새로운 중심점을 찾아 새로운 센트로이드 포인트로 지정합니다. step5 새로운 센트로이드 포인트에 대해 다시 step3 처럼 가까운 데이터포인트들을 묶습니다.(K Cluster 형태가 됩니다) ... 센트로이드 포인트 이동이 멈추기 전까지 step4 로 다시 돌아갑니다. SOM Structrue&amp;#182;SOM 은 조금 다릅니다. SOM 은 우선 Map size 를 설정해줍니다. (2차원으로 x=3, y=3 크기의 Map 이라고 가정합시다) Map Size 를 설정해, 전혀 학습하지 않은 생 Map 을 Default Map 이라고 칭하겠습니다. 이제 이 Default Map 을 조금씩 수정해서(학습해서) 데이터 분포 형태에 Map 을 근사시키려고 합니다. 3*3 사이즈의 map 은 9개의 map point = Node 로 이루어졍있고, 각 Node 는 데이터의 차원수와 동일한 parameter 갯수를 가집니다. 사진에서는 3차원 X(x1,x2,x3) 데이터 이므로 Node_i(w_i1, w_i2, w_i3) 가 i=1~9 로 존재합니다. 이제 이 각각의 Node 들과 각 데이터 X 사이의 거리를 구합니다. 이들중 데이터와 가장 가까운 node 를 winning node 라고 마킹합니다. 점(w1i,w2i,w3i)들과 데이터의 feature인 (x1,x2,x3) 점과의 distance 를 좁혀나갑니다. 아래는 map 을 데이터에 맞게 점점 fitting 시키는 모습입니다. 특정 데이터 점 하나가 SOMap 의 한 점을 점점 끌어당기는 모습입니다. (실제론 winning node 와 그 주변 node 까지 동시에 끌어당깁니다.) 이런식으로 모든 데이터에 대해 SOMap 의 각 점을 끌어오면 SOMap 완성됩니다. SOM&amp;#51032; &amp;#53945;&amp;#51669;&amp;#182;SOM 의 특징은 아래와 같습니다. SOM 은 Input 데이터들 사이의 위상을 잘 나타냅니다. SOM 은 잘 구별되지 않는 데이터간의 correlation 을 찾아낼 수 있습니다. SOM 은 비지도 학습으로 Clustering 을 수행할 수 있습니다. 비지도이고, Label Data 가 없으므로, Back propagation 과정도 없습니다. output node 간에 후속 연결이 없습니다. Training &amp;#51204;&amp;#47029;&amp;#182;자세한 SOM 의 학습 과정은 아래와 같습니다. Python Code&amp;#182; SOM model code SOM model use code 1. SOM model code&amp;#182; In&amp;nbsp;[24]: from math import sqrt from numpy import (array, unravel_index, nditer, linalg, random, subtract, power, exp, pi, zeros, arange, outer, meshgrid, dot) from collections import defaultdict from warnings import warn &amp;quot;&amp;quot;&amp;quot; Minimalistic implementation of the Self Organizing Maps (SOM). &amp;quot;&amp;quot;&amp;quot; def fast_norm(x): &amp;quot;&amp;quot;&amp;quot;Returns norm-2 of a 1-D numpy array. * faster than linalg.norm in case of 1-D arrays (numpy 1.9.2rc1). &amp;quot;&amp;quot;&amp;quot; return sqrt(dot(x, x.T)) class MiniSom(object): def __init__(self, x, y, input_len, sigma=1.0, learning_rate=0.5, decay_function=None, random_seed=None): &amp;quot;&amp;quot;&amp;quot; Initializes a Self Organizing Maps. x,y - dimensions of the SOM input_len - number of the elements of the vectors in input sigma - spread of the neighborhood function (Gaussian), needs to be adequate to the dimensions of the map. (at the iteration t we have sigma(t) = sigma / (1 + t/T) where T is #num_iteration/2) learning_rate - initial learning rate (at the iteration t we have learning_rate(t) = learning_rate / (1 + t/T) where T is #num_iteration/2) decay_function, function that reduces learning_rate and sigma at each iteration default function: lambda x,current_iteration,max_iter: x/(1+current_iteration/max_iter) random_seed, random seed to use. &amp;quot;&amp;quot;&amp;quot; if sigma &amp;gt;= x/2.0 or sigma &amp;gt;= y/2.0: warn(&amp;#39;Warning: sigma is too high for the dimension of the map.&amp;#39;) if random_seed: self.random_generator = random.RandomState(random_seed) else: self.random_generator = random.RandomState(random_seed) if decay_function: self._decay_function = decay_function else: self._decay_function = lambda x, t, max_iter: x/(1+t/max_iter) self.learning_rate = learning_rate self.sigma = sigma self.weights = self.random_generator.rand(x,y,input_len)*2-1 # random initialization for i in range(x): for j in range(y): self.weights[i,j] = self.weights[i,j] / fast_norm(self.weights[i,j]) # normalization self.activation_map = zeros((x,y)) self.neigx = arange(x) self.neigy = arange(y) # used to evaluate the neighborhood function self.neighborhood = self.gaussian def _activate(self, x): &amp;quot;&amp;quot;&amp;quot; Updates matrix activation_map, in this matrix the element i,j is the response of the neuron i,j to x &amp;quot;&amp;quot;&amp;quot; s = subtract(x, self.weights) # x - w it = nditer(self.activation_map, flags=[&amp;#39;multi_index&amp;#39;]) while not it.finished: self.activation_map[it.multi_index] = fast_norm(s[it.multi_index]) # || x - w || it.iternext() def activate(self, x): &amp;quot;&amp;quot;&amp;quot; Returns the activation map to x &amp;quot;&amp;quot;&amp;quot; self._activate(x) return self.activation_map def gaussian(self, c, sigma): &amp;quot;&amp;quot;&amp;quot; Returns a Gaussian centered in c &amp;quot;&amp;quot;&amp;quot; d = 2*pi*sigma*sigma ax = exp(-power(self.neigx-c[0], 2)/d) ay = exp(-power(self.neigy-c[1], 2)/d) return outer(ax, ay) # the external product gives a matrix def diff_gaussian(self, c, sigma): &amp;quot;&amp;quot;&amp;quot; Mexican hat centered in c (unused) &amp;quot;&amp;quot;&amp;quot; xx, yy = meshgrid(self.neigx, self.neigy) p = power(xx-c[0], 2) + power(yy-c[1], 2) d = 2*pi*sigma*sigma return exp(-p/d)*(1-2/d*p) def winner(self, x): &amp;quot;&amp;quot;&amp;quot; Computes the coordinates of the winning neuron for the sample x &amp;quot;&amp;quot;&amp;quot; self._activate(x) return unravel_index(self.activation_map.argmin(), self.activation_map.shape) def update(self, x, win, t): &amp;quot;&amp;quot;&amp;quot; Updates the weights of the neurons. x - current pattern to learn win - position of the winning neuron for x (array or tuple). t - iteration index &amp;quot;&amp;quot;&amp;quot; eta = self._decay_function(self.learning_rate, t, self.T) sig = self._decay_function(self.sigma, t, self.T) # sigma and learning rate decrease with the same rule g = self.neighborhood(win, sig)*eta # improves the performances it = nditer(g, flags=[&amp;#39;multi_index&amp;#39;]) while not it.finished: # eta * neighborhood_function * (x-w) self.weights[it.multi_index] += g[it.multi_index]*(x-self.weights[it.multi_index]) # normalization self.weights[it.multi_index] = self.weights[it.multi_index] / fast_norm(self.weights[it.multi_index]) it.iternext() def quantization(self, data): &amp;quot;&amp;quot;&amp;quot; Assigns a code book (weights vector of the winning neuron) to each sample in data. &amp;quot;&amp;quot;&amp;quot; q = zeros(data.shape) for i, x in enumerate(data): q[i] = self.weights[self.winner(x)] return q def random_weights_init(self, data): &amp;quot;&amp;quot;&amp;quot; Initializes the weights of the SOM picking random samples from data &amp;quot;&amp;quot;&amp;quot; it = nditer(self.activation_map, flags=[&amp;#39;multi_index&amp;#39;]) while not it.finished: self.weights[it.multi_index] = data[self.random_generator.randint(len(data))] self.weights[it.multi_index] = self.weights[it.multi_index]/fast_norm(self.weights[it.multi_index]) it.iternext() def train_random(self, data, num_iteration): &amp;quot;&amp;quot;&amp;quot; Trains the SOM picking samples at random from data &amp;quot;&amp;quot;&amp;quot; self._init_T(num_iteration) for iteration in range(num_iteration): rand_i = self.random_generator.randint(len(data)) # pick a random sample self.update(data[rand_i], self.winner(data[rand_i]), iteration) def train_batch(self, data, num_iteration): &amp;quot;&amp;quot;&amp;quot; Trains using all the vectors in data sequentially &amp;quot;&amp;quot;&amp;quot; self._init_T(len(data)*num_iteration) iteration = 0 while iteration &amp;lt; num_iteration: idx = iteration % (len(data)-1) self.update(data[idx], self.winner(data[idx]), iteration) iteration += 1 def _init_T(self, num_iteration): &amp;quot;&amp;quot;&amp;quot; Initializes the parameter T needed to adjust the learning rate &amp;quot;&amp;quot;&amp;quot; self.T = num_iteration/2 # keeps the learning rate nearly constant for the last half of the iterations def distance_map(self): &amp;quot;&amp;quot;&amp;quot; Returns the distance map of the weights. Each cell is the normalised sum of the distances between a neuron and its neighbours. &amp;quot;&amp;quot;&amp;quot; um = zeros((self.weights.shape[0], self.weights.shape[1])) it = nditer(um, flags=[&amp;#39;multi_index&amp;#39;]) while not it.finished: for ii in range(it.multi_index[0]-1, it.multi_index[0]+2): for jj in range(it.multi_index[1]-1, it.multi_index[1]+2): if ii &amp;gt;= 0 and ii &amp;lt; self.weights.shape[0] and jj &amp;gt;= 0 and jj &amp;lt; self.weights.shape[1]: um[it.multi_index] += fast_norm(self.weights[ii, jj, :]-self.weights[it.multi_index]) it.iternext() um = um/um.max() return um def activation_response(self, data): &amp;quot;&amp;quot;&amp;quot; Returns a matrix where the element i,j is the number of times that the neuron i,j have been winner. &amp;quot;&amp;quot;&amp;quot; a = zeros((self.weights.shape[0], self.weights.shape[1])) for x in data: a[self.winner(x)] += 1 return a def quantization_error(self, data): &amp;quot;&amp;quot;&amp;quot; Returns the quantization error computed as the average distance between each input sample and its best matching unit. &amp;quot;&amp;quot;&amp;quot; error = 0 for x in data: error += fast_norm(x-self.weights[self.winner(x)]) return error/len(data) def win_map(self, data): &amp;quot;&amp;quot;&amp;quot; Returns a dictionary wm where wm[(i,j)] is a list with all the patterns that have been mapped in the position i,j. &amp;quot;&amp;quot;&amp;quot; winmap = defaultdict(list) for x in data: winmap[self.winner(x)].append(x) return winmap ### unit tests &amp;#39;&amp;#39;&amp;#39; from numpy.testing import assert_almost_equal, assert_array_almost_equal, assert_array_equal class TestMinisom: def setup_method(self, method): self.som = MiniSom(5, 5, 1) for i in range(5): for j in range(5): assert_almost_equal(1.0, linalg.norm(self.som.weights[i,j])) # checking weights normalization self.som.weights = zeros((5, 5)) # fake weights self.som.weights[2, 3] = 5.0 self.som.weights[1, 1] = 2.0 def test_decay_function(self): assert self.som._decay_function(1., 2., 3.) == 1./(1.+2./3.) def test_fast_norm(self): assert fast_norm(array([1, 3])) == sqrt(1+9) def test_gaussian(self): bell = self.som.gaussian((2, 2), 1) assert bell.max() == 1.0 assert bell.argmax() == 12 # unravel(12) = (2,2) def test_win_map(self): winners = self.som.win_map([5.0, 2.0]) assert winners[(2, 3)][0] == 5.0 assert winners[(1, 1)][0] == 2.0 def test_activation_reponse(self): response = self.som.activation_response([5.0, 2.0]) assert response[2, 3] == 1 assert response[1, 1] == 1 def test_activate(self): assert self.som.activate(5.0).argmin() == 13.0 # unravel(13) = (2,3) def test_quantization_error(self): self.som.quantization_error([5, 2]) == 0.0 self.som.quantization_error([4, 1]) == 0.5 def test_quantization(self): q = self.som.quantization(array([4, 2])) assert q[0] == 5.0 assert q[1] == 2.0 def test_random_seed(self): som1 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) som2 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) assert_array_almost_equal(som1.weights, som2.weights) # same initialization data = random.rand(100,2) som1 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) som1.train_random(data,10) som2 = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) som2.train_random(data,10) assert_array_almost_equal(som1.weights,som2.weights) # same state after training def test_train_batch(self): som = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) data = array([[4, 2], [3, 1]]) q1 = som.quantization_error(data) som.train_batch(data, 10) assert q1 &amp;gt; som.quantization_error(data) def test_train_random(self): som = MiniSom(5, 5, 2, sigma=1.0, learning_rate=0.5, random_seed=1) data = array([[4, 2], [3, 1]]) q1 = som.quantization_error(data) som.train_random(data, 10) assert q1 &amp;gt; som.quantization_error(data) def test_random_weights_init(self): som = MiniSom(2, 2, 2, random_seed=1) som.random_weights_init(array([[1.0, .0]])) for w in som.weights: assert_array_equal(w[0], array([1.0, .0])) &amp;#39;&amp;#39;&amp;#39; 2. SOM model use code&amp;#182;만든 SOM model 을 이용해 Credit card 발급 신청자 데이터를 Clustering 해보고, 수상한 사람을 찾아내보도록 하겠습니다. 우선 데이터를 불러옵니다. In&amp;nbsp;[1]: import numpy as np import matplotlib.pyplot as plt import pandas as pd In&amp;nbsp;[3]: %matplotlib inline In&amp;nbsp;[2]: #Importing the dataset dataset = pd.read_csv(&amp;#39;Credit_Card_Applications.csv&amp;#39;) X = dataset.iloc[:, :-1].values y = dataset.iloc[:, -1].values In&amp;nbsp;[16]: dataset Out[16]: CustomerID A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 Class 0 15776156 1 22.08 11.460 2 4 4 1.585 0 0 0 1 2 100 1213 0 1 15739548 0 22.67 7.000 2 8 4 0.165 0 0 0 0 2 160 1 0 2 15662854 0 29.58 1.750 1 4 4 1.250 0 0 0 1 2 280 1 0 3 15687688 0 21.67 11.500 1 5 3 0.000 1 1 11 1 2 0 1 1 4 15715750 1 20.17 8.170 2 6 4 1.960 1 1 14 0 2 60 159 1 5 15571121 0 15.83 0.585 2 8 8 1.500 1 1 2 0 2 100 1 1 6 15726466 1 17.42 6.500 2 3 4 0.125 0 0 0 0 2 60 101 0 7 15660390 0 58.67 4.460 2 11 8 3.040 1 1 6 0 2 43 561 1 8 15663942 1 27.83 1.000 1 2 8 3.000 0 0 0 0 2 176 538 0 9 15638610 0 55.75 7.080 2 4 8 6.750 1 1 3 1 2 100 51 0 10 15644446 1 33.50 1.750 2 14 8 4.500 1 1 4 1 2 253 858 1 11 15585892 1 41.42 5.000 2 11 8 5.000 1 1 6 1 2 470 1 1 12 15609356 1 20.67 1.250 1 8 8 1.375 1 1 3 1 2 140 211 0 13 15803378 1 34.92 5.000 2 14 8 7.500 1 1 6 1 2 0 1001 1 14 15599440 1 58.58 2.710 2 8 4 2.415 0 0 0 1 2 320 1 0 15 15692408 1 48.08 6.040 2 4 4 0.040 0 0 0 0 2 0 2691 1 16 15683168 1 29.58 4.500 2 9 4 7.500 1 1 2 1 2 330 1 1 17 15790254 0 18.92 9.000 2 6 4 0.750 1 1 2 0 2 88 592 1 18 15767729 1 20.00 1.250 1 4 4 0.125 0 0 0 0 2 140 5 0 19 15768600 0 22.42 5.665 2 11 4 2.585 1 1 7 0 2 129 3258 1 20 15699839 0 28.17 0.585 2 6 4 0.040 0 0 0 0 2 260 1005 0 21 15786237 0 19.17 0.585 1 6 4 0.585 1 0 0 1 2 160 1 0 22 15694530 1 41.17 1.335 2 2 4 0.165 0 0 0 0 2 168 1 0 23 15796813 1 41.58 1.750 2 4 4 0.210 1 0 0 0 2 160 1 0 24 15605791 1 19.50 9.585 2 6 4 0.790 0 0 0 0 2 80 351 0 25 15714087 1 32.75 1.500 2 13 8 5.500 1 1 3 1 2 0 1 1 26 15711446 1 22.50 0.125 1 4 4 0.125 0 0 0 0 2 200 71 0 27 15588123 1 33.17 3.040 1 8 8 2.040 1 1 1 1 2 180 18028 1 28 15748552 0 30.67 12.000 2 8 4 2.000 1 1 1 0 2 220 20 1 29 15618410 1 23.08 2.500 2 8 4 1.085 1 1 11 1 2 60 2185 1 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 660 15598586 1 26.67 2.710 1 13 4 5.250 1 1 1 0 2 211 1 1 661 15665014 0 22.50 0.415 2 3 4 0.335 0 0 0 1 1 144 1 0 662 15701738 1 39.92 0.540 1 6 4 0.500 1 1 3 0 2 200 1001 1 663 15650591 0 26.08 8.665 2 6 4 1.415 1 0 0 0 2 160 151 1 664 15652667 1 20.00 0.000 2 2 4 0.500 0 0 0 0 2 144 1 0 665 15679622 1 31.57 4.000 1 3 4 0.085 0 0 0 1 2 411 1 0 666 15730150 1 26.75 4.500 1 8 5 2.500 0 0 0 0 2 200 1211 0 667 15813192 0 24.92 1.250 2 1 1 0.000 1 0 0 0 2 80 1 0 668 15606554 0 32.25 1.500 2 8 4 0.250 0 0 0 1 2 372 123 0 669 15611794 1 17.67 4.460 2 8 4 0.250 0 0 0 0 1 80 1 0 670 15672357 0 37.75 5.500 2 11 4 0.125 1 0 0 1 2 228 1 1 671 15711759 1 22.67 2.540 1 8 8 2.585 1 0 0 0 2 0 1 1 672 15615296 0 17.92 10.210 2 1 1 0.000 0 0 0 0 2 0 51 0 673 15699294 1 24.42 12.335 2 11 8 1.585 1 0 0 1 2 120 1 1 674 15788634 0 25.75 0.500 2 8 8 0.875 1 0 0 1 2 491 1 1 675 15660871 1 26.17 12.500 1 4 8 1.250 0 0 0 1 2 0 18 0 676 15618258 0 22.75 6.165 2 6 4 0.165 0 0 0 0 2 220 1001 0 677 15722535 1 23.00 0.750 2 7 4 0.500 1 0 0 1 1 320 1 0 678 15711977 1 25.67 0.290 1 8 4 1.500 0 0 0 1 2 160 1 0 679 15690169 1 48.58 0.205 1 4 4 0.250 1 1 11 0 2 380 2733 1 680 15790689 1 21.17 0.000 2 8 4 0.500 0 0 0 1 1 0 1 0 681 15665181 1 35.25 16.500 1 8 4 4.000 1 0 0 0 2 80 1 0 682 15633608 0 22.92 11.585 2 13 4 0.040 1 0 0 0 2 80 1350 1 683 15805261 0 48.17 1.335 2 3 7 0.335 0 0 0 0 2 0 121 0 684 15740356 1 43.00 0.290 1 13 8 1.750 1 1 8 0 2 100 376 1 685 15808223 1 31.57 10.500 2 14 4 6.500 1 0 0 0 2 0 1 1 686 15769980 1 20.67 0.415 2 8 4 0.125 0 0 0 0 2 0 45 0 687 15675450 0 18.83 9.540 2 6 4 0.085 1 0 0 0 2 100 1 1 688 15776494 0 27.42 14.500 2 14 8 3.085 1 1 1 0 2 120 12 1 689 15592412 1 41.00 0.040 2 10 4 0.040 0 1 1 0 1 560 1 1 690 rows × 16 columns 데이터를 보시면 첫번째줄은 고객 식별번호id 이고 마지막줄은 카드발급 승인 여부입니다. 이중 마지막 카드발급 승인여부는 따로 y 로 빼둡니다. Clustering 에 고려할 feature 가 아니기 때문입니다. 그리고 나중에 Clustering 이 잘 되었는지 확인해 볼 때 사용합니다. 데이터를 Min=0, Max=1 이 되도록 Scaling 해줍니다. 불필요한 연산량을 줄이는데 도움됩니다. sklearn 의 preprocessing 모듈을 이용하면 편리하게 scaling 작업을 하실 수 있습니다. In&amp;nbsp;[17]: # Feature Scaling from sklearn.preprocessing import MinMaxScaler sc = MinMaxScaler(feature_range = (0, 1)) X = sc.fit_transform(X) In&amp;nbsp;[23]: plt.plot(X[:,2]) #checking the scaling result of A2 Out[23]: [&amp;lt;matplotlib.lines.Line2D at 0x11775c048&amp;gt;] 그래프를 보시면 0과 1사이의 값으로 잘 Scaling 된것을 보실 수 있습니다. 이제 데이터 준비가 완료되었으니, 준비된 데이터들을 clustering 해봅시다. In&amp;nbsp;[25]: # Training the SOM #from minisom import MiniSom som = MiniSom(x = 10, y = 10, input_len = 15, sigma = 1.0, learning_rate = 0.5) som.random_weights_init(X) som.train_random(data = X, num_iteration = 100) 만들어놓은 MiniSom model 을 불러오고 Default map 사이즈와 input dimension을 지정해줍니다. random_weight_init 으로 각 node 들을 초기화시켜준 후 train_random 메서드로 SOM 학습을 시작합니다. 3. &amp;#54869;&amp;#51064;&amp;#182;학습이 끝나고 학습의 결과를 pylab 모듈을 통해 확인하겠습니다. 우선 10*10 map 을 평면 위에 표현하고 node 에 최근접한 data point 들이 많을수록 짙게, 적을수록 옅게 표시해줍니다. Map 의 진한 부분엔 데이터들이 모여있다는 뜻입니다. (Clustering 된것입니다.) 따로 빼놓은 y : 카드 발급 여부 데이터를 이제 사용합니다. Map 위에 data point 들에 대응되는 y 를 표현합니다. data point 와 최근접한 node 위에 data point가 발급 승인된 고객이면 초록네모, 발급 거절된 고객이면 빨간동그라미로 마킹합니다. 진한 node 위에 마킹이 많이 될 것입니다. In&amp;nbsp;[26]: # Visualizing the results from pylab import bone, pcolor, colorbar, plot, show bone() pcolor(som.distance_map().T) colorbar() markers = [&amp;#39;o&amp;#39;, &amp;#39;s&amp;#39;] colors = [&amp;#39;r&amp;#39;, &amp;#39;g&amp;#39;] for i, x in enumerate(X): w = som.winner(x) plot(w[0] + 0.5, w[1] + 0.5, markers[y[i]], markeredgecolor = colors[y[i]], markerfacecolor = &amp;#39;None&amp;#39;, markersize = 10, markeredgewidth = 2) show() 이제 결과를 보시면, Map의 진한부분은 데이터가 많이 모인부분, 연한부분은 데이터가 거의 없는 부분이라고 보시면 되는데 이상한 점은 node 가 하얗게 표시된, 연결된 데이터포인트가 거의 없는, 즉 응집이 전혀 없는 부분에 존재하는 데이터들입니다. 저 고객들은 다른 고객들과 전혀 다른 feature 의 구성을 띄고 있어서, 어느 cluster 에도 끼지 못했습니다. 저런 고객들은 수상하죠. 잠재 위험 고객으로 분류합니다. In&amp;nbsp;[28]: # Finding the frauds mappings = som.win_map(X) frauds = np.concatenate((mappings[(1,4)], mappings[(2,9)]), axis = 0) frauds = sc.inverse_transform(frauds) In&amp;nbsp;[30]: frauds.shape #수상한 data 56개 : 다른 데이터들과 거리가 멀다 Out[30]: (56, 15) 수상한 데이터 56개가 검출되었습니다. 아래를 보시면 node(1,4) 에 38개가 수상하고, node(2,9)에 18개가 수상합니다. In&amp;nbsp;[33]: np.array(mappings[(1,4)]).shape #(1,4) node 가 winning node(가장가까운노드) 인 data의 갯수 : 38개 Out[33]: (38, 15) In&amp;nbsp;[34]: np.array(mappings[(2,9)]).shape #(2,9) node 가 winning node(가장가까운노드) 인 data의 갯수 : 18개 Out[34]: (18, 15) 수상한 고객들의 id 를 뽑아서 확인해보겠습니다. In&amp;nbsp;[35]: frauds_customers_id=frauds[:, 0] In&amp;nbsp;[36]: frauds_customers_id Out[36]: array([ 15739548., 15699839., 15648069., 15731586., 15705918., 15706762., 15672894., 15575605., 15644453., 15783883., 15756538., 15694666., 15728523., 15646594., 15593959., 15629750., 15675926., 15794204., 15734008., 15592999., 15757434., 15769548., 15742009., 15593834., 15673907., 15737909., 15599272., 15660528., 15779207., 15711299., 15609987., 15752578., 15721504., 15666096., 15609758., 15611682., 15618258., 15805261., 15767729., 15711446., 15720529., 15787693., 15688210., 15704509., 15793366., 15793317., 15735106., 15688059., 15646521., 15683276., 15652289., 15768777., 15791326., 15678779., 15779586., 15730150.]) &amp;#47560;&amp;#52824;&amp;#47728;&amp;#182;이렇게 SOM 을 간단하게 살펴보았습니다. 궁금한 점 댓글로 남겨주시기 바랍니다. 감사합니다^^.</summary></entry><entry><title type="html">Textboxes(2016) : Image Text Detection 논문 리뷰</title><link href="https://shinjayne.github.io//deeplearning/2017/07/21/text-boxes-paper-review-1.html" rel="alternate" type="text/html" title="Textboxes(2016) : Image Text Detection 논문 리뷰" /><published>2017-07-21T18:27:50+09:00</published><updated>2017-07-21T18:27:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/07/21/text-boxes-paper-review-1</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/07/21/text-boxes-paper-review-1.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이번 글에서는 &lt;strong&gt;&lt;em&gt;Textboxes: A Fast Text Detector with a single Deep Neural Network(2016)&lt;/em&gt;&lt;/strong&gt; 란 딥러닝 최신 논문을&lt;/p&gt;
&lt;p&gt;가볍게 정리해보도록 하겠습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;&amp;#52280;&amp;#44256;-&amp;#47553;&amp;#53356;&quot;&gt;&amp;#52280;&amp;#44256; &amp;#47553;&amp;#53356;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#52280;&amp;#44256;-&amp;#47553;&amp;#53356;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1611.06779&quot;&gt;textboxes 논문 원본(arxiv.org)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/shinjayne/shinTB&quot;&gt;textboxes 를tensorflow 로 (필자)본인이 구현한 코드(github)&lt;/a&gt; &lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;1.-Introduction&quot;&gt;1. Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Introduction&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;scene-text-detection-&amp;#51032;-&amp;#54952;&amp;#50857;&amp;#49457;&quot;&gt;scene text detection &amp;#51032; &amp;#54952;&amp;#50857;&amp;#49457;&lt;a class=&quot;anchor-link&quot; href=&quot;#scene-text-detection-&amp;#51032;-&amp;#54952;&amp;#50857;&amp;#49457;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;scene text 가 일상 환경에서 많이 접할 수 있는 visual object 이며, scene text detection 의 일상에서의&lt;/p&gt;
&lt;p&gt;높은 효용성을 강조합니다.&lt;/p&gt;
&lt;h3 id=&quot;scene-text-detection-&amp;#48156;&amp;#51204;&amp;#51032;-&amp;#50612;&amp;#47140;&amp;#50880;&quot;&gt;scene text detection &amp;#48156;&amp;#51204;&amp;#51032; &amp;#50612;&amp;#47140;&amp;#50880;&lt;a class=&quot;anchor-link&quot; href=&quot;#scene-text-detection-&amp;#48156;&amp;#51204;&amp;#51032;-&amp;#50612;&amp;#47140;&amp;#50880;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;기존의 traditional OCR(전통적인 광학적 문자인식)과 매우 유사한 task를 가지고 있음에도 불구하고,&lt;/p&gt;
&lt;p&gt;scene text detection 은 많은 어려움으로 더딘 발전을 겪고 있었다고 합니다.&lt;/p&gt;
&lt;p&gt;그 어려움에는 '너무 다양한 배경과 글자의 형태' , '빛 상태에 따른 글자 상태의 다양성' 등이 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;&amp;#44592;&amp;#51316;&amp;#51032;-&amp;#48373;&amp;#51105;&amp;#54616;&amp;#44256;-&amp;#45712;&amp;#47536;-scene-text-detection-&amp;#47784;&amp;#45944;&quot;&gt;&amp;#44592;&amp;#51316;&amp;#51032; &amp;#48373;&amp;#51105;&amp;#54616;&amp;#44256; &amp;#45712;&amp;#47536; scene text detection &amp;#47784;&amp;#45944;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#44592;&amp;#51316;&amp;#51032;-&amp;#48373;&amp;#51105;&amp;#54616;&amp;#44256;-&amp;#45712;&amp;#47536;-scene-text-detection-&amp;#47784;&amp;#45944;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;기존의 scene text detection 은&lt;/p&gt;
&lt;p&gt;&quot;글자/단어 후보 생성&quot; -&amp;gt; &quot;후보 필터링&quot; -&amp;gt; &quot;grouping&quot; 과 같은 여러 단계로 나누어져 있어서,&lt;/p&gt;
&lt;p&gt;모델 학습 중의 tuning 이 매우 어려웠고,&lt;/p&gt;
&lt;p&gt;완성된 모델의 속도도 매우 느려서 real-time detection 에 적용하기 힘들었다고 합니다.&lt;/p&gt;
&lt;h3 id=&quot;&amp;#54620;&amp;#44228;&amp;#47484;-&amp;#44537;&amp;#48373;&amp;#54620;-textboxes&quot;&gt;&amp;#54620;&amp;#44228;&amp;#47484; &amp;#44537;&amp;#48373;&amp;#54620; textboxes&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#54620;&amp;#44228;&amp;#47484;-&amp;#44537;&amp;#48373;&amp;#54620;-textboxes&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;저자는 Textboxes 는 object detection 에서 큰 성능 향상을 보여준 &lt;a href=&quot;https://arxiv.org/abs/1512.02325&quot;&gt;SSD(2015) 논문&lt;/a&gt; 을 본따 만들었으며,&lt;/p&gt;
&lt;p&gt;single network 로 구성되어있기 때문에 기존의 모델들에 비해 현저히 빠른 성능을 보여주고,&lt;/p&gt;
&lt;p&gt;정확도 또한 기존 모델들로부터 크게 향상시켰다고 말합니다.&lt;/p&gt;
&lt;h3 id=&quot;SSD-&amp;#50752;&amp;#51032;-&amp;#50976;&amp;#49324;&amp;#49457;&quot;&gt;SSD &amp;#50752;&amp;#51032; &amp;#50976;&amp;#49324;&amp;#49457;&lt;a class=&quot;anchor-link&quot; href=&quot;#SSD-&amp;#50752;&amp;#51032;-&amp;#50976;&amp;#49324;&amp;#49457;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Textboxes 모델은 SSD(sigle shot mulitbox detector) 와 구조가 매우 유사하며,&lt;/p&gt;
&lt;p&gt;오직 모델 내부의 몇가지 하이퍼-파라메터들만 텍스트 인식에 알맞도록 조정하였다고 합니다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;( default box 와 convolutional kernel(filter) 의 종횡비(ratio) 를 가로로 길게 늘린 것이 그것입니다 )&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&quot;word-recognition-&amp;#51032;-feedback-&amp;#51012;-&amp;#53685;&amp;#54644;-detection-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45908;&amp;#50865;-&amp;#54693;&amp;#49345;-&amp;#44032;&amp;#45733;&quot;&gt;word recognition &amp;#51032; feedback &amp;#51012; &amp;#53685;&amp;#54644; detection &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45908;&amp;#50865; &amp;#54693;&amp;#49345; &amp;#44032;&amp;#45733;&lt;a class=&quot;anchor-link&quot; href=&quot;#word-recognition-&amp;#51032;-feedback-&amp;#51012;-&amp;#53685;&amp;#54644;-detection-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45908;&amp;#50865;-&amp;#54693;&amp;#49345;-&amp;#44032;&amp;#45733;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;보통 &lt;em&gt;scene text reading&lt;/em&gt; 분야는 text detection 과 text recognition 의 두가지 task로 나뉘는데&lt;/p&gt;
&lt;p&gt;Textboxes 모델은 이중에 text detection 을 수행합니다.&lt;/p&gt;
&lt;p&gt;하지만 Textboxes 는 detection 후 다양한 text recognition 모델들과 연계가 가능하며,&lt;/p&gt;
&lt;p&gt;특정한 given set (lexicon, 단어무리) 이 주어졌을 때에는 text recognition 의 feedback이  detection 모델의 학습 성능을 향상시켜준다고&lt;/p&gt;
&lt;p&gt;논문에서는 말합니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;2.-Related-Works&quot;&gt;2. Related Works&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Related-Works&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;&amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;em&gt;scene text reading&lt;/em&gt; 분야는 detection 과 recognition 으로 나뉘고,&lt;/p&gt;
&lt;p&gt;detection 은 다시한번 charicter based(글자 단위) 와 word based(단어 단위) 로 나뉩니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;1.-charicter-based(&amp;#44544;&amp;#51088;-&amp;#45800;&amp;#50948;)-&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;1. charicter based(&amp;#44544;&amp;#51088; &amp;#45800;&amp;#50948;) &amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-charicter-based(&amp;#44544;&amp;#51088;-&amp;#45800;&amp;#50948;)-&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Lukas Neumann, Jiri Matas 의 &lt;a href=&quot;https://www.semanticscholar.org/paper/Real-time-scene-text-localization-and-recognition-Neumann-Matas/323649409db200d2eebed0091f9ea25151a1c36b&quot;&gt;real time scene textlocalization and recognition(2012)&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;2.-word-based(&amp;#45800;&amp;#50612;-&amp;#45800;&amp;#50948;)-&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;2. word based(&amp;#45800;&amp;#50612; &amp;#45800;&amp;#50948;) &amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-word-based(&amp;#45800;&amp;#50612;-&amp;#45800;&amp;#50948;)-&amp;#49440;&amp;#54665;-&amp;#45436;&amp;#47928;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&amp;lt; R-CNN based &amp;gt;&lt;/p&gt;
&lt;p&gt;Max Jaderberg, Karen Simonyan, Andrea Vedaldi, Andrew Zisserman 의 &lt;a href=&quot;https://www.semanticscholar.org/paper/Reading-Text-in-the-Wild-with-Convolutional-Neural-Jaderberg-Simonyan/b1a25f665cd18b2a22e5804a2a012af282d59f1b&quot;&gt;Reading Text in the Wild with Convolutional Neural Networks(2015)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;lt; YOLO based &amp;gt;&lt;/p&gt;
&lt;p&gt;Ankush Gupta, Andrea Vedaldi, Andrew Zisserman 의 &lt;a href=&quot;https://www.semanticscholar.org/paper/Synthetic-Data-for-Text-Localisation-in-Natural-Im-Gupta-Vedaldi/18f51e9bdc1abdb6f1601c5c0692d6c150421a48&quot;&gt;Synthetic Data for Text Localisation in Natural Images(2016)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Textboxes-&amp;#45716;-word-based-&amp;#47784;&amp;#45944;&quot;&gt;Textboxes &amp;#45716; word based &amp;#47784;&amp;#45944;&lt;a class=&quot;anchor-link&quot; href=&quot;#Textboxes-&amp;#45716;-word-based-&amp;#47784;&amp;#45944;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Textboxes 는 단어별로 detection 하는 word based 모델입니다.&lt;/p&gt;
&lt;h3 id=&quot;Textboxes-&amp;#45716;-SSD-&amp;#50640;&amp;#49436;-&amp;#50689;&amp;#44048;&quot;&gt;Textboxes &amp;#45716; SSD &amp;#50640;&amp;#49436; &amp;#50689;&amp;#44048;&lt;a class=&quot;anchor-link&quot; href=&quot;#Textboxes-&amp;#45716;-SSD-&amp;#50640;&amp;#49436;-&amp;#50689;&amp;#44048;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed, Cheng-Yang Fu, Alexander C. Berg 의&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://arxiv.org/abs/1512.02325&quot;&gt;Single Shot Mulitbox Detector(2015)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Textboxes 의 모델 구조는 SSD(Single shot mulitbox detector) 에서 영감을 얻었습니다.&lt;/p&gt;
&lt;p&gt;( 실제로 SSD 에서 사용하는 모델 구조, box matching scheme , loss function 등을 인용해 거의 그대로 사용합니다.)&lt;/p&gt;
&lt;h3 id=&quot;Textboxes(-detection-)--&amp;gt;-CRNN(-recognition-)-&amp;#51032;-&amp;#50672;&amp;#44208;&amp;#46020;-&amp;#44396;&amp;#54788;&amp;#54632;&quot;&gt;Textboxes( detection ) -&amp;gt; CRNN( recognition ) &amp;#51032; &amp;#50672;&amp;#44208;&amp;#46020; &amp;#44396;&amp;#54788;&amp;#54632;&lt;a class=&quot;anchor-link&quot; href=&quot;#Textboxes(-detection-)--&amp;gt;-CRNN(-recognition-)-&amp;#51032;-&amp;#50672;&amp;#44208;&amp;#46020;-&amp;#44396;&amp;#54788;&amp;#54632;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;Shi, Baoguang; Bai, Xiang; Yao, Cong 의 
&lt;a href=&quot;http://adsabs.harvard.edu/abs/2015arXiv150705717S&quot;&gt;An End-to-End Trainable Neural Network for Image-based Sequence Recognition and Its Application to Scene Text Recognition(2015)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;end-to-end(detection to recognition) 모델 학습을 위해 Textboxes 모델과 CRNN 을 통한 text recognition 모델을 연결하여 사용하였습니다.&lt;/p&gt;
&lt;p&gt;논문은  뒷단에 다양한 recognition 모델을 붙여 end-to-end training 이 가능한 것이 Textboxes 의 장점이라고 밝혔습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;3.-Detecting-with-Textboxes&quot;&gt;3. Detecting with Textboxes&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Detecting-with-Textboxes&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;3-1.-Training-Phase&quot;&gt;3-1. Training Phase&lt;a class=&quot;anchor-link&quot; href=&quot;#3-1.-Training-Phase&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;hr/&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#47784;&amp;#45944;-&amp;#44396;&amp;#51312;-Architecture&quot;&gt;&amp;#47784;&amp;#45944; &amp;#44396;&amp;#51312; Architecture&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#47784;&amp;#45944;-&amp;#44396;&amp;#51312;-Architecture&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Textboxes 는 오직 convolution과 pooling 으로만 이루어진 fully-convolutional-network 입니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;&amp;lt;&amp;#45436;&amp;#47928;&amp;#51032;-&amp;#47784;&amp;#45944;-&amp;#44536;&amp;#47548;&amp;gt;&quot;&gt;&amp;lt;&amp;#45436;&amp;#47928;&amp;#51032; &amp;#47784;&amp;#45944; &amp;#44536;&amp;#47548;&amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;&amp;#45436;&amp;#47928;&amp;#51032;-&amp;#47784;&amp;#45944;-&amp;#44536;&amp;#47548;&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/tb/model1.png&quot; alt=&quot;모델그림&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;위는 논문에 실린 모델의 모습입니다. 이 모델 그림을 기반으로 아래에 제가 해석한 모델 그림을 그려보았습니다.&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;&amp;lt;&amp;#51649;&amp;#51217;-&amp;#45796;&amp;#49884;-&amp;#44536;&amp;#47536;-&amp;#47784;&amp;#45944;-&amp;#44536;&amp;#47548;&amp;gt;&quot;&gt;&amp;lt;&amp;#51649;&amp;#51217; &amp;#45796;&amp;#49884; &amp;#44536;&amp;#47536; &amp;#47784;&amp;#45944; &amp;#44536;&amp;#47548;&amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;&amp;#51649;&amp;#51217;-&amp;#45796;&amp;#49884;-&amp;#44536;&amp;#47536;-&amp;#47784;&amp;#45944;-&amp;#44536;&amp;#47548;&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/tb/1.png&quot; alt=&quot;표&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/tb/2.png&quot; alt=&quot;표&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;input images 는 RGB 로 3개의 채널로 되어있습니다.&lt;/p&gt;
&lt;p&gt;input images 의 사이즈는 임의로 300*300 으로 설정하고 진행하였습니다. (다른 사이즈의 input 도 가능합니다)&lt;/p&gt;
&lt;blockquote&gt;&lt;용어&gt;

&lt;p&gt;연속적인 convolution layer 가 이어진 부분을 &lt;strong&gt;&quot;Base network&quot;&lt;/strong&gt; 이라고 하고,&lt;/p&gt;
&lt;p&gt;Base network 에서 중간중간 feature map 을 가져오는 위치를 &lt;strong&gt;&quot;Map Point&quot;&lt;/strong&gt; 라고 일컫습니다.&lt;/p&gt;
&lt;p&gt;Map Point 에서 가져온 feature map 들을 새로운 convolution 을 수행해서 만들어낸 이 모델의 &lt;strong&gt;output&lt;/strong&gt; 들을 &lt;strong&gt;&quot;Textbox Layer&quot;&lt;/strong&gt; 라고 부릅니다.&lt;/p&gt;
&lt;p&gt;즉 Textboxes 모델은 training (loss function) 에 사용되는 output 이 한 값이 아닌, &lt;em&gt;Textbox Layer&lt;/em&gt; 가 됩니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;input images 는 Base network 을 거치면서 수많은 feature map들을 만들고,&lt;/p&gt;
&lt;p&gt;중간중간 Map point 에서 feature map 들을 추출해 가로로 긴 filter([1,5]) 를 이용한 convolution 을 수행해&lt;/p&gt;
&lt;p&gt;channel 이 72개인 Texbox Layer( output ) 를 생성해냅니다.&lt;/p&gt;
&lt;p&gt;다양한 크기의 feature map 을 중간중간 이용하는 이유는 다양한 크기의 text 들을 detection 하기 위해서입니다.&lt;/p&gt;
&lt;h3 id=&quot;Base-network-&amp;#45236;&amp;#48512;-&amp;#45936;&amp;#51060;&amp;#53552;-&amp;#55120;&amp;#47492;-&amp;#54364;&quot;&gt;Base network &amp;#45236;&amp;#48512; &amp;#45936;&amp;#51060;&amp;#53552; &amp;#55120;&amp;#47492; &amp;#54364;&lt;a class=&quot;anchor-link&quot; href=&quot;#Base-network-&amp;#45236;&amp;#48512;-&amp;#45936;&amp;#51060;&amp;#53552;-&amp;#55120;&amp;#47492;-&amp;#54364;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;표에서 노란색으로 하이라이트 된 부분이 &lt;strong&gt;Map Point&lt;/strong&gt; 입니다. 
&lt;img src=&quot;/images/tb/model2.png&quot; alt=&quot;표&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Textbox-Layer-&amp;#51032;-&amp;#52292;&amp;#45328;&amp;#51060;-72&amp;#44060;&amp;#51064;-&amp;#51060;&amp;#50976;&quot;&gt;Textbox Layer &amp;#51032; &amp;#52292;&amp;#45328;&amp;#51060; 72&amp;#44060;&amp;#51064; &amp;#51060;&amp;#50976;&lt;a class=&quot;anchor-link&quot; href=&quot;#Textbox-Layer-&amp;#51032;-&amp;#52292;&amp;#45328;&amp;#51060;-72&amp;#44060;&amp;#51064;-&amp;#51060;&amp;#50976;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;72 라는 숫자는 무엇일까요?&lt;/p&gt;
&lt;p&gt;Textboxes 모델은 각 Map Point 의 각 픽셀마다 Default Box 를 다양한 종횡비로 12개씩 미리 설정해놓습니다. (SSD 와 같습니다)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(무수히 많은 default box 들이 생깁니다.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;하나의 Default box 는 하나의 predicted box 를 만들어냅니다.&lt;/p&gt;
&lt;p&gt;predicted box는 offset 4값(dx, dy, dw, dh) 과  confidence 2값(c1, c2) 으로 이루어져 있습니다.&lt;/p&gt;
&lt;p&gt;하나의 feature map 픽셀당 12개씩의 default box들이 존재하므로&lt;/p&gt;
&lt;p&gt;총 12 * 6(4+2) = 72 개의 결과값이 나옵니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h3 id=&quot;offset?&quot;&gt;offset?&lt;a class=&quot;anchor-link&quot; href=&quot;#offset?&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;predicted box 가 산출된 defualt box 로부터의 형태 변화량입니다.&lt;/p&gt;
&lt;p&gt;하나의 default box는 하나의 predicted box 를 만들어낼 때&lt;/p&gt;
&lt;p&gt;한 default box 가 &lt;strong&gt;(x0,y0) 에 위치&lt;/strong&gt;하고 &lt;strong&gt;너비가 w0, 높이가 h0 &lt;/strong&gt; 라고 하면&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;(모든 box들은 0~1 로 scaling 된 맵 위의 (x,y,w,h) 값을 가집니다. 그래야 서로 다른 크기의 map location 들사이에서의 비교가 가능하기 때문입니다. )&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그리고 그 default box로부터 예측된 predicted box 의 offset 이 &lt;strong&gt;(dx, dy ,dw, dh)&lt;/strong&gt; 라면&lt;/p&gt;
&lt;p&gt;predicted box 의 위치 정보(x, y, w, h)는 다음과 같이 복구할 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/tb/3.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Default-box-&amp;#47484;-&amp;#47564;&amp;#46300;&amp;#45716;-&amp;#48169;&amp;#48277;&quot;&gt;Default box &amp;#47484; &amp;#47564;&amp;#46300;&amp;#45716; &amp;#48169;&amp;#48277;&lt;a class=&quot;anchor-link&quot; href=&quot;#Default-box-&amp;#47484;-&amp;#47564;&amp;#46300;&amp;#45716;-&amp;#48169;&amp;#48277;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;모델을 훈련시키기 전, 우선 각 Map Location 의 각 픽셀당 12개씩 , 총 수만개의 Default box 들을 만들어주어야 합니다.&lt;/p&gt;
&lt;p&gt;각 default box의 x0,y0 값(0~1 사이로 scaling된 값) 은 각 Map Location 의 각 픽셀마다 모두 다르지만&lt;/p&gt;
&lt;p&gt;w0,h0 값은 아닙니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;종횡비(ratio)&lt;/strong&gt; 와 &lt;strong&gt;Scale&lt;/strong&gt; 이라는 값으로 컨트롤합니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;&amp;#54620;-Map-Location-&amp;#51032;-12&amp;#44060;&amp;#51032;-Default-Box&amp;#46308;&amp;#51008;-&amp;#44033;-&amp;#54589;&amp;#49472;&amp;#47560;&amp;#45796;-&amp;#47784;&amp;#50577;&amp;#51060;-&amp;#47784;&amp;#46160;-&amp;#44057;&amp;#45796;.&quot;&gt;&amp;#54620; Map Location &amp;#51032; 12&amp;#44060;&amp;#51032; Default Box&amp;#46308;&amp;#51008; &amp;#44033; &amp;#54589;&amp;#49472;&amp;#47560;&amp;#45796; &amp;#47784;&amp;#50577;&amp;#51060; &amp;#47784;&amp;#46160; &amp;#44057;&amp;#45796;.&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#54620;-Map-Location-&amp;#51032;-12&amp;#44060;&amp;#51032;-Default-Box&amp;#46308;&amp;#51008;-&amp;#44033;-&amp;#54589;&amp;#49472;&amp;#47560;&amp;#45796;-&amp;#47784;&amp;#50577;&amp;#51060;-&amp;#47784;&amp;#46160;-&amp;#44057;&amp;#45796;.&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;12개의 &lt;strong&gt;종횡비(ratio)&lt;/strong&gt;를 미리 설정해놓기 때문이다.  (w:h)&lt;/p&gt;
&lt;h4 id=&quot;&amp;#54616;&amp;#51648;&amp;#47564;-&amp;#44033;-Map-Location-&amp;#47560;&amp;#45796;-Default-Box&amp;#51032;-(w0,h0)-&amp;#46308;&amp;#51008;-&amp;#44033;&amp;#44033;-&amp;#45796;&amp;#47476;&amp;#45796;.&quot;&gt;&amp;#54616;&amp;#51648;&amp;#47564; &amp;#44033; Map Location &amp;#47560;&amp;#45796; Default Box&amp;#51032; (w0,h0) &amp;#46308;&amp;#51008; &amp;#44033;&amp;#44033; &amp;#45796;&amp;#47476;&amp;#45796;.&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#54616;&amp;#51648;&amp;#47564;-&amp;#44033;-Map-Location-&amp;#47560;&amp;#45796;-Default-Box&amp;#51032;-(w0,h0)-&amp;#46308;&amp;#51008;-&amp;#44033;&amp;#44033;-&amp;#45796;&amp;#47476;&amp;#45796;.&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;6개의 Map Location 마다 정해진 종횡비에 특정 &lt;strong&gt;Scale&lt;/strong&gt; 을 곱해서 w0, h0 를 구성하기 때문이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;1)-&amp;#51333;&amp;#54945;&amp;#48708;-&amp;#44396;&amp;#49457;&quot;&gt;1) &amp;#51333;&amp;#54945;&amp;#48708; &amp;#44396;&amp;#49457;&lt;a class=&quot;anchor-link&quot; href=&quot;#1)-&amp;#51333;&amp;#54945;&amp;#48708;-&amp;#44396;&amp;#49457;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;텍스트는 기본적으로 옆으로 긴 형태를 띄고 있기 때문에 Default box 의 종횡비 또한 가로로 깁니다.&lt;/p&gt;
&lt;p&gt;논문에서는 종횡비 6가지 (1,2,3,5,7,10) 을 설정해서 픽셀의 중심에 한번, 픽셀의 아래에 한번 적용해&lt;/p&gt;
&lt;p&gt;총 12개를 한 픽셀의 default box로 정합니다.&lt;/p&gt;
&lt;p&gt;중심에 모든 박스를 넣지 않고 살짝 아래로 6개를 내린 이유는 촘촘한 detection 을 위해서입니다.&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
&lt;img src=&quot;/images/tb/4.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
그림에서 파란색은 (중심, 종횡비 1) , 검은색은 (중심, 종횡비 5), 빨간색은 (아래, 종횡비 1), 초록색은 (아래, 종횡비 5) 입니다.&lt;/p&gt;
&lt;h4 id=&quot;2)-Scale-&amp;#44396;&amp;#49457;&quot;&gt;2) Scale &amp;#44396;&amp;#49457;&lt;a class=&quot;anchor-link&quot; href=&quot;#2)-Scale-&amp;#44396;&amp;#49457;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Scale 에 관한 내용은 본 논문에는 나와있지 않지만 SSD 논문에 기술되어있고, 실제로 Textboxes 구현에서도 사용됩니다.&lt;/p&gt;
&lt;p&gt;6개의 Map location 의 각 Scale 들은 등차수열을 이룹니다.&lt;/p&gt;
&lt;h3 id=&quot;Loss-Function&quot;&gt;Loss Function&lt;a class=&quot;anchor-link&quot; href=&quot;#Loss-Function&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr /&gt;
이렇게 모든 default box 들을 준비하고, Network Model 까지 준비한 후&lt;/p&gt;
&lt;p&gt;이 모델에 image 를 넣고 동작시키면&lt;/p&gt;
&lt;p&gt;수만개의 default box 들에서 각각 (dx, dy, dw, dh, c1, c2) 값이 산출됩니다.&lt;/p&gt;
&lt;p&gt;이 값들은 loss function 을 구성하는 데에 쓰이고,&lt;/p&gt;
&lt;p&gt;우린  Optimizer 를 통해 이 loss function 을 최소화 시키는 방향으로 매 iteration 마다 나아갈 것이고,&lt;/p&gt;
&lt;p&gt;이 과정을 무수히 많이 반복하게 됩니다.&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;loss function 의 수식은 아래와 같습니다.&lt;/p&gt;
&lt;p&gt;간단히 요약하자면&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;total-loss-=-confidnece-loss-+-location-loss&quot;&gt;&lt;code&gt;total loss = confidnece loss + location loss&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#total-loss-=-confidnece-loss-+-location-loss&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/blockquote&gt;
&lt;p&gt;입니다.&lt;/p&gt;
&lt;p&gt;confidence loss 에는 softmax loss 함수를 사용합니다.&lt;/p&gt;
&lt;p&gt;location loss 에는 smooth_L1 loss 함수를 사용합니다.&lt;/p&gt;
&lt;p&gt;(아래 수식은 SSD 논문에서 가져왔습니다.)&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
&lt;img src=&quot;/images/tb/5.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
그런데 중요한 것은 우리가 모든 default box 에서 나온 prediction 값을 사용하지 않는다는 것입니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;default box 들을 positive 와 negative 로 분류합니다. &lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;h3 id=&quot;Jaccard-Overlap-&amp;amp;-Hard-Negative-Mining&quot;&gt;Jaccard Overlap &amp;amp; Hard Negative Mining&lt;a class=&quot;anchor-link&quot; href=&quot;#Jaccard-Overlap-&amp;amp;-Hard-Negative-Mining&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;우리가 미리 만들어놓은 &lt;strong&gt;모든 default box 들&lt;/strong&gt;과 한 이미지의 &lt;strong&gt;모든 ground truth box 들&lt;/strong&gt;의 Jaccard Overlap 을 비교하여&lt;/p&gt;
&lt;p&gt;Jaccard Overlap &amp;gt; 0.5 이상인 dafualt box 들을 &lt;strong&gt;positive&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Jaccard Over &amp;lt; 0.5 이하인 default box 들을 &lt;strong&gt;negative&lt;/strong&gt; 라고 지정합니다.&lt;/p&gt;
&lt;p&gt;이렇게 나누면 negative 의 갯수가 positive 의 갯수보다 현저히 많기 때문에&lt;/p&gt;
&lt;p&gt;negative 의 갯수가 positive 의 갯수의 3배가 되도록 negative 일부를 무시하고 날립니다.&lt;/p&gt;
&lt;p&gt;이 과정을 Hard Negative Mining 이라고 합니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h3 id=&quot;Jaccard-Overlap-&amp;#45436;&amp;#47928;&amp;#45236;&amp;#50857;-(SSD)&quot;&gt;Jaccard Overlap &amp;#45436;&amp;#47928;&amp;#45236;&amp;#50857; (SSD)&lt;a class=&quot;anchor-link&quot; href=&quot;#Jaccard-Overlap-&amp;#45436;&amp;#47928;&amp;#45236;&amp;#50857;-(SSD)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;
&lt;img src=&quot;/images/tb/7.png&quot; alt=&quot;수식&quot;&gt;
&lt;img src=&quot;/images/tb/9.png&quot; alt=&quot;이미지&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;hr/&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3 id=&quot;Hard-Negative-Mining-&amp;#45436;&amp;#47928;-&amp;#45236;&amp;#50857;(SSD)&quot;&gt;Hard Negative Mining &amp;#45436;&amp;#47928; &amp;#45236;&amp;#50857;(SSD)&lt;a class=&quot;anchor-link&quot; href=&quot;#Hard-Negative-Mining-&amp;#45436;&amp;#47928;-&amp;#45236;&amp;#50857;(SSD)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;
&lt;img src=&quot;/images/tb/8.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;분류가 끝나면, default box들 중&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;location loss 에서는 positive box 들만을 사용하고 &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;confidence loss 에서는 positive box 들에서는 c1 을 사용하고 negative box 들에서는 c2 를 사용합니다. &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;total loss 는 (location loss + confidence loss)/N  이 됩니다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;N 은 positive 로 검출된 box의 갯수입니다.&lt;/p&gt;
&lt;p&gt;이 값을 Optimizer 를 통해 줄여나가면서 모델을 학습시키면 됩니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h2 id=&quot;3-2.-Validation/Test-Phase&quot;&gt;3-2. Validation/Test Phase&lt;a class=&quot;anchor-link&quot; href=&quot;#3-2.-Validation/Test-Phase&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;hr/&gt; 

&lt;h3 id=&quot;Non-Maximum-Supression-(NMS)&quot;&gt;Non Maximum Supression (NMS)&lt;a class=&quot;anchor-link&quot; href=&quot;#Non-Maximum-Supression-(NMS)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Training 이 끝난 모델에 input image 를 넣으면 output 으로 Textbox Layer 가 나옵니다.&lt;/p&gt;
&lt;p&gt;하지만 Textbox Layer 자체로는 Detecting 완성되었다고 할 수 없습니다.&lt;/p&gt;
&lt;p&gt;수많은 값들 중 무엇이 진짜 Predicted Box 인지 골라주어야 합니다.&lt;/p&gt;
&lt;p&gt;이 부분에 NMS 라는 방법이 사용됩니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;참고 링크 : &lt;a href=&quot;http://www.voidcn.com/blog/u014365862/article/p-5749434.html&quot;&gt;Non-Maximum Suppression for Object Detection in Python&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;img src=&quot;/images/tb/10.jpg&quot; alt=&quot;수식&quot;&gt;
NMS 를 수행하면 위처럼 여러개의 후보 predicted box 를 단일의 Most predicted box로 추려줍니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Model-Accuracy-&amp;#52769;&amp;#51221;&quot;&gt;Model Accuracy &amp;#52769;&amp;#51221;&lt;a class=&quot;anchor-link&quot; href=&quot;#Model-Accuracy-&amp;#52769;&amp;#51221;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;학습을 마친 모델의 성능을 보려면 어떻게 Accuracy 를 측정할 것인지도 매우 중요합니다.&lt;/p&gt;
&lt;p&gt;Accuracy 측정에는 &lt;strong&gt;F-Mesure&lt;/strong&gt; 를 이용합니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h3 id=&quot;F-Mesure&quot;&gt;F-Mesure&lt;a class=&quot;anchor-link&quot; href=&quot;#F-Mesure&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;F measure 는 실제로 정확도를 측정하는데 매우 자주 이용되고, 중요합니다.&lt;/p&gt;
&lt;p&gt;기계학습에서 정확도를 평가하는데 중요한 지표중 두가지가 &lt;strong&gt;정확도(precision)&lt;/strong&gt; 와 &lt;strong&gt;재현율(recall)&lt;/strong&gt; 입니다.&lt;/p&gt;
&lt;p&gt;정확도와 재현율에 대한 이해를 돕고자 그림을 그려보았습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/tb/12.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;p&gt;정확도(precision)는 우리가 &lt;strong&gt;Positive 라고 예상한 것&lt;/strong&gt; 중 &lt;strong&gt;맞춘 것&lt;/strong&gt;의 비율입니다.&lt;/p&gt;
&lt;p&gt;재현율(recall)은 &lt;strong&gt;실제 ground truth&lt;/strong&gt; 중 &lt;strong&gt;맞춘 것&lt;/strong&gt; 의 비율입니다.&lt;/p&gt;
&lt;p&gt;이 두 지표 모두 중요한데&lt;/p&gt;
&lt;p&gt;F-Mesure 는 precision 과 recall 의 비중을 적절히 혼합한 정확도 수치라고 할 수 있습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;h4 id=&quot;&amp;lt;-F-Mesure-&amp;#44277;&amp;#49885;-&amp;gt;&quot;&gt;&amp;lt; F-Mesure &amp;#44277;&amp;#49885; &amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;-F-Mesure-&amp;#44277;&amp;#49885;-&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/tb/13.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;p&gt;precision 과 recall 의 조화평균&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;F-Mesure 를 이용해 Textboxes 모델의 Accuracy 를 구하는 방법은 다음과 같습니다.&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
&lt;img src=&quot;/images/tb/14.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
논문에서도 다양한 데이터셋에 대해 자신들이 훈련한 실제 Textboxes detection Model 의 성능을&lt;/p&gt;
&lt;p&gt;P(Precision) / R(Recall) / F(F-Measure)&lt;/p&gt;
&lt;p&gt;세가지 지표로 Accuracy 를 계산해 자랑해놓았습니다.&lt;/p&gt;
&lt;p&gt;다양한 text detection 모델들과의 비교도 해놓았습니다.&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
&lt;img src=&quot;/images/tb/15.png&quot; alt=&quot;수식&quot;&gt;&lt;/p&gt;
&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#45436;&amp;#47928;&amp;#47532;&amp;#48624;&amp;#47484;-&amp;#47560;&amp;#52824;&amp;#47728;&quot;&gt;&amp;#45436;&amp;#47928;&amp;#47532;&amp;#48624;&amp;#47484; &amp;#47560;&amp;#52824;&amp;#47728;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#45436;&amp;#47928;&amp;#47532;&amp;#48624;&amp;#47484;-&amp;#47560;&amp;#52824;&amp;#47728;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
&lt;br/&gt;
실제로 Textboxes 는 C_RNN 과 같은 Recognition 모델과 연결해 한번에 학습시킬 수 있는 장점도 있습니다.&lt;/p&gt;
&lt;p&gt;기회가 된다면 그 연결된 완성형 모델까지 리뷰해볼 생각입니다.&lt;/p&gt;
&lt;p&gt;Textboxes 의 실제 구현도 python tensorflow 로 구현해 곧 post 로 올릴 예정이니&lt;/p&gt;
&lt;p&gt;관심있으시면&lt;/p&gt;
&lt;p&gt;블로그를 둘러봐주시면 감사하겠습니다.&lt;/p&gt;
&lt;p&gt;궁금한점이나 틀린 부분은 댓글로 편하게 말씀해주시면 기쁘게 수정하겠습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">이번 글에서는 Textboxes: A Fast Text Detector with a single Deep Neural Network(2016) 란 딥러닝 최신 논문을 가볍게 정리해보도록 하겠습니다. &amp;#52280;&amp;#44256; &amp;#47553;&amp;#53356;&amp;#182; textboxes 논문 원본(arxiv.org) textboxes 를tensorflow 로 (필자)본인이 구현한 코드(github) 1. Introduction&amp;#182; scene text detection &amp;#51032; &amp;#54952;&amp;#50857;&amp;#49457;&amp;#182;scene text 가 일상 환경에서 많이 접할 수 있는 visual object 이며, scene text detection 의 일상에서의 높은 효용성을 강조합니다. scene text detection &amp;#48156;&amp;#51204;&amp;#51032; &amp;#50612;&amp;#47140;&amp;#50880;&amp;#182;기존의 traditional OCR(전통적인 광학적 문자인식)과 매우 유사한 task를 가지고 있음에도 불구하고, scene text detection 은 많은 어려움으로 더딘 발전을 겪고 있었다고 합니다. 그 어려움에는 '너무 다양한 배경과 글자의 형태' , '빛 상태에 따른 글자 상태의 다양성' 등이 있습니다. &amp;#44592;&amp;#51316;&amp;#51032; &amp;#48373;&amp;#51105;&amp;#54616;&amp;#44256; &amp;#45712;&amp;#47536; scene text detection &amp;#47784;&amp;#45944;&amp;#182;기존의 scene text detection 은 &quot;글자/단어 후보 생성&quot; -&amp;gt; &quot;후보 필터링&quot; -&amp;gt; &quot;grouping&quot; 과 같은 여러 단계로 나누어져 있어서, 모델 학습 중의 tuning 이 매우 어려웠고, 완성된 모델의 속도도 매우 느려서 real-time detection 에 적용하기 힘들었다고 합니다. &amp;#54620;&amp;#44228;&amp;#47484; &amp;#44537;&amp;#48373;&amp;#54620; textboxes&amp;#182;저자는 Textboxes 는 object detection 에서 큰 성능 향상을 보여준 SSD(2015) 논문 을 본따 만들었으며, single network 로 구성되어있기 때문에 기존의 모델들에 비해 현저히 빠른 성능을 보여주고, 정확도 또한 기존 모델들로부터 크게 향상시켰다고 말합니다. SSD &amp;#50752;&amp;#51032; &amp;#50976;&amp;#49324;&amp;#49457;&amp;#182;Textboxes 모델은 SSD(sigle shot mulitbox detector) 와 구조가 매우 유사하며, 오직 모델 내부의 몇가지 하이퍼-파라메터들만 텍스트 인식에 알맞도록 조정하였다고 합니다. ( default box 와 convolutional kernel(filter) 의 종횡비(ratio) 를 가로로 길게 늘린 것이 그것입니다 ) word recognition &amp;#51032; feedback &amp;#51012; &amp;#53685;&amp;#54644; detection &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45908;&amp;#50865; &amp;#54693;&amp;#49345; &amp;#44032;&amp;#45733;&amp;#182;보통 scene text reading 분야는 text detection 과 text recognition 의 두가지 task로 나뉘는데 Textboxes 모델은 이중에 text detection 을 수행합니다. 하지만 Textboxes 는 detection 후 다양한 text recognition 모델들과 연계가 가능하며, 특정한 given set (lexicon, 단어무리) 이 주어졌을 때에는 text recognition 의 feedback이 detection 모델의 학습 성능을 향상시켜준다고 논문에서는 말합니다. 2. Related Works&amp;#182; &amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&amp;#182;scene text reading 분야는 detection 과 recognition 으로 나뉘고, detection 은 다시한번 charicter based(글자 단위) 와 word based(단어 단위) 로 나뉩니다. 1. charicter based(&amp;#44544;&amp;#51088; &amp;#45800;&amp;#50948;) &amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&amp;#182;Lukas Neumann, Jiri Matas 의 real time scene textlocalization and recognition(2012) 2. word based(&amp;#45800;&amp;#50612; &amp;#45800;&amp;#50948;) &amp;#49440;&amp;#54665; &amp;#45436;&amp;#47928;&amp;#182;&amp;lt; R-CNN based &amp;gt; Max Jaderberg, Karen Simonyan, Andrea Vedaldi, Andrew Zisserman 의 Reading Text in the Wild with Convolutional Neural Networks(2015) &amp;lt; YOLO based &amp;gt; Ankush Gupta, Andrea Vedaldi, Andrew Zisserman 의 Synthetic Data for Text Localisation in Natural Images(2016) Textboxes &amp;#45716; word based &amp;#47784;&amp;#45944;&amp;#182;Textboxes 는 단어별로 detection 하는 word based 모델입니다. Textboxes &amp;#45716; SSD &amp;#50640;&amp;#49436; &amp;#50689;&amp;#44048;&amp;#182;Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed, Cheng-Yang Fu, Alexander C. Berg 의 Single Shot Mulitbox Detector(2015) Textboxes 의 모델 구조는 SSD(Single shot mulitbox detector) 에서 영감을 얻었습니다. ( 실제로 SSD 에서 사용하는 모델 구조, box matching scheme , loss function 등을 인용해 거의 그대로 사용합니다.) Textboxes( detection ) -&amp;gt; CRNN( recognition ) &amp;#51032; &amp;#50672;&amp;#44208;&amp;#46020; &amp;#44396;&amp;#54788;&amp;#54632;&amp;#182;Shi, Baoguang; Bai, Xiang; Yao, Cong 의 An End-to-End Trainable Neural Network for Image-based Sequence Recognition and Its Application to Scene Text Recognition(2015) end-to-end(detection to recognition) 모델 학습을 위해 Textboxes 모델과 CRNN 을 통한 text recognition 모델을 연결하여 사용하였습니다. 논문은 뒷단에 다양한 recognition 모델을 붙여 end-to-end training 이 가능한 것이 Textboxes 의 장점이라고 밝혔습니다. 3. Detecting with Textboxes&amp;#182; 3-1. Training Phase&amp;#182; &amp;#47784;&amp;#45944; &amp;#44396;&amp;#51312; Architecture&amp;#182;Textboxes 는 오직 convolution과 pooling 으로만 이루어진 fully-convolutional-network 입니다. &amp;lt;&amp;#45436;&amp;#47928;&amp;#51032; &amp;#47784;&amp;#45944; &amp;#44536;&amp;#47548;&amp;gt;&amp;#182; 위는 논문에 실린 모델의 모습입니다. 이 모델 그림을 기반으로 아래에 제가 해석한 모델 그림을 그려보았습니다. &amp;lt;&amp;#51649;&amp;#51217; &amp;#45796;&amp;#49884; &amp;#44536;&amp;#47536; &amp;#47784;&amp;#45944; &amp;#44536;&amp;#47548;&amp;gt;&amp;#182; input images 는 RGB 로 3개의 채널로 되어있습니다. input images 의 사이즈는 임의로 300*300 으로 설정하고 진행하였습니다. (다른 사이즈의 input 도 가능합니다) 연속적인 convolution layer 가 이어진 부분을 &quot;Base network&quot; 이라고 하고, Base network 에서 중간중간 feature map 을 가져오는 위치를 &quot;Map Point&quot; 라고 일컫습니다. Map Point 에서 가져온 feature map 들을 새로운 convolution 을 수행해서 만들어낸 이 모델의 output 들을 &quot;Textbox Layer&quot; 라고 부릅니다. 즉 Textboxes 모델은 training (loss function) 에 사용되는 output 이 한 값이 아닌, Textbox Layer 가 됩니다. input images 는 Base network 을 거치면서 수많은 feature map들을 만들고, 중간중간 Map point 에서 feature map 들을 추출해 가로로 긴 filter([1,5]) 를 이용한 convolution 을 수행해 channel 이 72개인 Texbox Layer( output ) 를 생성해냅니다. 다양한 크기의 feature map 을 중간중간 이용하는 이유는 다양한 크기의 text 들을 detection 하기 위해서입니다. Base network &amp;#45236;&amp;#48512; &amp;#45936;&amp;#51060;&amp;#53552; &amp;#55120;&amp;#47492; &amp;#54364;&amp;#182;표에서 노란색으로 하이라이트 된 부분이 Map Point 입니다. Textbox Layer &amp;#51032; &amp;#52292;&amp;#45328;&amp;#51060; 72&amp;#44060;&amp;#51064; &amp;#51060;&amp;#50976;&amp;#182;72 라는 숫자는 무엇일까요? Textboxes 모델은 각 Map Point 의 각 픽셀마다 Default Box 를 다양한 종횡비로 12개씩 미리 설정해놓습니다. (SSD 와 같습니다) (무수히 많은 default box 들이 생깁니다.) 하나의 Default box 는 하나의 predicted box 를 만들어냅니다. predicted box는 offset 4값(dx, dy, dw, dh) 과 confidence 2값(c1, c2) 으로 이루어져 있습니다. 하나의 feature map 픽셀당 12개씩의 default box들이 존재하므로 총 12 * 6(4+2) = 72 개의 결과값이 나옵니다. offset?&amp;#182;predicted box 가 산출된 defualt box 로부터의 형태 변화량입니다. 하나의 default box는 하나의 predicted box 를 만들어낼 때 한 default box 가 (x0,y0) 에 위치하고 너비가 w0, 높이가 h0 라고 하면 (모든 box들은 0~1 로 scaling 된 맵 위의 (x,y,w,h) 값을 가집니다. 그래야 서로 다른 크기의 map location 들사이에서의 비교가 가능하기 때문입니다. ) 그리고 그 default box로부터 예측된 predicted box 의 offset 이 (dx, dy ,dw, dh) 라면 predicted box 의 위치 정보(x, y, w, h)는 다음과 같이 복구할 수 있습니다. Default box &amp;#47484; &amp;#47564;&amp;#46300;&amp;#45716; &amp;#48169;&amp;#48277;&amp;#182;모델을 훈련시키기 전, 우선 각 Map Location 의 각 픽셀당 12개씩 , 총 수만개의 Default box 들을 만들어주어야 합니다. 각 default box의 x0,y0 값(0~1 사이로 scaling된 값) 은 각 Map Location 의 각 픽셀마다 모두 다르지만 w0,h0 값은 아닙니다. 종횡비(ratio) 와 Scale 이라는 값으로 컨트롤합니다. &amp;#54620; Map Location &amp;#51032; 12&amp;#44060;&amp;#51032; Default Box&amp;#46308;&amp;#51008; &amp;#44033; &amp;#54589;&amp;#49472;&amp;#47560;&amp;#45796; &amp;#47784;&amp;#50577;&amp;#51060; &amp;#47784;&amp;#46160; &amp;#44057;&amp;#45796;.&amp;#182;12개의 종횡비(ratio)를 미리 설정해놓기 때문이다. (w:h) &amp;#54616;&amp;#51648;&amp;#47564; &amp;#44033; Map Location &amp;#47560;&amp;#45796; Default Box&amp;#51032; (w0,h0) &amp;#46308;&amp;#51008; &amp;#44033;&amp;#44033; &amp;#45796;&amp;#47476;&amp;#45796;.&amp;#182;6개의 Map Location 마다 정해진 종횡비에 특정 Scale 을 곱해서 w0, h0 를 구성하기 때문이다. 1) &amp;#51333;&amp;#54945;&amp;#48708; &amp;#44396;&amp;#49457;&amp;#182;텍스트는 기본적으로 옆으로 긴 형태를 띄고 있기 때문에 Default box 의 종횡비 또한 가로로 깁니다. 논문에서는 종횡비 6가지 (1,2,3,5,7,10) 을 설정해서 픽셀의 중심에 한번, 픽셀의 아래에 한번 적용해 총 12개를 한 픽셀의 default box로 정합니다. 중심에 모든 박스를 넣지 않고 살짝 아래로 6개를 내린 이유는 촘촘한 detection 을 위해서입니다. 그림에서 파란색은 (중심, 종횡비 1) , 검은색은 (중심, 종횡비 5), 빨간색은 (아래, 종횡비 1), 초록색은 (아래, 종횡비 5) 입니다. 2) Scale &amp;#44396;&amp;#49457;&amp;#182;Scale 에 관한 내용은 본 논문에는 나와있지 않지만 SSD 논문에 기술되어있고, 실제로 Textboxes 구현에서도 사용됩니다. 6개의 Map location 의 각 Scale 들은 등차수열을 이룹니다. Loss Function&amp;#182; 이렇게 모든 default box 들을 준비하고, Network Model 까지 준비한 후 이 모델에 image 를 넣고 동작시키면 수만개의 default box 들에서 각각 (dx, dy, dw, dh, c1, c2) 값이 산출됩니다. 이 값들은 loss function 을 구성하는 데에 쓰이고, 우린 Optimizer 를 통해 이 loss function 을 최소화 시키는 방향으로 매 iteration 마다 나아갈 것이고, 이 과정을 무수히 많이 반복하게 됩니다. loss function 의 수식은 아래와 같습니다. 간단히 요약하자면 total loss = confidnece loss + location loss&amp;#182; 입니다. confidence loss 에는 softmax loss 함수를 사용합니다. location loss 에는 smooth_L1 loss 함수를 사용합니다. (아래 수식은 SSD 논문에서 가져왔습니다.) 그런데 중요한 것은 우리가 모든 default box 에서 나온 prediction 값을 사용하지 않는다는 것입니다. default box 들을 positive 와 negative 로 분류합니다. Jaccard Overlap &amp;amp; Hard Negative Mining&amp;#182;우리가 미리 만들어놓은 모든 default box 들과 한 이미지의 모든 ground truth box 들의 Jaccard Overlap 을 비교하여 Jaccard Overlap &amp;gt; 0.5 이상인 dafualt box 들을 positive Jaccard Over &amp;lt; 0.5 이하인 default box 들을 negative 라고 지정합니다. 이렇게 나누면 negative 의 갯수가 positive 의 갯수보다 현저히 많기 때문에 negative 의 갯수가 positive 의 갯수의 3배가 되도록 negative 일부를 무시하고 날립니다. 이 과정을 Hard Negative Mining 이라고 합니다. Jaccard Overlap &amp;#45436;&amp;#47928;&amp;#45236;&amp;#50857; (SSD)&amp;#182; Hard Negative Mining &amp;#45436;&amp;#47928; &amp;#45236;&amp;#50857;(SSD)&amp;#182; 분류가 끝나면, default box들 중 location loss 에서는 positive box 들만을 사용하고 confidence loss 에서는 positive box 들에서는 c1 을 사용하고 negative box 들에서는 c2 를 사용합니다. total loss 는 (location loss + confidence loss)/N 이 됩니다. N 은 positive 로 검출된 box의 갯수입니다. 이 값을 Optimizer 를 통해 줄여나가면서 모델을 학습시키면 됩니다. 3-2. Validation/Test Phase&amp;#182; Non Maximum Supression (NMS)&amp;#182;Training 이 끝난 모델에 input image 를 넣으면 output 으로 Textbox Layer 가 나옵니다. 하지만 Textbox Layer 자체로는 Detecting 완성되었다고 할 수 없습니다. 수많은 값들 중 무엇이 진짜 Predicted Box 인지 골라주어야 합니다. 이 부분에 NMS 라는 방법이 사용됩니다. 참고 링크 : Non-Maximum Suppression for Object Detection in Python NMS 를 수행하면 위처럼 여러개의 후보 predicted box 를 단일의 Most predicted box로 추려줍니다. Model Accuracy &amp;#52769;&amp;#51221;&amp;#182;학습을 마친 모델의 성능을 보려면 어떻게 Accuracy 를 측정할 것인지도 매우 중요합니다. Accuracy 측정에는 F-Mesure 를 이용합니다. F-Mesure&amp;#182;F measure 는 실제로 정확도를 측정하는데 매우 자주 이용되고, 중요합니다. 기계학습에서 정확도를 평가하는데 중요한 지표중 두가지가 정확도(precision) 와 재현율(recall) 입니다. 정확도와 재현율에 대한 이해를 돕고자 그림을 그려보았습니다. 정확도(precision)는 우리가 Positive 라고 예상한 것 중 맞춘 것의 비율입니다. 재현율(recall)은 실제 ground truth 중 맞춘 것 의 비율입니다. 이 두 지표 모두 중요한데 F-Mesure 는 precision 과 recall 의 비중을 적절히 혼합한 정확도 수치라고 할 수 있습니다. &amp;lt; F-Mesure &amp;#44277;&amp;#49885; &amp;gt;&amp;#182; precision 과 recall 의 조화평균 F-Mesure 를 이용해 Textboxes 모델의 Accuracy 를 구하는 방법은 다음과 같습니다. 논문에서도 다양한 데이터셋에 대해 자신들이 훈련한 실제 Textboxes detection Model 의 성능을 P(Precision) / R(Recall) / F(F-Measure) 세가지 지표로 Accuracy 를 계산해 자랑해놓았습니다. 다양한 text detection 모델들과의 비교도 해놓았습니다. &amp;#45436;&amp;#47928;&amp;#47532;&amp;#48624;&amp;#47484; &amp;#47560;&amp;#52824;&amp;#47728;&amp;#182; 실제로 Textboxes 는 C_RNN 과 같은 Recognition 모델과 연결해 한번에 학습시킬 수 있는 장점도 있습니다. 기회가 된다면 그 연결된 완성형 모델까지 리뷰해볼 생각입니다. Textboxes 의 실제 구현도 python tensorflow 로 구현해 곧 post 로 올릴 예정이니 관심있으시면 블로그를 둘러봐주시면 감사하겠습니다. 궁금한점이나 틀린 부분은 댓글로 편하게 말씀해주시면 기쁘게 수정하겠습니다.</summary></entry><entry><title type="html">Efficient Back Propagation(1998) 논문 리뷰(1)</title><link href="https://shinjayne.github.io//deeplearning/2017/07/07/efficeint-back-prop-paper-review-1.html" rel="alternate" type="text/html" title="Efficient Back Propagation(1998) 논문 리뷰(1)" /><published>2017-07-07T16:30:50+09:00</published><updated>2017-07-07T16:30:50+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/07/07/efficeint-back-prop-paper-review-1</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/07/07/efficeint-back-prop-paper-review-1.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이번 글에서는 deep learning 에서 아주 중요한 back propagation 에 대한 insight를 얻기 위해,&lt;/p&gt;
&lt;p&gt;Yann LeCun 외 3명이 참여한 1998년 논문 &quot;Efficent BackProp&quot; 을 부분적으로 리뷰해보겠습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;다운로드 링크&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf&quot;&gt;이 링크&lt;/a&gt; 에서 논문 다운받아보실 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/backprop.png&quot; alt=&quot;paper&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;총 10개의 챕터로 구성된 이 논문은&lt;/p&gt;
&lt;p&gt;3장까지 간단하게 simple gradient descent 을 통한 Back Propagation 을 설명하고,&lt;/p&gt;
&lt;p&gt;4장에 몇가지 트릭들(Few Tricks) 들을 통해 그 성능을 높이는 방법들을 제시하고 있습니다.&lt;/p&gt;
&lt;p&gt;저는 제가 관심이 있었던 이 4장의 내용, 즉&lt;/p&gt;
&lt;h4 id=&quot;&amp;quot;Back-Propagation-&amp;#51004;&amp;#47196;-&amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716;-&amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45458;&amp;#51060;&amp;#45716;-Trick-&amp;#46308;&amp;quot;&quot;&gt;&quot;Back Propagation &amp;#51004;&amp;#47196; &amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716; &amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032; &amp;#54617;&amp;#49845; &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45458;&amp;#51060;&amp;#45716; Trick &amp;#46308;&quot;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;quot;Back-Propagation-&amp;#51004;&amp;#47196;-&amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716;-&amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45458;&amp;#51060;&amp;#45716;-Trick-&amp;#46308;&amp;quot;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;을 집중적으로 리뷰해보려고 합니다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(저희가 요즘 다루는 거의 대부분의 모델들은 back propagation 으로 학습하는 모델이므로 의미가 있습니다)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;논문 4장까지의 챕터 구성은 아래와 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;introduction&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Learning and Generalization&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Standard Back Propagation&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Few Practical Tricks&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;&lt;p&gt;4-1 Stochastic vs Batch Learning&lt;/p&gt;
&lt;p&gt;4-2 Shuffling the examples&lt;/p&gt;
&lt;p&gt;4.3 Normalizing inputs&lt;/p&gt;
&lt;p&gt;4.4 The Sigmoid&lt;/p&gt;
&lt;p&gt;4.5 Choosing Target Value&lt;/p&gt;
&lt;p&gt;4.6 Initializing Weight&lt;/p&gt;
&lt;p&gt;4.7 Choose Learning Rate&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;(논문의 뒷 내용이 궁금하신 분들은 직접 다운받아서 읽어보시기 바랍니다)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Back Propagation 과 그 방식으로 학습하는 모델의 구조(Neural Network 등) 을 아신다면,&lt;/p&gt;
&lt;p&gt;&quot;4. Few Practical Tricks&quot; 을 다루는 단원으로 바로 넘어가셔도 좋습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#51068;&amp;#48152;&amp;#51201;&amp;#51064;-gradient-based-&amp;#54617;&amp;#49845;-&amp;#47784;&amp;#45944;&quot;&gt;&amp;#51068;&amp;#48152;&amp;#51201;&amp;#51064; gradient-based &amp;#54617;&amp;#49845; &amp;#47784;&amp;#45944;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#51068;&amp;#48152;&amp;#51201;&amp;#51064;-gradient-based-&amp;#54617;&amp;#49845;-&amp;#47784;&amp;#45944;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;(2-.Learning-and-Generalization)&quot;&gt;(2 .Learning and Generalization)&lt;a class=&quot;anchor-link&quot; href=&quot;#(2-.Learning-and-Generalization)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;hr /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/model.png&quot; alt=&quot;model&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이 논문에서 이야기하는 모델의 모습입니다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(이런 구조를 가지는 학습 모델은 이 논문에서 말하는 trick들로 성능을 향상시킬 수 있다는 말이겠죠?)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;처음 입력값, 즉 input 은 Z 로 표현하였고,&lt;/p&gt;
&lt;p&gt;학습 가능한 Parameter 인 W 가 있고 ,&lt;/p&gt;
&lt;p&gt;모델에 W, Z가 들어가면 output M(W,Z) 가 나옵니다.&lt;/p&gt;
&lt;p&gt;output M(W,Z) 와  desired output D 를 (이 논문에서 말하는) 가장 일반적인 cost fuction 인&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;mean-square&lt;/strong&gt; 를 이용하여 E 를 산출하였습니다.&lt;/p&gt;
&lt;p&gt;E (error) 는 모델의 성능을 평가하는 유일한 스칼라값입니다.&lt;/p&gt;
&lt;p&gt;E (error) 의 값이 작을수록, 모델이 잘 학습했다고 말할 수 있습니다.&lt;/p&gt;
&lt;p&gt;즉, 머신 러닝에서의 가장 중요한 부분은&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;cost function 을 통해 나온 저 E(error) 값을 줄이는 방법을 찾는 일&lt;/strong&gt;이라고 해도 과언이 아닙니다.&lt;/p&gt;
&lt;p&gt;위와 같은 Gradient-based 학습 모델은 이 error 을 줄이는 일을&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Back Propagation&lt;/strong&gt; 이라는 과정을 통해 수행하게 됩니다.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;( 그 과정에서 Gradient 가 쓰이기 때문에 Gradient based 학습 모델이라고 부르는 것입니다. )&lt;/em&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#44592;&amp;#48376;&amp;#51201;&amp;#51064;-Back-Propagation&quot;&gt;&amp;#44592;&amp;#48376;&amp;#51201;&amp;#51064; Back Propagation&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#44592;&amp;#48376;&amp;#51201;&amp;#51064;-Back-Propagation&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;(3-.-Standard-Back-Propagation)&quot;&gt;(3 . Standard Back Propagation)&lt;a class=&quot;anchor-link&quot; href=&quot;#(3-.-Standard-Back-Propagation)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;hr /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;요즘엔 Back Propagation 을 효과적으로 빠르게 수행해주는 방법들이 많이 나와있습니다.&lt;/p&gt;
&lt;p&gt;저도 아직 그 종류들과 작동 방식들을 잘 몰라서, 참고 링크를 가져왔습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;lt;다양한 Back Propagation 알고리즘들&amp;gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://shuuki4.github.io/deep%20learning/2016/05/20/Gradient-Descent-Algorithm-Overview.html&quot;&gt;http://shuuki4.github.io/deep%20learning/2016/05/20/Gradient-Descent-Algorithm-Overview.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 글에서는 간단히 Back Propagation 의 작동 방식을 보고 넘어갈 것이기 때문에,&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;가장 기본적인 Gradient descent 알고리즘&lt;/strong&gt; 을 통해 back propagation을 살펴보겠습니다.&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;Back Propagation 은 학습 모델에서의 W(trainable parameter) 를 업데이트 하는 방법입니다.&lt;/p&gt;
&lt;p&gt;W의 값을 업데이트해서 cost function 의 결과값인 error 가 작아지게 하면 성공입니다.&lt;/p&gt;
&lt;p&gt;이 W의 업데이트과정(back propagation) 을 수백번, 수천번 반복해서 천천히 error를 줄여나가는 것입니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/wupdate2.png&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;그렇다면 W 를 얼마씩 업데이트 해주어야 할까요?&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(그 방법으로 지금까지 많은 사람들이 다양한 알고리즘을 찾아내었고, 그것이 바로 위에 소개해드린 링크의 내용입니다. )&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;가장 기본적인 Gradient Descent에서는 이전의 W_(t-1)  이  이 모델의 error 에 미친 영향을 편미분을 통해 계산해서,&lt;/p&gt;
&lt;p&gt;그 값을 업데이트값으로 사용합니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/wupdate1.png&quot; alt=&quot;mibun&quot;&gt;
&lt;em&gt;(E 는 cost function 의 결과값)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;업데이트 값을 구하는 식은 아래와 같습니다.&lt;/p&gt;
&lt;hr/&gt;



&lt;p&gt;조건 
&lt;img src=&quot;/images/backprop/render4.gif&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;에서의 y의 x 에 대한 편미분을 구하는 식은&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/render2.gif&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;입니다.&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;마찬가지로 조건&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/render3.gif&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;에서의 E 의 Wn에 대한 편미분을 구하는 식은&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/render.gif&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;이와 같습니다.&lt;/p&gt;
&lt;p&gt;천천히 살펴보시면&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;기호&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;의미&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;편미분 공식 매칭&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Wn&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;n-th layer 의 weight&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Xn&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;n-th layer 의 output&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;g(x)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;E(Xn, D)&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;...&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;f(g(x))&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;E&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;모델의 error&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;y&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;이해가 되실 겁니다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
같은 방법으로 n-1 번째 layer 의 Wn-1 이 error 에 미친 영향을 구하면 아래와 같습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/render 5.gif&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;편미분의 연속입니다.&lt;/p&gt;
&lt;p&gt;이와같은 방법으로 n-th layer(Wn), n-1-th layer(Wn-1) , ... , 2nd layer(W2), input layer(W1) 에 대해&lt;/p&gt;
&lt;p&gt;E 에 대한 각각의 편미분을 구해줍니다.&lt;/p&gt;
&lt;p&gt;그리고 그 편미분 값을 업데이트 값으로 각각의 W 에 대해 아래 연산을 해줍니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/backprop/wupdate1.png&quot; alt=&quot;mibun&quot;&gt;&lt;/p&gt;
&lt;p&gt;t는 학습 반복횟수고, 몇번째 layer 의 W 인지는 생략되어있습니다.&lt;/p&gt;
&lt;p&gt;여기서 저 업데이트 값 앞의 상수는 &lt;strong&gt;learning rate&lt;/strong&gt; 로,&lt;/p&gt;
&lt;p&gt;이 값을 어떻게 지정하느냐에 따라 학습의 효과가 달라집니다.&lt;/p&gt;
&lt;p&gt;이 값을 조정하는 방법도 4장의 trick에서 다룹니다.&lt;/p&gt;
&lt;p&gt;t값이 학습 반복 횟수라고 말씀드렸는데,&lt;/p&gt;
&lt;p&gt;이렇게 W 를 업데이트 하는 과정을 수백 수천번 반복하여 t를 올리면, E 는 점점 줄어들게 되고, 모델은 학습을 잘 하게 됩니다.&lt;/p&gt;
&lt;p&gt;이것이 기본적인 Back Propagation 을 통한 학습 모델의 학습방법입니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;h1 id=&quot;(&amp;#47700;&amp;#51064;)-Back-Propagation-&amp;#51004;&amp;#47196;-&amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716;-&amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45458;&amp;#51060;&amp;#45716;-Trick-&amp;#46308;&quot;&gt;(&amp;#47700;&amp;#51064;) Back Propagation &amp;#51004;&amp;#47196; &amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716; &amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032; &amp;#54617;&amp;#49845; &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45458;&amp;#51060;&amp;#45716; Trick &amp;#46308;&lt;a class=&quot;anchor-link&quot; href=&quot;#(&amp;#47700;&amp;#51064;)-Back-Propagation-&amp;#51004;&amp;#47196;-&amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716;-&amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032;-&amp;#54617;&amp;#49845;-&amp;#49457;&amp;#45733;&amp;#51012;-&amp;#45458;&amp;#51060;&amp;#45716;-Trick-&amp;#46308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;(4.-Few-Practical-Tricks)&quot;&gt;(4. Few Practical Tricks)&lt;a class=&quot;anchor-link&quot; href=&quot;#(4.-Few-Practical-Tricks)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;hr /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;4-1 Stochastic vs Batch Learning&lt;/p&gt;
&lt;p&gt;4-2 Shuffling the examples&lt;/p&gt;
&lt;p&gt;4.3 Normalizing inputs&lt;/p&gt;
&lt;p&gt;4.4 The Sigmoid&lt;/p&gt;
&lt;p&gt;4.5 Choosing Target Value&lt;/p&gt;
&lt;p&gt;4.6 Initializing Weight&lt;/p&gt;
&lt;p&gt;4.7 Choose Learning Rate&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;다음 포스트들에서는 이제 이런 학습 모델들의 학습 성능을 높일 수 있는 trick 들을&lt;/p&gt;
&lt;p&gt;개별적인 포스트를 통해 자세히 살펴보겠습니다.&lt;/p&gt;
&lt;p&gt;감사합니다.&lt;/p&gt;
&lt;p&gt;(질문이나 잘못된 부분 지적은 환영입니다.)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">이번 글에서는 deep learning 에서 아주 중요한 back propagation 에 대한 insight를 얻기 위해, Yann LeCun 외 3명이 참여한 1998년 논문 &quot;Efficent BackProp&quot; 을 부분적으로 리뷰해보겠습니다. 다운로드 링크 이 링크 에서 논문 다운받아보실 수 있습니다. 총 10개의 챕터로 구성된 이 논문은 3장까지 간단하게 simple gradient descent 을 통한 Back Propagation 을 설명하고, 4장에 몇가지 트릭들(Few Tricks) 들을 통해 그 성능을 높이는 방법들을 제시하고 있습니다. 저는 제가 관심이 있었던 이 4장의 내용, 즉 &quot;Back Propagation &amp;#51004;&amp;#47196; &amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716; &amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032; &amp;#54617;&amp;#49845; &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45458;&amp;#51060;&amp;#45716; Trick &amp;#46308;&quot;&amp;#182;을 집중적으로 리뷰해보려고 합니다. (저희가 요즘 다루는 거의 대부분의 모델들은 back propagation 으로 학습하는 모델이므로 의미가 있습니다) 논문 4장까지의 챕터 구성은 아래와 같습니다. introduction Learning and Generalization Standard Back Propagation Few Practical Tricks 4-1 Stochastic vs Batch Learning 4-2 Shuffling the examples 4.3 Normalizing inputs 4.4 The Sigmoid 4.5 Choosing Target Value 4.6 Initializing Weight 4.7 Choose Learning Rate (논문의 뒷 내용이 궁금하신 분들은 직접 다운받아서 읽어보시기 바랍니다) Back Propagation 과 그 방식으로 학습하는 모델의 구조(Neural Network 등) 을 아신다면, &quot;4. Few Practical Tricks&quot; 을 다루는 단원으로 바로 넘어가셔도 좋습니다. &amp;#51068;&amp;#48152;&amp;#51201;&amp;#51064; gradient-based &amp;#54617;&amp;#49845; &amp;#47784;&amp;#45944;&amp;#182;(2 .Learning and Generalization)&amp;#182; 이 논문에서 이야기하는 모델의 모습입니다. (이런 구조를 가지는 학습 모델은 이 논문에서 말하는 trick들로 성능을 향상시킬 수 있다는 말이겠죠?) 처음 입력값, 즉 input 은 Z 로 표현하였고, 학습 가능한 Parameter 인 W 가 있고 , 모델에 W, Z가 들어가면 output M(W,Z) 가 나옵니다. output M(W,Z) 와 desired output D 를 (이 논문에서 말하는) 가장 일반적인 cost fuction 인 mean-square 를 이용하여 E 를 산출하였습니다. E (error) 는 모델의 성능을 평가하는 유일한 스칼라값입니다. E (error) 의 값이 작을수록, 모델이 잘 학습했다고 말할 수 있습니다. 즉, 머신 러닝에서의 가장 중요한 부분은 cost function 을 통해 나온 저 E(error) 값을 줄이는 방법을 찾는 일이라고 해도 과언이 아닙니다. 위와 같은 Gradient-based 학습 모델은 이 error 을 줄이는 일을 Back Propagation 이라는 과정을 통해 수행하게 됩니다. ( 그 과정에서 Gradient 가 쓰이기 때문에 Gradient based 학습 모델이라고 부르는 것입니다. ) &amp;#44592;&amp;#48376;&amp;#51201;&amp;#51064; Back Propagation&amp;#182;(3 . Standard Back Propagation)&amp;#182; 요즘엔 Back Propagation 을 효과적으로 빠르게 수행해주는 방법들이 많이 나와있습니다. 저도 아직 그 종류들과 작동 방식들을 잘 몰라서, 참고 링크를 가져왔습니다. &amp;lt;다양한 Back Propagation 알고리즘들&amp;gt; http://shuuki4.github.io/deep%20learning/2016/05/20/Gradient-Descent-Algorithm-Overview.html 이 글에서는 간단히 Back Propagation 의 작동 방식을 보고 넘어갈 것이기 때문에, 가장 기본적인 Gradient descent 알고리즘 을 통해 back propagation을 살펴보겠습니다. Back Propagation 은 학습 모델에서의 W(trainable parameter) 를 업데이트 하는 방법입니다. W의 값을 업데이트해서 cost function 의 결과값인 error 가 작아지게 하면 성공입니다. 이 W의 업데이트과정(back propagation) 을 수백번, 수천번 반복해서 천천히 error를 줄여나가는 것입니다. 그렇다면 W 를 얼마씩 업데이트 해주어야 할까요? (그 방법으로 지금까지 많은 사람들이 다양한 알고리즘을 찾아내었고, 그것이 바로 위에 소개해드린 링크의 내용입니다. ) 가장 기본적인 Gradient Descent에서는 이전의 W_(t-1) 이 이 모델의 error 에 미친 영향을 편미분을 통해 계산해서, 그 값을 업데이트값으로 사용합니다. (E 는 cost function 의 결과값) 업데이트 값을 구하는 식은 아래와 같습니다. 조건 에서의 y의 x 에 대한 편미분을 구하는 식은 입니다. 마찬가지로 조건 에서의 E 의 Wn에 대한 편미분을 구하는 식은 이와 같습니다. 천천히 살펴보시면 기호 의미 편미분 공식 매칭 Wn n-th layer 의 weight x Xn n-th layer 의 output g(x) E(Xn, D) ... f(g(x)) E 모델의 error y 이해가 되실 겁니다. 같은 방법으로 n-1 번째 layer 의 Wn-1 이 error 에 미친 영향을 구하면 아래와 같습니다. 편미분의 연속입니다. 이와같은 방법으로 n-th layer(Wn), n-1-th layer(Wn-1) , ... , 2nd layer(W2), input layer(W1) 에 대해 E 에 대한 각각의 편미분을 구해줍니다. 그리고 그 편미분 값을 업데이트 값으로 각각의 W 에 대해 아래 연산을 해줍니다. t는 학습 반복횟수고, 몇번째 layer 의 W 인지는 생략되어있습니다. 여기서 저 업데이트 값 앞의 상수는 learning rate 로, 이 값을 어떻게 지정하느냐에 따라 학습의 효과가 달라집니다. 이 값을 조정하는 방법도 4장의 trick에서 다룹니다. t값이 학습 반복 횟수라고 말씀드렸는데, 이렇게 W 를 업데이트 하는 과정을 수백 수천번 반복하여 t를 올리면, E 는 점점 줄어들게 되고, 모델은 학습을 잘 하게 됩니다. 이것이 기본적인 Back Propagation 을 통한 학습 모델의 학습방법입니다. (&amp;#47700;&amp;#51064;) Back Propagation &amp;#51004;&amp;#47196; &amp;#54617;&amp;#49845;&amp;#54616;&amp;#45716; &amp;#47784;&amp;#45944;&amp;#46308;&amp;#51032; &amp;#54617;&amp;#49845; &amp;#49457;&amp;#45733;&amp;#51012; &amp;#45458;&amp;#51060;&amp;#45716; Trick &amp;#46308;&amp;#182;(4. Few Practical Tricks)&amp;#182; 4-1 Stochastic vs Batch Learning 4-2 Shuffling the examples 4.3 Normalizing inputs 4.4 The Sigmoid 4.5 Choosing Target Value 4.6 Initializing Weight 4.7 Choose Learning Rate 다음 포스트들에서는 이제 이런 학습 모델들의 학습 성능을 높일 수 있는 trick 들을 개별적인 포스트를 통해 자세히 살펴보겠습니다. 감사합니다. (질문이나 잘못된 부분 지적은 환영입니다.)</summary></entry><entry><title type="html">tensorflow 로 mnist 흉내내는 GAN 만들기</title><link href="https://shinjayne.github.io//deeplearning/2017/06/29/mnist-gan.html" rel="alternate" type="text/html" title="tensorflow 로 mnist 흉내내는 GAN 만들기" /><published>2017-06-29T18:00:30+09:00</published><updated>2017-06-29T18:00:30+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/06/29/mnist-gan</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/06/29/mnist-gan.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;잠깐!&lt;/p&gt;
&lt;h4 id=&quot;pre-requisite-knowledge&quot;&gt;pre-requisite knowledge&lt;a class=&quot;anchor-link&quot; href=&quot;#pre-requisite-knowledge&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;hr/&gt;
아래의 지식들을 알고 계셔야 읽기 편한 글입니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;tensorflow, numpy, matplotlib 사용법&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nueral Network (특히 Binary Classification)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;epoch, batch 단위 학습 방식&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이번 글에서는 &lt;strong&gt;GAN (Generative Adversarial Networks)&lt;/strong&gt; 를 tensorflow code 로 구현하는 방법을 알아보려고 합니다.&lt;/p&gt;
&lt;p&gt;간단한 GAN 알고리즘을 통해서, MNIST 숫자 손글씨 데이터와 닮은 가짜 손글씨 데이터를 만들어내는 모델(&lt;code&gt;mnist_GAN&lt;/code&gt;)을 만들어 보겠습니다.&lt;/p&gt;
&lt;p&gt;결과물을 미리 살짝 엿보자면 아래와 같은 실제 MNIST 데이터를&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/mnist_digits.png&quot; alt=&quot;real_mnist&quot;&gt;&lt;/p&gt;
&lt;p&gt;모델에게 계속 보여주면서 훈련시키면&lt;/p&gt;
&lt;p&gt;나중에는 아래처럼 비스무리한 숫자를 스스로 만들어낼 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/099.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;p&gt;이는 실제 제가 얻은 결과입니다.&lt;/p&gt;
&lt;p&gt;이번 공부를 하면서 참고한 자료는 아래 링크의 코드입니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/golbin/TensorFlow-Tutorials/blob/master/07%20-%20GAN/01%20-%20GAN.py&quot;&gt;https://github.com/golbin/TensorFlow-Tutorials/blob/master/07%20-%20GAN/01%20-%20GAN.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
그럼 이제&lt;/p&gt;
&lt;p&gt;어떻게 mnist 손글씨와 비슷한 이미지를 생성하는 mnist_GAN 모델을 구현하는지 보도록 하겠습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;01--mnist_GAN-&amp;#51032;-&amp;#44396;&amp;#51312;&amp;#50752;-&amp;#45936;&amp;#51060;&amp;#53552;&amp;#51032;-&amp;#55120;&amp;#47492;&quot;&gt;01  mnist_GAN &amp;#51032; &amp;#44396;&amp;#51312;&amp;#50752; &amp;#45936;&amp;#51060;&amp;#53552;&amp;#51032; &amp;#55120;&amp;#47492;&lt;a class=&quot;anchor-link&quot; href=&quot;#01--mnist_GAN-&amp;#51032;-&amp;#44396;&amp;#51312;&amp;#50752;-&amp;#45936;&amp;#51060;&amp;#53552;&amp;#51032;-&amp;#55120;&amp;#47492;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;만들어볼 모델의 구조를 설명드리겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/goblin_gan.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;GAN 은 두개의 서로 다른 학습 가능한 모델이 서로 경쟁하면서 학습합니다.&lt;/p&gt;
&lt;p&gt;두 모델의 이름은 각각 &lt;strong&gt;&lt;em&gt;Genarator(생성기) , Discriminator (분류기) &lt;/em&gt;&lt;/strong&gt;입니다 .&lt;/p&gt;
&lt;h3 id=&quot;Discriminator-(&amp;#48516;&amp;#47448;&amp;#44592;)&quot;&gt;Discriminator (&amp;#48516;&amp;#47448;&amp;#44592;)&lt;a class=&quot;anchor-link&quot; href=&quot;#Discriminator-(&amp;#48516;&amp;#47448;&amp;#44592;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;분류기는 단순한 classification 을 수행하는 모델입니다.&lt;/p&gt;
&lt;p&gt;이미지 데이터를 input 으로 받으면 그 이미지가 실제 이미지(real)인지 가짜 이미지(fake) 인지 분류합니다.&lt;/p&gt;
&lt;p&gt;실제 이미지일 확률이 높으면 1에 가까운 수를,&lt;/p&gt;
&lt;p&gt;가짜 이미지일 확률이 높으면 0에 가까운 수를 반환합니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;분류기의 성능(성취도)&lt;/strong&gt;는 실제 이미지를 잘 구분할수록, 즉 실제 이미지에 1에 가까운 수를 부여할수록 좋다고 할 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;분류기는 간단한 binary classification 기능을 할 수 있는 2 layer NN 구조를 사용했습니다.&lt;/p&gt;
&lt;h3 id=&quot;Genarator-(&amp;#49373;&amp;#49457;&amp;#44592;)&quot;&gt;Genarator (&amp;#49373;&amp;#49457;&amp;#44592;)&lt;a class=&quot;anchor-link&quot; href=&quot;#Genarator-(&amp;#49373;&amp;#49457;&amp;#44592;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;생성기는 가짜 이미지를 만들어냅니다.&lt;/p&gt;
&lt;p&gt;noise 데이터 [128] 을 input 으로 받으면, 그 noise 를 바탕으로&lt;/p&gt;
&lt;p&gt;output 으로 만들어낸 이미지 데이터[784] 를 생성합니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;생성기의 성능(성취도)&lt;/strong&gt;는 자신이 만든 가짜 이미지를 분류기에 보여주었을 때 1에 가까운 수를 부여할 수록 좋다고 할 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;생성기 내부를 구현하는 방법에는 다양한 방법이 있을 수 있지만,&lt;/p&gt;
&lt;p&gt;저는 단순히 2 layer NN 의 구조를 사용해보았습니다.&lt;/p&gt;
&lt;h3 id=&quot;placeholder-Z&quot;&gt;placeholder Z&lt;a class=&quot;anchor-link&quot; href=&quot;#placeholder-Z&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Z 는 우리가 random 한 noise 를 넣어줄 placeholder 입니다.&lt;/p&gt;
&lt;p&gt;미세하게 어떤 noise 가 들어갔는지에 따라서 생성기가 만들어내는 가짜이미지가 달라질 것입니다.&lt;/p&gt;
&lt;p&gt;noise 의 크기는 임의로 128로 지정해놓았습니다.&lt;/p&gt;
&lt;h3 id=&quot;placeholder-X&quot;&gt;placeholder X&lt;a class=&quot;anchor-link&quot; href=&quot;#placeholder-X&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;X 는 분류기에게 보여줄 실제 이미지입니다.&lt;/p&gt;
&lt;p&gt;mnist 에서 제공하는 손글씨 숫자데이터 55000개를 이용할 것입니다.&lt;/p&gt;
&lt;p&gt;[55000, 784]&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;02-&amp;#54617;&amp;#49845;-&amp;#48169;&amp;#48277;-(loss-function,-train)&quot;&gt;02 &amp;#54617;&amp;#49845; &amp;#48169;&amp;#48277; (loss function, train)&lt;a class=&quot;anchor-link&quot; href=&quot;#02-&amp;#54617;&amp;#49845;-&amp;#48169;&amp;#48277;-(loss-function,-train)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
그렇다면 두개의 모델(분류기와 생성기)를 어떻게 학습시켜야할까요?&lt;/p&gt;
&lt;p&gt;학습을 위해서는 적절한 loss function 이 필요합니다.&lt;/p&gt;
&lt;p&gt;GAN 에는 loss function 이 손실을 나타낸다기보다 , 각 모델의 성취도 혹은 성능을 나타낸다고 하는 것이 좋을 것 같습니다.&lt;/p&gt;
&lt;p&gt;각 모델의 &lt;strong&gt;loss function(성능) 을 최대화&lt;/strong&gt; 하는 것이 학습의 목표이기 때문입니다.&lt;/p&gt;
&lt;p&gt;위의 모델 설명에서 언급한 내용을 잠시 다시 보겠습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;분류기의 성능(성취도)&lt;/strong&gt;는 실제 이미지를 잘 구분할수록, 즉 실제 이미지에 1에 가까운 수를 부여할수록 좋다고 할 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;생성기의 성능(성취도)&lt;/strong&gt;는 자신이 만든 가짜 이미지를 분류기에 보여주었을 때 1에 가까운 수를 부여할 수록 좋다고 할 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 두 성취도는 위 모델 그림의 fake-result 와 real-result 로 다시 나타낼 수 있습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;분류기의 성능(성취도)&lt;/strong&gt; &lt;code&gt;d_loss&lt;/code&gt;  는 real-result 는 높을수록, fake-result 는 낮을수록 좋습니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;생성기의 성능(성취도)&lt;/strong&gt; &lt;code&gt;g_loss&lt;/code&gt;  는 fake-result 가 높을수록 좋습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 d_loss 와 g_loss 를 각각 학습시켜, 최대화하도록 하면&lt;/p&gt;
&lt;p&gt;생성기의 성능과 분류기의 성능이 서로 경쟁적으로 올라가게 됩니다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;03-&amp;#54617;&amp;#49845;&amp;#51012;-&amp;#47560;&amp;#52828;-&amp;#54980;&amp;#50640;&amp;#45716;-...&quot;&gt;03 &amp;#54617;&amp;#49845;&amp;#51012; &amp;#47560;&amp;#52828; &amp;#54980;&amp;#50640;&amp;#45716; ...&lt;a class=&quot;anchor-link&quot; href=&quot;#03-&amp;#54617;&amp;#49845;&amp;#51012;-&amp;#47560;&amp;#52828;-&amp;#54980;&amp;#50640;&amp;#45716;-...&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;hr/&gt;

&lt;p&gt;생성기에 새로운 noise 를 넣어서 실제 손글씨와 비슷한 이미지를 만들어내는지 확인해볼 것입니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;04-Tensorflow-Code-&amp;#47196;-&amp;#51649;&amp;#51217;-&amp;#51676;&amp;#48372;&amp;#44592;&quot;&gt;04 Tensorflow Code &amp;#47196; &amp;#51649;&amp;#51217; &amp;#51676;&amp;#48372;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#04-Tensorflow-Code-&amp;#47196;-&amp;#51649;&amp;#51217;-&amp;#51676;&amp;#48372;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;hr/&gt;

&lt;p&gt;이제 개념 정리와 어떻게 모델을 구성하고 학습할지에 대한 계획이 끝났으니,&lt;/p&gt;
&lt;p&gt;실제 tensorflow 로 코드를 짜보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;hr/&gt;
(1) Import Packages&lt;/p&gt;
&lt;p&gt;(2) 사용할 데이터 load&lt;/p&gt;
&lt;p&gt;(3) Hyper-Parameters 설정&lt;/p&gt;
&lt;p&gt;(4) 필요한 module 만들기&lt;/p&gt;
&lt;p&gt;(5) Graph 짜기&lt;/p&gt;
&lt;p&gt;(6) Graph Run 해서 반복 training 으로 variable update&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(1)-Import-Packages&quot;&gt;(1) Import Packages&lt;a class=&quot;anchor-link&quot; href=&quot;#(1)-Import-Packages&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(2)-&amp;#49324;&amp;#50857;&amp;#54624;-&amp;#45936;&amp;#51060;&amp;#53552;-load&quot;&gt;(2) &amp;#49324;&amp;#50857;&amp;#54624; &amp;#45936;&amp;#51060;&amp;#53552; load&lt;a class=&quot;anchor-link&quot; href=&quot;#(2)-&amp;#49324;&amp;#50857;&amp;#54624;-&amp;#45936;&amp;#51060;&amp;#53552;-load&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.examples.tutorials.mnist&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_data_sets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;MNIST_data/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Extracting MNIST_data/train-images-idx3-ubyte.gz
Extracting MNIST_data/train-labels-idx1-ubyte.gz
Extracting MNIST_data/t10k-images-idx3-ubyte.gz
Extracting MNIST_data/t10k-labels-idx1-ubyte.gz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(55000, 784) (55000,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(3)-Hyper-Parameters-&amp;#49444;&amp;#51221;&quot;&gt;(3) Hyper-Parameters &amp;#49444;&amp;#51221;&lt;a class=&quot;anchor-link&quot; href=&quot;#(3)-Hyper-Parameters-&amp;#49444;&amp;#51221;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0002&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(4)-&amp;#54596;&amp;#50836;&amp;#54620;-module-&amp;#47564;&amp;#46308;&amp;#44592;&quot;&gt;(4) &amp;#54596;&amp;#50836;&amp;#54620; module &amp;#47564;&amp;#46308;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#(4)-&amp;#54596;&amp;#50836;&amp;#54620;-module-&amp;#47564;&amp;#46308;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;모듈이름&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;기능&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;input&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;output&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;trainable_variables&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;generator&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;2 layer NN 로 구성된 가짜이미지 생성기를 호출합니다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;noise z [-, 128]&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;fake images [-,784]&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Gen/w1, Gen/b1, Gen/w2, Gen/gb2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;discriminator&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;2 layer NN 로 구성된 binary 분류기를 호출합니다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;real/fake images x [-,784]&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;scores [-,1]&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Dis/w1, Dis/b1, Dis/w2, Dis/b2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;random_noise&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;호출할 때마다 random normal한 batch_size 갯수의 noise 를 생성합니다.&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;batch_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;noise [batch_size, 128]&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;&amp;lt;-module1-:-Generator-(-&amp;#49373;&amp;#49457;&amp;#44592;-)-&amp;gt;&quot;&gt;&amp;lt; module1 : Generator ( &amp;#49373;&amp;#49457;&amp;#44592; ) &amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;-module1-:-Generator-(-&amp;#49373;&amp;#49457;&amp;#44592;-)-&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_or_scope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Gen&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;gw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            &lt;span class=&quot;c1&quot;&gt;# quiz : weight 의 초깃값을 random normal 로 주는 이유는 무엇일까요?&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;gb1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            
            &lt;span class=&quot;n&quot;&gt;gw2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            
            &lt;span class=&quot;n&quot;&gt;gb2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_or_scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Gen&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;gw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            
            &lt;span class=&quot;n&quot;&gt;gb1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            
            &lt;span class=&quot;n&quot;&gt;gw2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
            
            &lt;span class=&quot;n&quot;&gt;gb2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
        
        
    &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gw1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gb1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gw2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gb2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;#출력층에 시그모이드를 쓰는 이유는 무엇일까요? &lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;#[784] 가짜 생성된 이미지 &lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;&amp;lt;-module2-:-Discriminator-(-&amp;#48516;&amp;#47448;&amp;#44592;-)-&amp;gt;&quot;&gt;&amp;lt; module2 : Discriminator ( &amp;#48516;&amp;#47448;&amp;#44592; ) &amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;-module2-:-Discriminator-(-&amp;#48516;&amp;#47448;&amp;#44592;-)-&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;discriminator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_or_scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Dis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;db1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dw2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;db2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_or_scope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Dis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reuse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;db1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dw2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;db2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
    &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dw1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#[-, 256]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigmoid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dw2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;#[-, 1]  진품인지(1) 가품인지(0)의 label 결과값&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;&amp;lt;-module3-:--random-noise-&amp;#49373;&amp;#49457;&amp;#44592;-&amp;gt;&quot;&gt;&amp;lt; module3 :  random noise &amp;#49373;&amp;#49457;&amp;#44592; &amp;gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;lt;-module3-:--random-noise-&amp;#49373;&amp;#49457;&amp;#44592;-&amp;gt;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;random_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(5)-Graph-&amp;#51676;&amp;#44592;&quot;&gt;(5) Graph &amp;#51676;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#(5)-Graph-&amp;#51676;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    
    &lt;span class=&quot;c1&quot;&gt;######################################################&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 1 .Feedable part  :: 그래프에서 유일하게 데이터가 유입될 수 있는 장소 &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;######################################################&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#GAN 은 autoencoder 와 마찬가지로 unsupervised learning 이므로 y(label)을 사용하지 않습니다.&lt;/span&gt;
 
    &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Z 는 생성기의 입력값으로 사용될 노이즈 입니다. &lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;################################&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 2. generator 와 discriminator 의 사용 &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;##################################&lt;/span&gt;

    
    &lt;span class=&quot;n&quot;&gt;fake_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;result_of_fake&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;discriminator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fake_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result_of_real&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;discriminator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;################################&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 3. Loss( 성취도평가 ) : g_loss 와 d_loss&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# g_loss &amp;amp; d_loss 모두 높을 수록 좋다.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# g_loss : 얼마나 fake_x 가 진짜같은가&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# d_loss : 얼마나 discriminator 가 정확한가 &lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# 두 수치를 모두 높이도록 train 하면 생성기와 분류기의 성능이 모두 올라간다. &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;################################&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;g_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result_of_fake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;d_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result_of_real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result_of_fake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;################################&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# 4. Train : Maximizing g_loss &amp;amp; d_loss&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;################################&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;t_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# return list &lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;g_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_vars&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Gen&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_vars&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Dis&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;g_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;d_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    
    
    &lt;span class=&quot;c1&quot;&gt;# g_loss &amp;amp; d_loss 를 최대화 시켜야하는데 minimize 함수밖에 없기 때문에 - 음수부호 붙인다.&lt;/span&gt;
    
    
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;(6)-Graph-Run-&amp;#54644;&amp;#49436;-&amp;#48152;&amp;#48373;-training-&amp;#51004;&amp;#47196;-variable-update&quot;&gt;(6) Graph Run &amp;#54644;&amp;#49436; &amp;#48152;&amp;#48373; training &amp;#51004;&amp;#47196; variable update&lt;a class=&quot;anchor-link&quot; href=&quot;#(6)-Graph-Run-&amp;#54644;&amp;#49436;-&amp;#48152;&amp;#48373;-training-&amp;#51004;&amp;#47196;-variable-update&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;total_batchs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_batchs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;batch_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# [batch_size , 784]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;batch_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# [batch_size,]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# [batch_size, 128] &lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_train&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;gl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    
    
        &lt;span class=&quot;c1&quot;&gt;#매 20 epoch 마다 학습된 성능을 중간점검  (실제론 더 자주하시는 것이 좋습니다. )&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;=======Epoch : &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; =======================================&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;생성기 성능 : &amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;분류기 성능 : &amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;생성기와 분류기 선의의 경쟁중...&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
        
        &lt;span class=&quot;c1&quot;&gt;#10개의 epoch 마다 Generator 가 만들어내는 실제 결과물을 얻어보며 , 성능 발전을 시각적으로 확인&lt;/span&gt;
    
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;sample_noise&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;generated&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fake_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_axis_off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;goblin-gan-generated/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.png&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zfill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bbox_inches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;최적화 완료!&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        
    
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;=======Epoch :  1  =======================================
생성기 성능 :  -3.06128
분류기 성능 :  -0.200115
생성기와 분류기 선의의 경쟁중...
=======Epoch :  19  =======================================
생성기 성능 :  -2.32224
분류기 성능 :  -0.4686
생성기와 분류기 선의의 경쟁중...
=======Epoch :  39  =======================================
생성기 성능 :  -1.91436
분류기 성능 :  -0.619524
생성기와 분류기 선의의 경쟁중...
=======Epoch :  59  =======================================
생성기 성능 :  -1.69127
분류기 성능 :  -0.593143
생성기와 분류기 선의의 경쟁중...
=======Epoch :  79  =======================================
생성기 성능 :  -1.62559
분류기 성능 :  -0.574774
생성기와 분류기 선의의 경쟁중...
=======Epoch :  99  =======================================
생성기 성능 :  -1.76843
분류기 성능 :  -0.501177
생성기와 분류기 선의의 경쟁중...
최적화 완료!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;05-&amp;#44208;&amp;#44284;&amp;#47932;-&amp;#48372;&amp;#44592;&quot;&gt;05 &amp;#44208;&amp;#44284;&amp;#47932; &amp;#48372;&amp;#44592;&lt;a class=&quot;anchor-link&quot; href=&quot;#05-&amp;#44208;&amp;#44284;&amp;#47932;-&amp;#48372;&amp;#44592;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;hr/&gt;
위의 코드에서 , 매 10 epoch 마다 generator(생성기) 에 임의의 noise 10개를 주어서 생성되는 10개의 이미지를 저장했습니다.&lt;/p&gt;
&lt;p&gt;이 결과를 보면 , 학습이 진행되면 진행될수록 생성기가 실제 사람 손글씨와 비슷한 이미지 형태를 생성해냄을 볼 수 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;epoch-0&quot;&gt;epoch 0&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-0&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/000.png&quot; alt=&quot;000&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-9&quot;&gt;epoch 9&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-9&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/009.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-19&quot;&gt;epoch 19&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-19&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/019.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-29&quot;&gt;epoch 29&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-29&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/029.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-39&quot;&gt;epoch 39&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-39&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/039.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-49&quot;&gt;epoch 49&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-49&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/049.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-59&quot;&gt;epoch 59&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-59&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/059.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-69&quot;&gt;epoch 69&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-69&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/069.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-79&quot;&gt;epoch 79&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-79&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/079.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-89&quot;&gt;epoch 89&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-89&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/089.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;epoch-99&quot;&gt;epoch 99&lt;a class=&quot;anchor-link&quot; href=&quot;#epoch-99&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/goblin-gan-generated/099.png&quot; alt=&quot;title&quot;&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#47560;&amp;#52824;&amp;#47728;-...&quot;&gt;&amp;#47560;&amp;#52824;&amp;#47728; ...&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#47560;&amp;#52824;&amp;#47728;-...&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;hr/&gt;

&lt;p&gt;간단한 2 layer NN 와 mnist data, 그리고 GAN 구조를 이용해 mnist 손글씨를 흉내내는 모델을 tensorflow 만들어보았습니다.&lt;/p&gt;
&lt;p&gt;코드를 보시다 궁금한 점이나 오류가 있다면&lt;/p&gt;
&lt;p&gt;아래 댓글로 남겨주시면 감사하겠습니다 ^^ .&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="DeepLearning" /><summary type="html">잠깐! pre-requisite knowledge&amp;#182; 아래의 지식들을 알고 계셔야 읽기 편한 글입니다. tensorflow, numpy, matplotlib 사용법 Nueral Network (특히 Binary Classification) epoch, batch 단위 학습 방식 이번 글에서는 GAN (Generative Adversarial Networks) 를 tensorflow code 로 구현하는 방법을 알아보려고 합니다. 간단한 GAN 알고리즘을 통해서, MNIST 숫자 손글씨 데이터와 닮은 가짜 손글씨 데이터를 만들어내는 모델(mnist_GAN)을 만들어 보겠습니다. 결과물을 미리 살짝 엿보자면 아래와 같은 실제 MNIST 데이터를 모델에게 계속 보여주면서 훈련시키면 나중에는 아래처럼 비스무리한 숫자를 스스로 만들어낼 수 있습니다. 이는 실제 제가 얻은 결과입니다. 이번 공부를 하면서 참고한 자료는 아래 링크의 코드입니다. https://github.com/golbin/TensorFlow-Tutorials/blob/master/07%20-%20GAN/01%20-%20GAN.py 그럼 이제 어떻게 mnist 손글씨와 비슷한 이미지를 생성하는 mnist_GAN 모델을 구현하는지 보도록 하겠습니다. 01 mnist_GAN &amp;#51032; &amp;#44396;&amp;#51312;&amp;#50752; &amp;#45936;&amp;#51060;&amp;#53552;&amp;#51032; &amp;#55120;&amp;#47492;&amp;#182; 만들어볼 모델의 구조를 설명드리겠습니다. GAN 은 두개의 서로 다른 학습 가능한 모델이 서로 경쟁하면서 학습합니다. 두 모델의 이름은 각각 Genarator(생성기) , Discriminator (분류기) 입니다 . Discriminator (&amp;#48516;&amp;#47448;&amp;#44592;)&amp;#182;분류기는 단순한 classification 을 수행하는 모델입니다. 이미지 데이터를 input 으로 받으면 그 이미지가 실제 이미지(real)인지 가짜 이미지(fake) 인지 분류합니다. 실제 이미지일 확률이 높으면 1에 가까운 수를, 가짜 이미지일 확률이 높으면 0에 가까운 수를 반환합니다. 분류기의 성능(성취도)는 실제 이미지를 잘 구분할수록, 즉 실제 이미지에 1에 가까운 수를 부여할수록 좋다고 할 수 있습니다. 분류기는 간단한 binary classification 기능을 할 수 있는 2 layer NN 구조를 사용했습니다. Genarator (&amp;#49373;&amp;#49457;&amp;#44592;)&amp;#182;생성기는 가짜 이미지를 만들어냅니다. noise 데이터 [128] 을 input 으로 받으면, 그 noise 를 바탕으로 output 으로 만들어낸 이미지 데이터[784] 를 생성합니다. 생성기의 성능(성취도)는 자신이 만든 가짜 이미지를 분류기에 보여주었을 때 1에 가까운 수를 부여할 수록 좋다고 할 수 있습니다. 생성기 내부를 구현하는 방법에는 다양한 방법이 있을 수 있지만, 저는 단순히 2 layer NN 의 구조를 사용해보았습니다. placeholder Z&amp;#182;Z 는 우리가 random 한 noise 를 넣어줄 placeholder 입니다. 미세하게 어떤 noise 가 들어갔는지에 따라서 생성기가 만들어내는 가짜이미지가 달라질 것입니다. noise 의 크기는 임의로 128로 지정해놓았습니다. placeholder X&amp;#182;X 는 분류기에게 보여줄 실제 이미지입니다. mnist 에서 제공하는 손글씨 숫자데이터 55000개를 이용할 것입니다. [55000, 784] 02 &amp;#54617;&amp;#49845; &amp;#48169;&amp;#48277; (loss function, train)&amp;#182; 그렇다면 두개의 모델(분류기와 생성기)를 어떻게 학습시켜야할까요? 학습을 위해서는 적절한 loss function 이 필요합니다. GAN 에는 loss function 이 손실을 나타낸다기보다 , 각 모델의 성취도 혹은 성능을 나타낸다고 하는 것이 좋을 것 같습니다. 각 모델의 loss function(성능) 을 최대화 하는 것이 학습의 목표이기 때문입니다. 위의 모델 설명에서 언급한 내용을 잠시 다시 보겠습니다. 분류기의 성능(성취도)는 실제 이미지를 잘 구분할수록, 즉 실제 이미지에 1에 가까운 수를 부여할수록 좋다고 할 수 있습니다. 생성기의 성능(성취도)는 자신이 만든 가짜 이미지를 분류기에 보여주었을 때 1에 가까운 수를 부여할 수록 좋다고 할 수 있습니다. 이 두 성취도는 위 모델 그림의 fake-result 와 real-result 로 다시 나타낼 수 있습니다. 분류기의 성능(성취도) d_loss 는 real-result 는 높을수록, fake-result 는 낮을수록 좋습니다. 생성기의 성능(성취도) g_loss 는 fake-result 가 높을수록 좋습니다. 이 d_loss 와 g_loss 를 각각 학습시켜, 최대화하도록 하면 생성기의 성능과 분류기의 성능이 서로 경쟁적으로 올라가게 됩니다. 03 &amp;#54617;&amp;#49845;&amp;#51012; &amp;#47560;&amp;#52828; &amp;#54980;&amp;#50640;&amp;#45716; ...&amp;#182; 생성기에 새로운 noise 를 넣어서 실제 손글씨와 비슷한 이미지를 만들어내는지 확인해볼 것입니다. 04 Tensorflow Code &amp;#47196; &amp;#51649;&amp;#51217; &amp;#51676;&amp;#48372;&amp;#44592;&amp;#182; 이제 개념 정리와 어떻게 모델을 구성하고 학습할지에 대한 계획이 끝났으니, 실제 tensorflow 로 코드를 짜보도록 하겠습니다. (1) Import Packages (2) 사용할 데이터 load (3) Hyper-Parameters 설정 (4) 필요한 module 만들기 (5) Graph 짜기 (6) Graph Run 해서 반복 training 으로 variable update (1) Import Packages&amp;#182; In&amp;nbsp;[1]: import tensorflow as tf import numpy as np import matplotlib.pyplot as plt (2) &amp;#49324;&amp;#50857;&amp;#54624; &amp;#45936;&amp;#51060;&amp;#53552; load&amp;#182; In&amp;nbsp;[2]: from tensorflow.examples.tutorials.mnist import input_data mnist = input_data.read_data_sets(&amp;quot;MNIST_data/&amp;quot;) Extracting MNIST_data/train-images-idx3-ubyte.gz Extracting MNIST_data/train-labels-idx1-ubyte.gz Extracting MNIST_data/t10k-images-idx3-ubyte.gz Extracting MNIST_data/t10k-labels-idx1-ubyte.gz In&amp;nbsp;[3]: train_x = mnist.train.images train_y = mnist.train.labels print(train_x.shape, train_y.shape) (55000, 784) (55000,) (3) Hyper-Parameters &amp;#49444;&amp;#51221;&amp;#182; In&amp;nbsp;[4]: total_epochs = 100 batch_size = 100 learning_rate = 0.0002 (4) &amp;#54596;&amp;#50836;&amp;#54620; module &amp;#47564;&amp;#46308;&amp;#44592;&amp;#182; 모듈이름 기능 input output trainable_variables generator 2 layer NN 로 구성된 가짜이미지 생성기를 호출합니다. noise z [-, 128] fake images [-,784] Gen/w1, Gen/b1, Gen/w2, Gen/gb2 discriminator 2 layer NN 로 구성된 binary 분류기를 호출합니다. real/fake images x [-,784] scores [-,1] Dis/w1, Dis/b1, Dis/w2, Dis/b2 random_noise 호출할 때마다 random normal한 batch_size 갯수의 noise 를 생성합니다. batch_size noise [batch_size, 128] - &amp;lt; module1 : Generator ( &amp;#49373;&amp;#49457;&amp;#44592; ) &amp;gt;&amp;#182; In&amp;nbsp;[5]: def generator( z , reuse = False ) : if reuse==False : with tf.variable_scope(name_or_scope = &amp;quot;Gen&amp;quot;) as scope : gw1 = tf.get_variable(name = &amp;quot;w1&amp;quot;, shape = [128, 256], initializer= tf.random_normal_initializer(mean=0.0, stddev = 0.01)) # quiz : weight 의 초깃값을 random normal 로 주는 이유는 무엇일까요? gb1 = tf.get_variable(name = &amp;quot;b1&amp;quot;, shape = [256], initializer = tf.random_normal_initializer(mean=0.0, stddev = 0.01)) gw2 = tf.get_variable(name = &amp;quot;w2&amp;quot;, shape = [256, 784], initializer= tf.random_normal_initializer(mean=0.0, stddev = 0.01)) gb2 = tf.get_variable(name = &amp;quot;b2&amp;quot;, shape = [784], initializer = tf.random_normal_initializer(mean=0.0, stddev = 0.01)) else : with tf.variable_scope(name_or_scope=&amp;quot;Gen&amp;quot;, reuse = True) as scope : gw1 = tf.get_variable(name = &amp;quot;w1&amp;quot;, shape = [128, 256], initializer= tf.random_normal_initializer(mean=0.0, stddev = 0.01)) gb1 = tf.get_variable(name = &amp;quot;b1&amp;quot;, shape = [256], initializer = tf.random_normal_initializer(mean=0.0, stddev = 0.01)) gw2 = tf.get_variable(name = &amp;quot;w2&amp;quot;, shape = [256, 784], initializer= tf.random_normal_initializer(mean=0.0, stddev = 0.01)) gb2 = tf.get_variable(name = &amp;quot;b2&amp;quot;, shape = [784], initializer = tf.random_normal_initializer(mean=0.0, stddev = 0.01)) hidden = tf.nn.relu( tf.matmul(z , gw1) + gb1 ) output = tf.nn.sigmoid( tf.matmul(hidden, gw2) + gb2 ) #출력층에 시그모이드를 쓰는 이유는 무엇일까요? return output #[784] 가짜 생성된 이미지 &amp;lt; module2 : Discriminator ( &amp;#48516;&amp;#47448;&amp;#44592; ) &amp;gt;&amp;#182; In&amp;nbsp;[6]: def discriminator( x , reuse = False) : if(reuse == False) : with tf.variable_scope(name_or_scope=&amp;quot;Dis&amp;quot;) as scope : dw1 = tf.get_variable(name = &amp;quot;w1&amp;quot;, shape = [784, 256], initializer = tf.random_normal_initializer(0.0, 0.01) ) db1 = tf.get_variable(name = &amp;quot;b1&amp;quot;, shape = [256], initializer = tf.random_normal_initializer(0.0, 0.01) ) dw2 = tf.get_variable(name = &amp;quot;w2&amp;quot;, shape = [256, 1], initializer = tf.random_normal_initializer(0.0, 0.01) ) db2 = tf.get_variable(name = &amp;quot;b2&amp;quot;, shape = [1], initializer = tf.random_normal_initializer(0.0, 0.01) ) else : with tf.variable_scope(name_or_scope=&amp;quot;Dis&amp;quot;, reuse = True) as scope : dw1 = tf.get_variable(name = &amp;quot;w1&amp;quot;, shape = [784, 256], initializer = tf.random_normal_initializer(0.0, 0.01) ) db1 = tf.get_variable(name = &amp;quot;b1&amp;quot;, shape = [256], initializer = tf.random_normal_initializer(0.0, 0.01) ) dw2 = tf.get_variable(name = &amp;quot;w2&amp;quot;, shape = [256, 1], initializer = tf.random_normal_initializer(0.0, 0.01) ) db2 = tf.get_variable(name = &amp;quot;b2&amp;quot;, shape = [1], initializer = tf.random_normal_initializer(0.0, 0.01) ) hidden = tf.nn.relu( tf.matmul(x , dw1) + db1 ) #[-, 256] output = tf.nn.sigmoid( tf.matmul(hidden, dw2) + db2 ) #[-, 1] 진품인지(1) 가품인지(0)의 label 결과값 return output &amp;lt; module3 : random noise &amp;#49373;&amp;#49457;&amp;#44592; &amp;gt;&amp;#182; In&amp;nbsp;[7]: def random_noise(batch_size) : return np.random.normal(size=[batch_size , 128]) (5) Graph &amp;#51676;&amp;#44592;&amp;#182; In&amp;nbsp;[8]: g = tf.Graph() with g.as_default() : ###################################################### # 1 .Feedable part :: 그래프에서 유일하게 데이터가 유입될 수 있는 장소 ###################################################### X = tf.placeholder(tf.float32, [None, 784]) #GAN 은 autoencoder 와 마찬가지로 unsupervised learning 이므로 y(label)을 사용하지 않습니다. Z = tf.placeholder(tf.float32, [None, 128]) #Z 는 생성기의 입력값으로 사용될 노이즈 입니다. ################################ # 2. generator 와 discriminator 의 사용 ################################## fake_x = generator(Z) result_of_fake = discriminator(fake_x) result_of_real = discriminator(X , True) ################################ # 3. Loss( 성취도평가 ) : g_loss 와 d_loss # g_loss &amp;amp; d_loss 모두 높을 수록 좋다. # g_loss : 얼마나 fake_x 가 진짜같은가 # d_loss : 얼마나 discriminator 가 정확한가 # 두 수치를 모두 높이도록 train 하면 생성기와 분류기의 성능이 모두 올라간다. ################################ g_loss = tf.reduce_mean( tf.log(result_of_fake) ) d_loss = tf.reduce_mean( tf.log(result_of_real) + tf.log(1 - result_of_fake) ) ################################ # 4. Train : Maximizing g_loss &amp;amp; d_loss ################################ t_vars = tf.trainable_variables() # return list g_vars = [var for var in t_vars if &amp;quot;Gen&amp;quot; in var.name] d_vars = [var for var in t_vars if &amp;quot;Dis&amp;quot; in var.name] optimizer = tf.train.AdamOptimizer(learning_rate) g_train = optimizer.minimize(-g_loss, var_list= g_vars) d_train = optimizer.minimize(-d_loss, var_list = d_vars) # g_loss &amp;amp; d_loss 를 최대화 시켜야하는데 minimize 함수밖에 없기 때문에 - 음수부호 붙인다. (6) Graph Run &amp;#54644;&amp;#49436; &amp;#48152;&amp;#48373; training &amp;#51004;&amp;#47196; variable update&amp;#182; In&amp;nbsp;[9]: with tf.Session(graph = g) as sess : sess.run(tf.global_variables_initializer()) total_batchs = int(train_x.shape[0] / batch_size) for epoch in range(total_epochs) : for batch in range(total_batchs) : batch_x = train_x[batch * batch_size : (batch+1) * batch_size] # [batch_size , 784] batch_y = train_y[batch * batch_size : (batch+1) * batch_size] # [batch_size,] noise = random_noise(batch_size) # [batch_size, 128] sess.run(g_train , feed_dict = {Z : noise}) sess.run(d_train, feed_dict = {X : batch_x , Z : noise}) gl, dl = sess.run([g_loss, d_loss], feed_dict = {X : batch_x , Z : noise}) #매 20 epoch 마다 학습된 성능을 중간점검 (실제론 더 자주하시는 것이 좋습니다. ) if (epoch+1) % 20 == 0 or epoch == 1 : print(&amp;quot;=======Epoch : &amp;quot;, epoch , &amp;quot; =======================================&amp;quot;) print(&amp;quot;생성기 성능 : &amp;quot; ,gl ) print(&amp;quot;분류기 성능 : &amp;quot; ,dl ) print(&amp;quot;생성기와 분류기 선의의 경쟁중...&amp;quot;) #10개의 epoch 마다 Generator 가 만들어내는 실제 결과물을 얻어보며 , 성능 발전을 시각적으로 확인 if epoch == 0 or (epoch + 1) % 10 == 0 : sample_noise = random_noise(10) generated = sess.run(fake_x , feed_dict = { Z : sample_noise}) fig, ax = plt.subplots(1, 10, figsize=(10, 1)) for i in range(10) : ax[i].set_axis_off() ax[i].imshow( np.reshape( generated[i], (28, 28)) ) plt.savefig(&amp;#39;goblin-gan-generated/{}.png&amp;#39;.format(str(epoch).zfill(3)), bbox_inches=&amp;#39;tight&amp;#39;) plt.close(fig) print(&amp;#39;최적화 완료!&amp;#39;) =======Epoch : 1 ======================================= 생성기 성능 : -3.06128 분류기 성능 : -0.200115 생성기와 분류기 선의의 경쟁중... =======Epoch : 19 ======================================= 생성기 성능 : -2.32224 분류기 성능 : -0.4686 생성기와 분류기 선의의 경쟁중... =======Epoch : 39 ======================================= 생성기 성능 : -1.91436 분류기 성능 : -0.619524 생성기와 분류기 선의의 경쟁중... =======Epoch : 59 ======================================= 생성기 성능 : -1.69127 분류기 성능 : -0.593143 생성기와 분류기 선의의 경쟁중... =======Epoch : 79 ======================================= 생성기 성능 : -1.62559 분류기 성능 : -0.574774 생성기와 분류기 선의의 경쟁중... =======Epoch : 99 ======================================= 생성기 성능 : -1.76843 분류기 성능 : -0.501177 생성기와 분류기 선의의 경쟁중... 최적화 완료! 05 &amp;#44208;&amp;#44284;&amp;#47932; &amp;#48372;&amp;#44592;&amp;#182; 위의 코드에서 , 매 10 epoch 마다 generator(생성기) 에 임의의 noise 10개를 주어서 생성되는 10개의 이미지를 저장했습니다. 이 결과를 보면 , 학습이 진행되면 진행될수록 생성기가 실제 사람 손글씨와 비슷한 이미지 형태를 생성해냄을 볼 수 있습니다. epoch 0&amp;#182; epoch 9&amp;#182; epoch 19&amp;#182; epoch 29&amp;#182; epoch 39&amp;#182; epoch 49&amp;#182; epoch 59&amp;#182; epoch 69&amp;#182; epoch 79&amp;#182; epoch 89&amp;#182; epoch 99&amp;#182; &amp;#47560;&amp;#52824;&amp;#47728; ...&amp;#182; 간단한 2 layer NN 와 mnist data, 그리고 GAN 구조를 이용해 mnist 손글씨를 흉내내는 모델을 tensorflow 만들어보았습니다. 코드를 보시다 궁금한 점이나 오류가 있다면 아래 댓글로 남겨주시면 감사하겠습니다 ^^ .</summary></entry><entry><title type="html">Scala 의 Type Class 코드로 살펴보기 2</title><link href="https://shinjayne.github.io//scala/2017/06/29/scala-type-class-2.html" rel="alternate" type="text/html" title="Scala 의 Type Class 코드로 살펴보기 2" /><published>2017-06-29T00:46:40+09:00</published><updated>2017-06-29T00:46:40+09:00</updated><id>https://shinjayne.github.io//scala/2017/06/29/scala-type-class-2</id><content type="html" xml:base="https://shinjayne.github.io//scala/2017/06/29/scala-type-class-2.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;1.-Turning-Type-Classes-into-OO-Classes&quot;&gt;1. Turning Type Classes into OO Classes&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Turning-Type-Classes-into-OO-Classes&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[1]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iter&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ListIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headOption&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[2]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;ListIter&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElement&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[5]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;printElements&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3
4
5
1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[6]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;I&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;List&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;List&lt;/span&gt;(&lt;span class=&quot;ansi-green-fg&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;1&lt;/span&gt;)
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res5_1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;13&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.language.higherKinds&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.language.implicitConversions&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;,&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// 실제 동작 함수. ii 에 incIter 동작 인스턴스가 들어가고&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;,&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dd&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; 
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;,&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;d.Data&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;cm&quot;&gt;/*********************************************************************&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;&amp;lt;&amp;lt;  Dyn2 인스턴스 는 &amp;lt;타입클래스 정보 S &amp;gt; &amp;lt;반환할 데이터 타입 A&amp;gt; 로 초기화하고  &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &amp;lt;타입 클래스가 다룰 데이터 구조 D&amp;gt;를 입력받는다.    &amp;gt;&amp;gt;&amp;gt;   &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    val  x : Dyn2[S,A](D)  &amp;gt;&amp;gt;&amp;gt;  x.d = 데이터구조 (주인공)  &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;                                    x.i = 타입클래스 인스턴스 정보( 실행기 ) &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &amp;lt;Dyn2 인스턴스 x&amp;gt; 를 만들면 무엇을 할 수 있는가? &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    x : Dyn2[Iter, Int]  =  Dyn2(List(1,2,3))   &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    y : Dyn2[Iter, Int]  = Dyn2(MyNode(1, Empty(), Empty()))   &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    각각의 x, y 에 안에 들어있는 데이터구조와 타입클래스 인스턴스 정보로, Iter 타입클래스로 구현된 메서드를 모두 사용 가능하다. &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    Iter type class 의  interface method 들 &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    sumElements(x.d)(x.i)&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    printElements(y.d)(y.i)&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; &lt;/span&gt;



&lt;span class=&quot;cm&quot;&gt;***********************************************************************/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[7]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.higherKinds
&lt;/span&gt;
&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.implicitConversions

&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Dyn2&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Dyn2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// type class 인스턴스  .... Int 데이터구조 들어왔을때  동작을 기술함 ... 하지만 직접 넣어줄 것이기 때문에 implicit 적지 않았다.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;incIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Dyn2 인스턴스를 생성해내는 방법 &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// getMyIter&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMyIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isInc&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Dyn2[Iter, Int] 로 초기화한다. &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isInc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;incIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Dyn2.apply(0)(incIter(10))   // Dyn2(0) Int라는 데이터구조 를 다룬다. &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Dyn2.apply(List(3,1,5))(listIter[Int])   // Dyn2(List[Int])   List[Int] 라는 데이터구조를 다룬다. &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[15]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;incIter&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;getMyIter&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i1&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMyIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//printElements(0)(incIter(10))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMyIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//printElements()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0
1
2
3
4
5
6
7
8
9
10
3
1
5
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[16]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;i1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Dyn2&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@74086131
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;i2&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Dyn2&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@67d4c1f6&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tt&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dyn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dd&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tt&lt;/span&gt; 
        
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[18]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Dyn&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Dyn&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 데이터 구조 정보 &lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[20]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;MyTree&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Empty&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Node&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;type-class-&amp;#48376;&amp;#52404;&quot;&gt;type class &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#type-class-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 데이터 구조 R 를 다루는 type class 본체  &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// iter 메서드는 Dyn2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt; , &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 데이터구조 R 을 넣으면 R 을 다루는 Dyn2[Iter, A](R) 를 돌려줄 것이다. &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[19]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iterable&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;type-class-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;type class &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#type-class-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[21]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;treeIterable&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dyn2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Nil&lt;/span&gt; 
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; 
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;go&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// List[Int]   --&amp;gt; Dyn2[Iter, Int](List[Int]) --&amp;gt; Dyn2[Iter,Int](List[Int])(listIter(List[Int], Int))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[21]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;treeIterable&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;type-class-&amp;#51064;&amp;#53552;&amp;#54168;&amp;#51060;&amp;#49828;-(&amp;#49324;&amp;#50857;)&quot;&gt;type class &amp;#51064;&amp;#53552;&amp;#54168;&amp;#51060;&amp;#49828; (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#type-class-&amp;#51064;&amp;#53552;&amp;#54168;&amp;#51060;&amp;#49828;-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Dyn2[Iter, Int](Iter 로 다룰수 있게 변형된 xs)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[22]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sumElements2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[23]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;t&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;MyTree&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = Node(1,Empty(),Empty())
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res22_1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;1&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;</content><author><name></name></author><summary type="html">1. Turning Type Classes into OO Classes&amp;#182; In&amp;nbsp;[1]: abstract class Iter[I,A]{ def getValue(i : I) : Option[A] def getNext(i : I) : I } Out[1]: defined class Iter In&amp;nbsp;[2]: implicit def ListIter[A] : Iter[List[A], A] = new Iter[List[A], A]{ def getValue(i : List[A]) : Option[A] = i.headOption def getNext( i : List[A]) : List[A] = i.tail } Out[2]: defined function ListIter In&amp;nbsp;[5]: def sumElements[I](xs : I)(implicit proxy : Iter[I, Int]) : Int = proxy.getValue(xs) match{ case None =&amp;gt; 0 case Some(n) =&amp;gt; n + sumElement(proxy.getNext(xs)) } def printElements[I, X](xs : I)(implicit proxy : Iter[I, X]) : Unit = proxy.getValue(xs) match{ case None =&amp;gt; case Some(n) =&amp;gt; {println(n) ; printElements(proxy.getNext(xs)) ; } } Out[5]: defined function sumElements defined function printElements In&amp;nbsp;[6]: val I = List(3, 4, 5, 1) sumElements(I) printElements(I) 3 4 5 1 Out[6]: I: List[Int] = List(3, 4, 5, 1) res5_1: Int = 13 In&amp;nbsp;[7]: import scala.language.higherKinds import scala.language.implicitConversions abstract class Dyn2[S[_,_], A]{ type Data val d: Data val i : S[Data, A] } object Dyn2 { // 실제 동작 함수. ii 에 incIter 동작 인스턴스가 들어가고 implicit def apply[S[_,_],D,A](dd : D)(implicit ii : S[D,A]) : Dyn2[S,A] = new Dyn2[S,A]{ type Data = D val d : Data = dd val i : S[Data, A] = ii } implicit def methods[S[_,_], A](d : Dyn2[S,A]) : S[d.Data, A] = d.i } /********************************************************************* &amp;lt;&amp;lt; Dyn2 인스턴스 는 &amp;lt;타입클래스 정보 S &amp;gt; &amp;lt;반환할 데이터 타입 A&amp;gt; 로 초기화하고 &amp;lt;타입 클래스가 다룰 데이터 구조 D&amp;gt;를 입력받는다. &amp;gt;&amp;gt;&amp;gt; val x : Dyn2[S,A](D) &amp;gt;&amp;gt;&amp;gt; x.d = 데이터구조 (주인공) x.i = 타입클래스 인스턴스 정보( 실행기 ) &amp;lt;Dyn2 인스턴스 x&amp;gt; 를 만들면 무엇을 할 수 있는가? x : Dyn2[Iter, Int] = Dyn2(List(1,2,3)) y : Dyn2[Iter, Int] = Dyn2(MyNode(1, Empty(), Empty())) 각각의 x, y 에 안에 들어있는 데이터구조와 타입클래스 인스턴스 정보로, Iter 타입클래스로 구현된 메서드를 모두 사용 가능하다. Iter type class 의 interface method 들 sumElements(x.d)(x.i) printElements(y.d)(y.i) ***********************************************************************/ Out[7]: import scala.language.higherKinds import scala.language.implicitConversions defined class Dyn2 defined object Dyn2 In&amp;nbsp;[15]: // type class 인스턴스 .... Int 데이터구조 들어왔을때 동작을 기술함 ... 하지만 직접 넣어줄 것이기 때문에 implicit 적지 않았다. def incIter(max : Int) : Iter[Int, Int] = new Iter[Int, Int] { def getValue(i : Int) = if (i &amp;lt;= max) Some(i) else None def getNext(i : Int) = i + 1 } // Dyn2 인스턴스를 생성해내는 방법 // getMyIter def getMyIter(isInc: Boolean) : Dyn2[Iter, Int] = { //Dyn2[Iter, Int] 로 초기화한다. if (isInc) Dyn2(0)(incIter(10)) //Dyn2.apply(0)(incIter(10)) // Dyn2(0) Int라는 데이터구조 를 다룬다. else List(3, 1, 5) // Dyn2.apply(List(3,1,5))(listIter[Int]) // Dyn2(List[Int]) List[Int] 라는 데이터구조를 다룬다. } Out[15]: defined function incIter defined function getMyIter In&amp;nbsp;[16]: val i1 : Dyn2[Iter, Int] = getMyIter(true) printElements(i1.d)(i1.i) //printElements(0)(incIter(10)) val i2 : Dyn2[Iter, Int] = getMyIter(false) printElements(i2.d)(i2.i) //printElements() 0 1 2 3 4 5 6 7 8 9 10 3 1 5 Out[16]: i1: Dyn2[Iter, Int] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@74086131 i2: Dyn2[Iter, Int] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@67d4c1f6 In&amp;nbsp;[18]: abstract class Dyn[T[_]]{ type Data val d : Data val proxy : T[Data] } object Dyn{ implicit def apply[D, T[_]](dd : D)(implicit tt : T[D]) : Dyn[T] = new Dyn[T] { type Data = D val d : Data = dd val proxy : T[D] = tt } } Out[18]: defined class Dyn defined object Dyn In&amp;nbsp;[20]: // 데이터 구조 정보 sealed abstract class MyTree[A] case class Empty[A]() extends MyTree[A] case class Node[A](value : A, left : MyTree[A], right : MyTree[A]) extends MyTree[A] Out[20]: defined class MyTree defined class Empty defined class Node type class &amp;#48376;&amp;#52404;&amp;#182; In&amp;nbsp;[19]: // 데이터 구조 R 를 다루는 type class 본체 // iter 메서드는 Dyn2 abstract class Iterable[R,A]{ def iter(a: R) : Dyn2[Iter , A] // 데이터구조 R 을 넣으면 R 을 다루는 Dyn2[Iter, A](R) 를 돌려줄 것이다. } Out[19]: defined class Iterable type class &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182; In&amp;nbsp;[21]: implicit def treeIterable : Iterable[MyTree[Int], Int] = new Iterable[MyTree[Int], Int]{ def iter(a : MyTree[Int]) : Dyn2[Iter, Int] = { def go(I : MyTree[Int]) : List[Int] = I match{ case Empty() =&amp;gt; Nil case Node(v, left, right) =&amp;gt; v :: (go(left) ++ go(right)) } go(a) // List[Int] --&amp;gt; Dyn2[Iter, Int](List[Int]) --&amp;gt; Dyn2[Iter,Int](List[Int])(listIter(List[Int], Int)) } } Out[21]: defined function treeIterable type class &amp;#51064;&amp;#53552;&amp;#54168;&amp;#51060;&amp;#49828; (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[22]: def sumElements2[R](xs : R)(implicit proxy : Iterable[R, Int]) = { val cs = proxy.iter(xs) // Dyn2[Iter, Int](Iter 로 다룰수 있게 변형된 xs) sumElements(cs.d)(cs.i) } Out[22]: defined function sumElements2 In&amp;nbsp;[23]: val t : MyTree[Int] = Node(1, Empty(), Empty()) sumElements2(t) Out[23]: t: MyTree[Int] = Node(1,Empty(),Empty()) res22_1: Int = 1 In&amp;nbsp;[&amp;nbsp;]:</summary></entry><entry><title type="html">Scala 의 Type Class 코드로 살펴보기 1</title><link href="https://shinjayne.github.io//scala/2017/06/29/scala-type-class-1.html" rel="alternate" type="text/html" title="Scala 의 Type Class 코드로 살펴보기 1" /><published>2017-06-29T00:45:40+09:00</published><updated>2017-06-29T00:45:40+09:00</updated><id>https://shinjayne.github.io//scala/2017/06/29/scala-type-class-1</id><content type="html" xml:base="https://shinjayne.github.io//scala/2017/06/29/scala-type-class-1.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;이번 글에서는 &lt;strong&gt;scala 의 Type class&lt;/strong&gt; 에 대해서 코드와 함께 알아보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Type class&lt;/strong&gt; 를 이용하면&lt;/p&gt;
&lt;p&gt;기존의 object oriented programming 에서 사용하던&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;상속이나 객체, 클래스의 개념 없이도&lt;/strong&gt; 다양한 기능을 구현할 수 있습니다.&lt;/p&gt;
&lt;p&gt;(개인적인 소감으로는, Object Oriented Programming 의 소중함을 느끼게 해주는 공부였습니다...)&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;1.-Type-Class-&amp;#51032;-&amp;#44396;&amp;#49457;&quot;&gt;1. Type Class &amp;#51032; &amp;#44396;&amp;#49457;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Type-Class-&amp;#51032;-&amp;#44396;&amp;#49457;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;type class 본체&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;type class 의 instance (customizing)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;type class 의 interface (함수 사용)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Type class 는 크게 위와같은  3가지 구성으로 이루어져 있습니다 .&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;&lt;strong&gt;Type class 본체&lt;/strong&gt;는 &lt;code&gt;abstract class&lt;/code&gt; 또는 &lt;code&gt;trait&lt;/code&gt;로 만듭니다.&lt;/p&gt;
&lt;p&gt;자세한 메서드의 구현은 생략하고, 공통된 동작만 기술되어 있습니다.&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;&lt;strong&gt;Type class 의 instance&lt;/strong&gt; 는 Type class 의 본체에 특정 Type 을 대입하여 구체화시켰다고 생각할 수 있습니다.&lt;/p&gt;
&lt;p&gt;Type class 의 인터페이스(interface) 에 특정 Type 이 들어왔을 때 어떤 동작을 할 것인지 구체적으로 Type Class 의 인스턴스로 표현 할 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;implicit def&lt;/code&gt;, 또는 &lt;code&gt;implicit val&lt;/code&gt; 로 많이 표현합니다. 자세한 예는 아래서 다루도록 하겠습니다.&lt;/p&gt;
&lt;hr/&gt;

&lt;p&gt;&lt;strong&gt;Type Class 의 interface&lt;/strong&gt;는 두 가지 파라메터(인자)를 받습니다.&lt;/p&gt;
&lt;p&gt;하나는 실제 함수에서 다룰 데이터이고, 하나는 데이터를 처리하는 동작이 기술되어있는 Type class 의 instance 입니다.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;2.-Type-Class-&amp;#44060;&amp;#50836;&quot;&gt;2. Type Class &amp;#44060;&amp;#50836;&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Type-Class-&amp;#44060;&amp;#50836;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;기본적으로 type class 는 type 을 parameter로 받는 class 입니다.&lt;/p&gt;
&lt;p&gt;이제 이 아래부터는 실제 스칼라 코드를 통해서 여러가지 Type Class 와 그의 인스턴스, 인터페이스들을 구현해보도록 하겠습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;3.-&amp;#54616;&amp;#45208;&amp;#51032;-type-parameter-&amp;#47484;-&amp;#48155;&amp;#45716;-Type-class&quot;&gt;3. &amp;#54616;&amp;#45208;&amp;#51032; type parameter &amp;#47484; &amp;#48155;&amp;#45716; Type class&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-&amp;#54616;&amp;#45208;&amp;#51032;-type-parameter-&amp;#47484;-&amp;#48155;&amp;#45716;-Type-class&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#51032;-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#51032; &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#51032;-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr/&gt;
Ord[A] 는 type A 의 무언가를 크기비교하는 기능을 가진 type class 입니다.&lt;/p&gt;
&lt;p&gt;Type Class 는 간단히 &lt;code&gt;abstract class&lt;/code&gt; 또는 &lt;code&gt;traits&lt;/code&gt;를 통해 구현합니다.&lt;/p&gt;
&lt;p&gt;메서드는 정의하지만 정확한 동작은 인스턴스에서 구현합니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// instnace 에서 구현될 것입니다. &lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;//A의 type 과 관계 없는 공통된 메서드들은 미리 작성해놓기도 합니다.   &lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[1]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Ord&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr/&gt;
Ord[A] 의 type parameter A 에 다양한 type 을 집어넣음으로써 각각의 instance 를 구현합니다.&lt;/p&gt;
&lt;p&gt;type parameter 의 instance 는 
&lt;code&gt;implicit val&lt;/code&gt; 또는 &lt;code&gt;implicit def&lt;/code&gt; 를 통해 구현합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(&lt;code&gt;implicit def&lt;/code&gt;는 보통 생성할 instance에 parameter type 을 한번 더 주고 싶을 때 사용합니다. )&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;잘 감이 안오신다면, 밑에 코드에서 한번 더 언급될 것입니다. 그때 다시 설명하겠습니다.&lt;/p&gt;
&lt;h4 id=&quot;1.-Ord[Int]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;1. Ord[Int] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Ord[Int]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Int 라는 타입을 다룰 수 있는 Type class 의 인스턴스입니다.&lt;/p&gt;
&lt;p&gt;이 인스턴스를 인자로 받는 interface는 Int 타입의 데이터를 조작할 수 있습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[0]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// A = Int&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intOrd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;cmd0.sc:1: not found: type Ord
implicit val intOrd : Ord[Int] = new Ord[Int]{  //Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화
                      ^cmd0.sc:1: not found: type Ord
implicit val intOrd : Ord[Int] = new Ord[Int]{  //Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화
                                     ^&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_text output_error&quot;&gt;
&lt;pre&gt;
Compilation Failed&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;2.-Ord[Double]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;2. Ord[Double] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Ord[Double]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;마찬가지고 Double 이라는 타입을 다룰 수 있는 Type class 의 인스턴스입니다.&lt;/p&gt;
&lt;p&gt;이 인스턴스를 인자로 받는 interface는 Double 타입의 데이터를 조작할 수 있습니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// A = Double&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doubleOrd&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toInt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[3]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;doubleOrd&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Ord&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Double&lt;/span&gt;] = $sess.cmd2Wrapper$Helper$$anon$1@3368bc6f&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;3.-Ord[-(X,Y)-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;3. Ord[ (X,Y) ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Ord[-(X,Y)-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;여기에선 특별하게 implicit instance 안에 인자로 다시한번 implicit parameter를 받았습니다.&lt;/p&gt;
&lt;p&gt;(X,Y) 형식의 type 을 다룰 수 있도록 해주는 Type class 의 인스턴스이고,&lt;/p&gt;
&lt;p&gt;이 인스턴스를 받는 interface는 모두 (X,Y) 형식의 type 의 데이터를 다룰 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;type class interface + instance&lt;/strong&gt; 의 혼종이라고 생각하면 좋겠습니다.
(아래 interface 부분을 보시고 다시 보시는게 이해에 도움 됩니다. 조금 어렵습니다.)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// A = (X,Y)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;twoOrd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ordX&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ordY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ordX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ordY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;me&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[4]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;twoOrd&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;part3-:-type-class-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;

&lt;p&gt;type class Ord[X] 의 interface 에는 두개의 입구가 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;type X 인 데이터 parameter 들을 받는 입구 &lt;/li&gt;
&lt;li&gt;Ord[X] 의 instance 를 implicit parameter 로 받는 입구 &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;1번 입구에서 받은 data 들을 , 2번 입구에서 받은 type class instance 의 규칙을 이용해 처리합니다. &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;여기서 implicit parameter 의 입구는, scala 의 컴파일러에 의해 자동으로 코드 내의 implicit val / implicit def 로 구현된 Cls[X] 의 instance 를 찾아 연결합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt; 즉, 1번 입구는 넣어주어야하지만, 2번 입구는 인스턴스들만 만들어 놓았다면 자동으로 채워집니다. &lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ord&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&amp;lt;=(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&amp;lt;=(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&amp;lt;=(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[5]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;max3&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// ord = intOrd 인스턴스 자동 사용됨&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ord = doubleOrd 인스턴스 자동 사용됨&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[6]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res5_0&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res5_1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Double&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;3.3&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;4.-&amp;#46160;&amp;#44060;-&amp;#51032;-type-parameter-&amp;#47484;-&amp;#48155;&amp;#45716;-Type-class&quot;&gt;4. &amp;#46160;&amp;#44060; &amp;#51032; type parameter &amp;#47484; &amp;#48155;&amp;#45716; Type class&lt;a class=&quot;anchor-link&quot; href=&quot;#4.-&amp;#46160;&amp;#44060;-&amp;#51032;-type-parameter-&amp;#47484;-&amp;#48155;&amp;#45716;-Type-class&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;같은 방식으로, 이번엔 두개의 type parameter 를 받는 type class 를 보겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#51032;-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#51032; &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#51032;-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr/&gt;
Iter[I,A] 는 type A 를 저장하고있는 type I 에서 , A를 조회하거나 다음 I 로 넘어가는 기능을 구현합니다.&lt;/p&gt;
&lt;p&gt;예를 들자면,&lt;/p&gt;
&lt;p&gt;A 가 Int 이면 I 는 이를 저장하는 List[Int]가 될 것이고&lt;/p&gt;
&lt;p&gt;A 가 String 이면 I는 이를 저장하는 List[String] 이 될 것입니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;    
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//메서드의 디테일은 인스턴스에서 구현합니다.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[7]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iter&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr/&gt;
Iter[I, A] 의 parameter I, A 에 다양한 type 을 집어넣음으로써 각각의 instance 를 구현합니다.&lt;/p&gt;
&lt;p&gt;다시한번..&lt;br/&gt;
&lt;strong&gt;(&lt;code&gt;implicit def&lt;/code&gt;는 보통 생성할 instance에 parameter type 을 한번 더 주고 싶을 때 사용합니다. )&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h4 id=&quot;1.-Iter[Int,-Int]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;1. Iter[Int, Int] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Iter[Int,-Int]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// I = Int, A = Int &lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Int 라는 저장 구조(I) 안에서 Int 데이터(A)를 조회할 수 있습니다. &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intIter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;  
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[8]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;intIter&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Iter&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = $sess.cmd7Wrapper$Helper$$anon$1@5a79ff31&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h4 id=&quot;2.-Iter[-List[X],--X-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;2. Iter[ List[X],  X ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Iter[-List[X],--X-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;이 인스턴스의 독특한 점은, 인스턴스의 완성을 interface 로  떠넘겼다는 것입니다.&lt;/p&gt;
&lt;p&gt;X는 결국 이 인스턴스가 사용되는 interface 에서 결정됩니다.&lt;/p&gt;
&lt;p&gt;즉 interface에서 X를 Int 로 주면 Iter[List[Int], Int] 가 되고&lt;/p&gt;
&lt;p&gt;다른 값으로 주면 달라집니다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// I = List[X], A = X &lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//List 라는 저장구조 (I) 안에서 X 타입의 데이터(A) 를 조회할 수 있습니다.  &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listIter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headOption&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[9]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;listIter&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part3-:-type-class-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// listIter 의 X를 인스턴스 파라메터에서 Int로 고정해놓았습니다.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;// listIter 의 X는 xs(I) 의 타입에 따라 결정됩니다. I 가 List[Int] 이면, A 도 Int 가 됩니다. &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[10]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;printElements&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]](&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3
4
5
6
10
9
8
7
6
5
4
3
2
1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;5.-&amp;#51328;-&amp;#45908;-&amp;#48373;&amp;#51105;&amp;#54620;-&amp;#47928;&amp;#51228;&amp;#46308;&quot;&gt;5. &amp;#51328; &amp;#45908; &amp;#48373;&amp;#51105;&amp;#54620; &amp;#47928;&amp;#51228;&amp;#46308;&lt;a class=&quot;anchor-link&quot; href=&quot;#5.-&amp;#51328;-&amp;#45908;-&amp;#48373;&amp;#51105;&amp;#54620;-&amp;#47928;&amp;#51228;&amp;#46308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#51116;&amp;#47308;&quot;&gt;&amp;#51116;&amp;#47308;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#51116;&amp;#47308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//재료&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[12]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;MyTree&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Empty&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Node&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;hr/&gt;
순환적이지 않은 type R 의 무언가를 순환적으로 만들어준다.&lt;/p&gt;
&lt;p&gt;iter()는 순환적이지 않은 type R 의 무언가를 순환적인 I 로 바꾸고, I는 A들을 포함한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt; ,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[13]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iterable&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h4 id=&quot;Iterable[-MyTree[X]-,-List[X],--X-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;------------(&amp;lt;--X-&amp;#50976;&amp;#46041;&amp;#51201;-)&quot;&gt;Iterable[ MyTree[X] , List[X],  X ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;            (&amp;lt;- X &amp;#50976;&amp;#46041;&amp;#51201; )&lt;a class=&quot;anchor-link&quot; href=&quot;#Iterable[-MyTree[X]-,-List[X],--X-]-&amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;------------(&amp;lt;--X-&amp;#50976;&amp;#46041;&amp;#51201;-)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;treeIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;  &lt;span class=&quot;nc&quot;&gt;Nil&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[14]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;treeIterable&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt; ,&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[15]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements2&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;printElements2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sumElements2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[16]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;tree&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;MyTree&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = Node(10,Node(9,Empty(),Empty()),Node(8,Empty(),Empty()))
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res15_1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;27&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;6.-Higher-kind-Type-classes&quot;&gt;6. Higher-kind Type classes&lt;a class=&quot;anchor-link&quot; href=&quot;#6.-Higher-kind-Type-classes&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Higher-kind 는 type 들을 다시 상위의 하나의 개념으로 묶는, 상위 카테고리라고 할 수 있고, 변역은 &quot;상류&quot; 로 한다.&lt;/p&gt;
&lt;p&gt;아래 링크를 참고하면 좋다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;twitter 의 scalaschool : scala의 상류 타입&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.github.io/scala_school/ko/advanced-types.html#higher&quot;&gt;https://twitter.github.io/scala_school/ko/advanced-types.html#higher&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;&amp;#51116;&amp;#47308;&quot;&gt;&amp;#51116;&amp;#47308;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#51116;&amp;#47308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.language.higherKinds&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[23]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.higherKinds&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;higher kind 를 사용하려면 scala 에서 위처럼 higerKinds 패키지를 import 해줘야한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[18]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iter2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;&lt;code&gt;Iter2[I[_]]&lt;/code&gt; 를 일종의 익명함수 처럼 생각하고 , 빈칸안에 들어올 인자타입은 나중에 받는 것으로 보류하고 나머지를 구현한다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listIter2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headOption&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[19]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;listIter2&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Iter2&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;List&lt;/span&gt;] = $sess.cmd18Wrapper$Helper$$anon$1@1188d429&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// Int 를 담는 higerkind I 에 대해서만 동작한다.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// higerkind I 에 담긴 type X에 구애를 받지 않는다. &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[20]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements3&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;printElements3&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lst&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sumElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// 과정1.    lst 가 들어가면서 I = List 타입인자 전달 ; &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// 과정2.    itr2 : Iter2[List] = listIter2   자동으로 채워짐 (implicit 끼리의 연동)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;printElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;4
5
10
8
9
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[22]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;lst&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;List&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;List&lt;/span&gt;(&lt;span class=&quot;ansi-green-fg&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;ansi-green-fg&quot;&gt;9&lt;/span&gt;)
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res21_1&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;36&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;7.-Higher-kind-Type-classes-+-&amp;#51328;-&amp;#45908;-&amp;#50612;&amp;#47140;&amp;#50868;-&amp;#47928;&amp;#51228;&amp;#46308;&quot;&gt;7. Higher-kind Type classes + &amp;#51328; &amp;#45908; &amp;#50612;&amp;#47140;&amp;#50868; &amp;#47928;&amp;#51228;&amp;#46308;&lt;a class=&quot;anchor-link&quot; href=&quot;#7.-Higher-kind-Type-classes-+-&amp;#51328;-&amp;#45908;-&amp;#50612;&amp;#47140;&amp;#50868;-&amp;#47928;&amp;#51228;&amp;#46308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
순환가능하지 않은 타입 R 을 순환 가능한 타입 I 으로 바꿔주는 동작과 (&lt;code&gt;def iter : I&lt;/code&gt;),&lt;/p&gt;
&lt;p&gt;그 순환가능한 타입 I에 대한 순환동작(&lt;code&gt;type class Iter2[I]&lt;/code&gt;) 을 접근할 수 있게 해주는 동작(&lt;code&gt;def iterProxy : Iter2[I]&lt;/code&gt;)&lt;/p&gt;
&lt;p&gt;으로 구성된 새로운 &lt;code&gt;type class Iterable2[R[_], I[_]]&lt;/code&gt; 를 만들어보자.&lt;/p&gt;
&lt;h3 id=&quot;&amp;#51116;&amp;#47308;&quot;&gt;&amp;#51116;&amp;#47308;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#51116;&amp;#47308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.language.higherKinds&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[23]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.higherKinds&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;아래는 예제에 사용될 MyTree 라는 데이터타입이다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//재료&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[17]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.higherKinds

&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;MyTree&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Empty&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Node&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&amp;lt;/br&amp;gt;&lt;/p&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[24]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[24]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Iterable2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[26]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;treeIterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Iterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Nil&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; 
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iter2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[26]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;treeIterable2&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;TIP ::  위의 코드는 아래와같이도 사용할 수 있다.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[&amp;nbsp;]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;implicit def treeIterable2: Iterable2[MyTree, List] = new Iterable2[MyTree, List]{&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    def iter[A](a : MyTree[A]) : List[A] = a match {&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;        case Empty() =&amp;gt; Nil &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;        case Node(v, left, right) =&amp;gt; v :: (iter(left) ++ iter(right)) &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    }&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    def iterProxy : Iter2[List]  =  implicitly[Iter2[List]] // type 주어진 채로 연동하기  &lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;**/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[27]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//1. xs 에 인자가 전달된다. R과 _가 결정된다.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//2. 결정된 R과 _ 를 확인한 implicit 가 proxy 를 결정한다. I가 결정된다. &lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;R&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;printElements3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterProxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[27]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;sumElements4&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;printElements4&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[28]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[28]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;t2&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;MyTree&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = Node(3,Node(4,Node(5,Empty(),Empty()),Empty()),Empty())&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[29]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sumElements4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printElements4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3
4
5
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[29]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res28_0&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;12&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h1 id=&quot;8.-Higher-kind-Type-classes-+-Functor-Specification&quot;&gt;8. Higher-kind Type classes + Functor Specification&lt;a class=&quot;anchor-link&quot; href=&quot;#8.-Higher-kind-Type-classes-+-Functor-Specification&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;&amp;#51116;&amp;#47308;&quot;&gt;&amp;#51116;&amp;#47308;&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#51116;&amp;#47308;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[30]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.language.higherKinds&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[30]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-green-fg&quot;&gt;import &lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;scala.language.higherKinds&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[33]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//재료&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[33]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;MyTree&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Empty&lt;/span&gt;
defined &lt;span class=&quot;ansi-green-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Node&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&amp;lt;/br&amp;gt;&lt;/p&gt;
&lt;h3 id=&quot;part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;part1 : type class &amp;#48376;&amp;#52404;&lt;a class=&quot;anchor-link&quot; href=&quot;#part1-:-type-class-&amp;#48376;&amp;#52404;&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[31]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;trait&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[31]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;trait&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Functor&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;part2 : type class &amp;#51032; instance (customize)&lt;a class=&quot;anchor-link&quot; href=&quot;#part2-:-type-class-&amp;#51032;-instance-(customize)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[34]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ListFunctor&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TreeFunctor&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTree&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[34]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;ListFunctor&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Functor&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;List&lt;/span&gt;] = $sess.cmd33Wrapper$Helper$$anon$1@3bbdd7c8
&lt;span class=&quot;ansi-cyan-fg&quot;&gt;TreeFunctor&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Functor&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;MyTree&lt;/span&gt;] = $sess.cmd33Wrapper$Helper$$anon$2@6f83087e&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&lt;a class=&quot;anchor-link&quot; href=&quot;#part3-:-type-class-&amp;#51032;-interface-(&amp;#49324;&amp;#50857;)&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[35]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;,&lt;span class=&quot;kt&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Functor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[35]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;defined &lt;span class=&quot;ansi-green-fg&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;compose&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;result&quot;&gt;result&lt;a class=&quot;anchor-link&quot; href=&quot;#result&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[28]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[28]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;t2&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;MyTree&lt;/span&gt;[&lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt;] = Node(3,Node(4,Node(5,Empty(),Empty()),Empty()),Empty())&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[29]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-scala&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3
4
5
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[29]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-cyan-fg&quot;&gt;res28_0&lt;/span&gt;: &lt;span class=&quot;ansi-green-fg&quot;&gt;Int&lt;/span&gt; = &lt;span class=&quot;ansi-green-fg&quot;&gt;12&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">이번 글에서는 scala 의 Type class 에 대해서 코드와 함께 알아보도록 하겠습니다. Type class 를 이용하면 기존의 object oriented programming 에서 사용하던 상속이나 객체, 클래스의 개념 없이도 다양한 기능을 구현할 수 있습니다. (개인적인 소감으로는, Object Oriented Programming 의 소중함을 느끼게 해주는 공부였습니다...) 1. Type Class &amp;#51032; &amp;#44396;&amp;#49457;&amp;#182; type class 본체 type class 의 instance (customizing) type class 의 interface (함수 사용) Type class 는 크게 위와같은 3가지 구성으로 이루어져 있습니다 . Type class 본체는 abstract class 또는 trait로 만듭니다. 자세한 메서드의 구현은 생략하고, 공통된 동작만 기술되어 있습니다. Type class 의 instance 는 Type class 의 본체에 특정 Type 을 대입하여 구체화시켰다고 생각할 수 있습니다. Type class 의 인터페이스(interface) 에 특정 Type 이 들어왔을 때 어떤 동작을 할 것인지 구체적으로 Type Class 의 인스턴스로 표현 할 수 있습니다. implicit def, 또는 implicit val 로 많이 표현합니다. 자세한 예는 아래서 다루도록 하겠습니다. Type Class 의 interface는 두 가지 파라메터(인자)를 받습니다. 하나는 실제 함수에서 다룰 데이터이고, 하나는 데이터를 처리하는 동작이 기술되어있는 Type class 의 instance 입니다. 2. Type Class &amp;#44060;&amp;#50836;&amp;#182; 기본적으로 type class 는 type 을 parameter로 받는 class 입니다. 이제 이 아래부터는 실제 스칼라 코드를 통해서 여러가지 Type Class 와 그의 인스턴스, 인터페이스들을 구현해보도록 하겠습니다. 3. &amp;#54616;&amp;#45208;&amp;#51032; type parameter &amp;#47484; &amp;#48155;&amp;#45716; Type class&amp;#182; part1 : type class &amp;#51032; &amp;#48376;&amp;#52404;&amp;#182; Ord[A] 는 type A 의 무언가를 크기비교하는 기능을 가진 type class 입니다. Type Class 는 간단히 abstract class 또는 traits를 통해 구현합니다. 메서드는 정의하지만 정확한 동작은 인스턴스에서 구현합니다. In&amp;nbsp;[1]: abstract class Ord[A]{ def cmp(me : A, you : A) : Int // instnace 에서 구현될 것입니다. //A의 type 과 관계 없는 공통된 메서드들은 미리 작성해놓기도 합니다. def ===(me : A, you : A) : Boolean = cmp(me, you) == 0 def &amp;lt;(me : A, you : A) : Boolean = cmp(me, you) &amp;lt; 0 def &amp;gt;(me : A, you : A) : Boolean = cmp(me, you) &amp;gt; 0 def &amp;lt;=(me : A, you : A) : Boolean = cmp(me, you) &amp;lt;= 0 def &amp;gt;=(me : A, you : A) : Boolean = cmp(me, you) &amp;gt;= 0 } Out[1]: defined class Ord part2 : type class &amp;#51032; instance (customize)&amp;#182; Ord[A] 의 type parameter A 에 다양한 type 을 집어넣음으로써 각각의 instance 를 구현합니다. type parameter 의 instance 는 implicit val 또는 implicit def 를 통해 구현합니다. (implicit def는 보통 생성할 instance에 parameter type 을 한번 더 주고 싶을 때 사용합니다. ) 잘 감이 안오신다면, 밑에 코드에서 한번 더 언급될 것입니다. 그때 다시 설명하겠습니다. 1. Ord[Int] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182;Int 라는 타입을 다룰 수 있는 Type class 의 인스턴스입니다. 이 인스턴스를 인자로 받는 interface는 Int 타입의 데이터를 조작할 수 있습니다. In&amp;nbsp;[0]: // A = Int implicit val intOrd : Ord[Int] = new Ord[Int]{ //Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화 def cmp(me : Int , you : Int) : Int = me - you } cmd0.sc:1: not found: type Ord implicit val intOrd : Ord[Int] = new Ord[Int]{ //Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화 ^cmd0.sc:1: not found: type Ord implicit val intOrd : Ord[Int] = new Ord[Int]{ //Ord[A] 의 A 에 Int를 대입하고 new Ord[Int] 로 초기화 ^ Compilation Failed 2. Ord[Double] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182;마찬가지고 Double 이라는 타입을 다룰 수 있는 Type class 의 인스턴스입니다. 이 인스턴스를 인자로 받는 interface는 Double 타입의 데이터를 조작할 수 있습니다. In&amp;nbsp;[3]: // A = Double implicit val doubleOrd : Ord[Double] = new Ord[Double]{ def cmp(me : Double, you : Double) : Int = (me - you).toInt } Out[3]: doubleOrd: Ord[Double] = $sess.cmd2Wrapper$Helper$$anon$1@3368bc6f 3. Ord[ (X,Y) ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182;여기에선 특별하게 implicit instance 안에 인자로 다시한번 implicit parameter를 받았습니다. (X,Y) 형식의 type 을 다룰 수 있도록 해주는 Type class 의 인스턴스이고, 이 인스턴스를 받는 interface는 모두 (X,Y) 형식의 type 의 데이터를 다룰 수 있습니다. type class interface + instance 의 혼종이라고 생각하면 좋겠습니다. (아래 interface 부분을 보시고 다시 보시는게 이해에 도움 됩니다. 조금 어렵습니다.) In&amp;nbsp;[4]: // A = (X,Y) implicit def twoOrd[X,Y](implicit ordX : Ord[X], ordY : Ord[Y]) : Ord[(X,Y)] = new Ord[(X,Y)]{ def cmp(me : (X,Y), you : (X,Y)) : Int = { val c1 = ordX.cmp(me._1, you._1) if(c1 != 0) c1 else ordY.cmp(me._2 , you._2) } } Out[4]: defined function twoOrd part3 : type class interface (&amp;#49324;&amp;#50857;)&amp;#182; type class Ord[X] 의 interface 에는 두개의 입구가 있습니다. type X 인 데이터 parameter 들을 받는 입구 Ord[X] 의 instance 를 implicit parameter 로 받는 입구 1번 입구에서 받은 data 들을 , 2번 입구에서 받은 type class instance 의 규칙을 이용해 처리합니다. 여기서 implicit parameter 의 입구는, scala 의 컴파일러에 의해 자동으로 코드 내의 implicit val / implicit def 로 구현된 Cls[X] 의 instance 를 찾아 연결합니다. 즉, 1번 입구는 넣어주어야하지만, 2번 입구는 인스턴스들만 만들어 놓았다면 자동으로 채워집니다. In&amp;nbsp;[5]: def max3[A](a : A, b : A, c: A)(implicit ord : Ord[A]) : A = if (ord.&amp;lt;=(a,b)) {if (ord.&amp;lt;=(b,c)) c else b} else {if (ord.&amp;lt;=(a,c)) c else a } Out[5]: defined function max3 result&amp;#182; In&amp;nbsp;[6]: max3[Int](1,2,3) // ord = intOrd 인스턴스 자동 사용됨 max3[Double](1.1, 2.2, 3.3) // ord = doubleOrd 인스턴스 자동 사용됨 Out[6]: res5_0: Int = 3 res5_1: Double = 3.3 4. &amp;#46160;&amp;#44060; &amp;#51032; type parameter &amp;#47484; &amp;#48155;&amp;#45716; Type class&amp;#182; 같은 방식으로, 이번엔 두개의 type parameter 를 받는 type class 를 보겠습니다. part1 : type class &amp;#51032; &amp;#48376;&amp;#52404;&amp;#182; Iter[I,A] 는 type A 를 저장하고있는 type I 에서 , A를 조회하거나 다음 I 로 넘어가는 기능을 구현합니다. 예를 들자면, A 가 Int 이면 I 는 이를 저장하는 List[Int]가 될 것이고 A 가 String 이면 I는 이를 저장하는 List[String] 이 될 것입니다. In&amp;nbsp;[7]: abstract class Iter[I, A]{ def getValue(i : I) : Option[A] //메서드의 디테일은 인스턴스에서 구현합니다. def getNext(i : I) : I } Out[7]: defined class Iter part2 : type class &amp;#51032; instance (customize)&amp;#182; Iter[I, A] 의 parameter I, A 에 다양한 type 을 집어넣음으로써 각각의 instance 를 구현합니다. 다시한번.. (implicit def는 보통 생성할 instance에 parameter type 을 한번 더 주고 싶을 때 사용합니다. ) 1. Iter[Int, Int] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182; In&amp;nbsp;[8]: // I = Int, A = Int // Int 라는 저장 구조(I) 안에서 Int 데이터(A)를 조회할 수 있습니다. implicit val intIter : Iter[Int, Int] = new Iter[Int, Int]{ def getValue(i : Int) = if (i&amp;gt;0) Some(i) else None def getNext(i : Int) = if(i-1 &amp;gt; 0 ) i-1 else 0 } Out[8]: intIter: Iter[Int, Int] = $sess.cmd7Wrapper$Helper$$anon$1@5a79ff31 2. Iter[ List[X], X ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828;&amp;#182;이 인스턴스의 독특한 점은, 인스턴스의 완성을 interface 로 떠넘겼다는 것입니다. X는 결국 이 인스턴스가 사용되는 interface 에서 결정됩니다. 즉 interface에서 X를 Int 로 주면 Iter[List[Int], Int] 가 되고 다른 값으로 주면 달라집니다. In&amp;nbsp;[9]: // I = List[X], A = X //List 라는 저장구조 (I) 안에서 X 타입의 데이터(A) 를 조회할 수 있습니다. implicit def listIter[X] : Iter[List[X], X] = new Iter[List[X], X]{ def getValue(i : List[X]) = i.headOption def getNext(i : List[X]) = i.tail } Out[9]: defined function listIter part3 : type class interface (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[10]: // listIter 의 X를 인스턴스 파라메터에서 Int로 고정해놓았습니다. def sumElements[I](xs : I)(implicit proxy : Iter[I, Int]) : Int = proxy.getValue(xs) match{ case None =&amp;gt; 0 case Some(n) =&amp;gt; n + sumElements(proxy.getNext(xs)) } // listIter 의 X는 xs(I) 의 타입에 따라 결정됩니다. I 가 List[Int] 이면, A 도 Int 가 됩니다. def printElements[I](xs : I)(implicit proxy : Iter[I, A]) :Unit = proxy.getValue(xs) match{ case None =&amp;gt; case Some(n) =&amp;gt; {println(n) ; printElements(proxy.getNext(xs))} } Out[10]: defined function sumElements defined function printElements result&amp;#182; In&amp;nbsp;[11]: printElements[List[Int]](List(3,4,5,6)) printElements[Int](10) 3 4 5 6 10 9 8 7 6 5 4 3 2 1 5. &amp;#51328; &amp;#45908; &amp;#48373;&amp;#51105;&amp;#54620; &amp;#47928;&amp;#51228;&amp;#46308;&amp;#182; &amp;#51116;&amp;#47308;&amp;#182; In&amp;nbsp;[12]: //재료 sealed abstract class MyTree[A] case class Empty[A]() extends MyTree[A] case class Node[A](value : A, left : MyTree[A], right : MyTree[A]) extends MyTree[A] Out[12]: defined class MyTree defined class Empty defined class Node part1 : type class &amp;#48376;&amp;#52404;&amp;#182; 순환적이지 않은 type R 의 무언가를 순환적으로 만들어준다. iter()는 순환적이지 않은 type R 의 무언가를 순환적인 I 로 바꾸고, I는 A들을 포함한다. In&amp;nbsp;[13]: abstract class Iterable[R, I ,A] { def iter(a: R) : I def iterProxy : Iter[I,A] } Out[13]: defined class Iterable part2 : type class &amp;#51032; instance (customize)&amp;#182; Iterable[ MyTree[X] , List[X], X ] &amp;#51064;&amp;#49828;&amp;#53556;&amp;#49828; (&amp;lt;- X &amp;#50976;&amp;#46041;&amp;#51201; )&amp;#182; In&amp;nbsp;[14]: implicit def treeIterable[X](implicit proxy : Iter[List[X], X]) : Iterable[MyTree[X], List[X], X] = new Iterable[MyTree[X], List[X], X]{ def iter(a : MyTree[X]) : List[X] = a match{ case Empty() =&amp;gt; Nil case Node(v, left, right) =&amp;gt; v :: (iter(left) ++ iter(right)) } def iterProxy : Iter[List[X], X] = proxy } Out[14]: defined function treeIterable part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[15]: def sumElements2[R, I](xs : R)(implicit proxy : Iterable[R, I ,Int]) = sumElements(proxy.iter(xs))(proxy.iterProxy) def printElements2[R, I](xs : R)(implicit proxy : Iterable[R, I, Int]) = printElements(proxy.iter(xs))(proxy.iterProxy) Out[15]: defined function sumElements2 defined function printElements2 result&amp;#182; In&amp;nbsp;[16]: val tree : MyTree[Int] = Node(10, Node(9, Empty(), Empty()), Node(8, Empty(), Empty())) sumElements2[MyTree[Int], List[Int]](tree) Out[16]: tree: MyTree[Int] = Node(10,Node(9,Empty(),Empty()),Node(8,Empty(),Empty())) res15_1: Int = 27 6. Higher-kind Type classes&amp;#182; Higher-kind 는 type 들을 다시 상위의 하나의 개념으로 묶는, 상위 카테고리라고 할 수 있고, 변역은 &quot;상류&quot; 로 한다. 아래 링크를 참고하면 좋다. twitter 의 scalaschool : scala의 상류 타입 https://twitter.github.io/scala_school/ko/advanced-types.html#higher &amp;#51116;&amp;#47308;&amp;#182; In&amp;nbsp;[23]: import scala.language.higherKinds Out[23]: import scala.language.higherKinds higher kind 를 사용하려면 scala 에서 위처럼 higerKinds 패키지를 import 해줘야한다. part1 : type class &amp;#48376;&amp;#52404;&amp;#182; In&amp;nbsp;[18]: abstract class Iter2[I[_]]{ def getValue[A](a : I[A]) : Option[A] def getNext[A](a : I[A]) : I[A] } Out[18]: defined class Iter2 part2 : type class &amp;#51032; instance (customize)&amp;#182; Iter2[I[_]] 를 일종의 익명함수 처럼 생각하고 , 빈칸안에 들어올 인자타입은 나중에 받는 것으로 보류하고 나머지를 구현한다. In&amp;nbsp;[19]: implicit val listIter2 : Iter2[List] = new Iter2[List]{ def getValue[A](a : List[A]) = a.headOption def getNext[A](a : List[A]) = a.tail } Out[19]: listIter2: Iter2[List] = $sess.cmd18Wrapper$Helper$$anon$1@1188d429 part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[20]: // Int 를 담는 higerkind I 에 대해서만 동작한다. def sumElements3[I[_]](xs : I[Int])(implicit itr2 : Iter2[I]) : Int = { itr2.getValue(xs) match { case None =&amp;gt; 0 case Some(n) =&amp;gt; n + sumElements3(itr2.getNext(xs)) } } // higerkind I 에 담긴 type X에 구애를 받지 않는다. def printElements3[I[_],X](xs : I[X])(implicit itr2 : Iter2[I]) : Unit = { itr2.getValue(xs) match { case None =&amp;gt; case Some(n) =&amp;gt; {println(n) ; printElements3(itr2.getNext(xs))} } } Out[20]: defined function sumElements3 defined function printElements3 result&amp;#182; In&amp;nbsp;[22]: val lst = List(4, 5, 10 ,8, 9) sumElements3(xs = lst) // 과정1. lst 가 들어가면서 I = List 타입인자 전달 ; // 과정2. itr2 : Iter2[List] = listIter2 자동으로 채워짐 (implicit 끼리의 연동) printElements3(xs = lst) 4 5 10 8 9 Out[22]: lst: List[Int] = List(4, 5, 10, 8, 9) res21_1: Int = 36 7. Higher-kind Type classes + &amp;#51328; &amp;#45908; &amp;#50612;&amp;#47140;&amp;#50868; &amp;#47928;&amp;#51228;&amp;#46308;&amp;#182; 순환가능하지 않은 타입 R 을 순환 가능한 타입 I 으로 바꿔주는 동작과 (def iter : I), 그 순환가능한 타입 I에 대한 순환동작(type class Iter2[I]) 을 접근할 수 있게 해주는 동작(def iterProxy : Iter2[I]) 으로 구성된 새로운 type class Iterable2[R[_], I[_]] 를 만들어보자. &amp;#51116;&amp;#47308;&amp;#182; In&amp;nbsp;[23]: import scala.language.higherKinds Out[23]: import scala.language.higherKinds 아래는 예제에 사용될 MyTree 라는 데이터타입이다. In&amp;nbsp;[17]: //재료 sealed abstract class MyTree[A] case class Empty[A]() extends MyTree[A] case class Node[A](value : A, left : MyTree[A], right : MyTree[A]) extends MyTree[A] Out[17]: import scala.language.higherKinds defined class MyTree defined class Empty defined class Node &amp;lt;/br&amp;gt; part1 : type class &amp;#48376;&amp;#52404;&amp;#182; In&amp;nbsp;[24]: abstract class Iterable2[R[_], I[_]]{ def iter[A](a : R[A]) : I[A] def iterProxy : Iter2[I] } Out[24]: defined class Iterable2 part2 : type class &amp;#51032; instance (customize)&amp;#182; In&amp;nbsp;[26]: implicit def treeIterable2(implicit proxy : Iter2[List]) : Iterable2[MyTree, List] = new Iterable2[MyTree, List]{ def iter[A](a : MyTree[A]) : List[A] = a match { case Empty() =&amp;gt; Nil case Node(v, left, right) =&amp;gt; v :: (iter(left) ++ iter(right)) } def iterProxy : Iter2[List] = proxy } Out[26]: defined function treeIterable2 TIP :: 위의 코드는 아래와같이도 사용할 수 있다. In&amp;nbsp;[&amp;nbsp;]: /** implicit def treeIterable2: Iterable2[MyTree, List] = new Iterable2[MyTree, List]{ def iter[A](a : MyTree[A]) : List[A] = a match { case Empty() =&amp;gt; Nil case Node(v, left, right) =&amp;gt; v :: (iter(left) ++ iter(right)) } def iterProxy : Iter2[List] = implicitly[Iter2[List]] // type 주어진 채로 연동하기 } **/ part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[27]: def sumElements4[R[_],I[_]](xs : R[Int])(implicit proxy : Iterable2[R, I]) = sumElements3(proxy.iter(xs))(proxy.iterProxy) //1. xs 에 인자가 전달된다. R과 _가 결정된다. //2. 결정된 R과 _ 를 확인한 implicit 가 proxy 를 결정한다. I가 결정된다. def printElements4[R[X], I[X], X](xs : R[X])(implicit proxy : Iterable2[R,I]) = printElements3(proxy.iter(xs))(proxy.iterProxy) Out[27]: defined function sumElements4 defined function printElements4 result&amp;#182; In&amp;nbsp;[28]: val t2 : MyTree[Int] = Node(3, Node(4, Node(5, Empty(), Empty()), Empty()), Empty()) Out[28]: t2: MyTree[Int] = Node(3,Node(4,Node(5,Empty(),Empty()),Empty()),Empty()) In&amp;nbsp;[29]: sumElements4(t2) printElements4(t2) 3 4 5 Out[29]: res28_0: Int = 12 8. Higher-kind Type classes + Functor Specification&amp;#182; &amp;#51116;&amp;#47308;&amp;#182; In&amp;nbsp;[30]: import scala.language.higherKinds Out[30]: import scala.language.higherKinds In&amp;nbsp;[33]: //재료 sealed abstract class MyTree[A] case class Empty[A]() extends MyTree[A] case class Node[A](value : A, left : MyTree[A], right : MyTree[A]) extends MyTree[A] Out[33]: defined class MyTree defined class Empty defined class Node &amp;lt;/br&amp;gt; part1 : type class &amp;#48376;&amp;#52404;&amp;#182; In&amp;nbsp;[31]: trait Functor[F[_]] { def map[A, B](f : A=&amp;gt;B)(x : F[A]) : F[B] } Out[31]: defined trait Functor part2 : type class &amp;#51032; instance (customize)&amp;#182; In&amp;nbsp;[34]: implicit val ListFunctor : Functor[List] = new Functor[List]{ def map[A,B](f : A=&amp;gt;B)(x : List[A]) : List[B] = x.map(f) } implicit val TreeFunctor : Functor[MyTree] = new Functor[MyTree]{ def map[A,B](f : A=&amp;gt;B)(x : MyTree[A]) : MyTree[B] = x match{ case Empty() =&amp;gt; Empty() case Node(v, left, right) =&amp;gt; Node(f(v), map(f)(left), map(f)(right)) } } Out[34]: ListFunctor: Functor[List] = $sess.cmd33Wrapper$Helper$$anon$1@3bbdd7c8 TreeFunctor: Functor[MyTree] = $sess.cmd33Wrapper$Helper$$anon$2@6f83087e part3 : type class &amp;#51032; interface (&amp;#49324;&amp;#50857;)&amp;#182; In&amp;nbsp;[35]: def compose[F[_],X,Y,Z](g : Y=&amp;gt;Z)(f : X=&amp;gt;Y)(xs : F[X])(implicit proxy : Functor[F]) : F[Z] ={ proxy.map(g)(proxy.map(f)(xs)) } Out[35]: defined function compose result&amp;#182; In&amp;nbsp;[28]: Out[28]: t2: MyTree[Int] = Node(3,Node(4,Node(5,Empty(),Empty()),Empty()),Empty()) In&amp;nbsp;[29]: 3 4 5 Out[29]: res28_0: Int = 12</summary></entry><entry><title type="html">not mnist 데이터 Neural Network</title><link href="https://shinjayne.github.io//deeplearning/2017/06/01/not-mnist-nn.html" rel="alternate" type="text/html" title="not mnist 데이터 Neural Network" /><published>2017-06-01T22:23:40+09:00</published><updated>2017-06-01T22:23:40+09:00</updated><id>https://shinjayne.github.io//deeplearning/2017/06/01/not-mnist-nn</id><content type="html" xml:base="https://shinjayne.github.io//deeplearning/2017/06/01/not-mnist-nn.html">&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Deep-Learning&quot;&gt;Deep Learning&lt;a class=&quot;anchor-link&quot; href=&quot;#Deep-Learning&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;Assignment-1&quot;&gt;Assignment 1&lt;a class=&quot;anchor-link&quot; href=&quot;#Assignment-1&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The objective of this assignment is to learn about simple data curation practices, and familiarize you with some of the data we'll be reusing later.&lt;/p&gt;
&lt;p&gt;This notebook uses the &lt;a href=&quot;http://yaroslavvb.blogspot.com/2011/09/notmnist-dataset.html&quot;&gt;notMNIST&lt;/a&gt; dataset to be used with python experiments. This dataset is designed to look like the classic &lt;a href=&quot;http://yann.lecun.com/exdb/mnist/&quot;&gt;MNIST&lt;/a&gt; dataset, while looking a little more like real data: it's a harder task, and the data is a lot less 'clean' than MNIST.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# These are all the modules we&amp;#39;ll be using later. Make sure you can import them&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# before proceeding further.&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;__future__&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;print_function&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tarfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;IPython.display&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndimage&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.linear_model&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LogisticRegression&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;six.moves.urllib.request&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlretrieve&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;six.moves&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Config the matplotlib backend as plotting inline in IPython&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First, we'll download the dataset to our local machine. The data consists of characters rendered in a variety of fonts on a 28x28 image. The labels are limited to 'A' through 'J' (10 classes). The training set has about 500k and the testset 19000 labeled examples. Given these sizes, it should be possible to train models quickly on any machine.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://commondatastorage.googleapis.com/books1000/&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;last_percent_reported&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Change me to store data elsewhere&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;download_progress_hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;A hook to report the progress of a download. This is mostly intended for users with&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;  slow internet connections. Reports every 5% change in download progress.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;  &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_percent_reported&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blockSize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;totalSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_percent_reported&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s%%&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
      
    &lt;span class=&quot;n&quot;&gt;last_percent_reported&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;percent&lt;/span&gt;
        
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;maybe_download&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expected_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Download a file if not present, and make sure it&amp;#39;s the right size.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Attempting to download:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlretrieve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reporthook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_progress_hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Download Complete!&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;statinfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;statinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;st_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expected_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Found and verified&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;s1&quot;&gt;&amp;#39;Failed to verify &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;. Can you get to it with a browser?&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest_filename&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_download&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;notMNIST_large.tar.gz&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;247336696&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_download&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;notMNIST_small.tar.gz&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8458043&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found and verified ./notMNIST_large.tar.gz
Found and verified ./notMNIST_small.tar.gz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Extract the dataset from the compressed .tar.gz file.
This should give you a set of directories, labeled A through J.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;133&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;maybe_extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# remove .tar.gz&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# You may override by setting force=True.&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; already present - Skipping extraction of &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Extracting data for &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;. This may take a while. Please wait.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tarfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;s1&quot;&gt;&amp;#39;Expected &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; folders, one per class. Found &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; instead.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;
  
&lt;span class=&quot;n&quot;&gt;train_folders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_folders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;./notMNIST_large already present - Skipping extraction of ./notMNIST_large.tar.gz.
[&amp;#39;./notMNIST_large/A&amp;#39;, &amp;#39;./notMNIST_large/B&amp;#39;, &amp;#39;./notMNIST_large/C&amp;#39;, &amp;#39;./notMNIST_large/D&amp;#39;, &amp;#39;./notMNIST_large/E&amp;#39;, &amp;#39;./notMNIST_large/F&amp;#39;, &amp;#39;./notMNIST_large/G&amp;#39;, &amp;#39;./notMNIST_large/H&amp;#39;, &amp;#39;./notMNIST_large/I&amp;#39;, &amp;#39;./notMNIST_large/J&amp;#39;]
./notMNIST_small already present - Skipping extraction of ./notMNIST_small.tar.gz.
[&amp;#39;./notMNIST_small/A&amp;#39;, &amp;#39;./notMNIST_small/B&amp;#39;, &amp;#39;./notMNIST_small/C&amp;#39;, &amp;#39;./notMNIST_small/D&amp;#39;, &amp;#39;./notMNIST_small/E&amp;#39;, &amp;#39;./notMNIST_small/F&amp;#39;, &amp;#39;./notMNIST_small/G&amp;#39;, &amp;#39;./notMNIST_small/H&amp;#39;, &amp;#39;./notMNIST_small/I&amp;#39;, &amp;#39;./notMNIST_small/J&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-1&quot;&gt;Problem 1&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-1&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's take a peek at some of the data to make sure it looks sensible. Each exemplar should be an image of a character A through J rendered in a different font. Display a sample of the images that we just downloaded. Hint: you can use the package IPython.display.&lt;/p&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;png_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACRUlEQVR4nG2STUiUYRDH//O8z368
vvu9qGyZH7upaaYb9GEYlVFRknTJsFsWHTt1rEvnunSIQKhDF6EuBR6MwkzE0CQJKiFF11owd9Vd
M0133/eZDtruYs1pmP/8/swwA+TCZRB0GyhfKUi9zpbwSNn7KWJsD4Ezj4d4+tvtCvEfreH+GGcs
jt/Nu+XbxO9qlmB/Sd0/qA0XlVLMnJ6/k5tkq0tkz3fNKwLYa2gV22wJh9itWRYYc5fLcsiW6HLW
GUzmIni35yC4UCQzsj+saO3N+DipYNVplV+f4K58Ns4WD/uv9/1kjt2r3YQ2yeLETNQkNbA8s6wB
pd7yvC1rqQtXVyRNJAID/SMxOE85vIpypLzkM3hpcHhBvf5RzDBaG3IkWc3NmkBqJQ271S9ZFe+I
h7S/trvML0BqcvirWF9K9whYnS1rNgASIOG5doRJD54ITB2eMU4u+bTMlbFpABLE/r1NToKokY3R
wY6AYSfQgcjiIjGgaU3dSVaKmVmtWhvMzCY/DUtAgOjY2Q0wccYC67BDKQD1uhMQZLoDJT4I0yRO
ILH6fZ0FC+j1RSDJjrZmMjj7cK79ecyfOqr37uuotVxVNz4kCLL+5ifO8pNzERR54LOHg/Zbr2bZ
+tgDErqjuoZlKrYQx/qKXM5OpzIPRn0QO5NdmnA3ttpUenB2coMUm8zEWvrlrwX2tFWawt8ZRppG
e9XWhZkVJoYcq7aIuUfi7bvS4y8eJQu/zdeth/qin+OQoUqbSycqFPWgLDec7e4/wqfzL3yRo74A
AAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB0klEQVR4nG2QP2iTURTFz33vfTHG
+qeaGJXaDiJ0VBSXdlPwD2RS6tQQB4PopBRnwV0nZ1HErQguthqIoDj4p5OIUNCtoKkd/EpD8r13
j8P3tU1M7nruPfecn2BrhLse7u7OtYQYHIsZktdgh2gweBs2fANm2KGcCqraPr6t9qyxboKE/OUh
p4LyH1V6LlkZEB1uM5CqemYwkkTf/F8qEz6AG+hxnm/u0TPwZwH/GRu8YHUsKBl4Sfp9jUx218r4
xMCEzzafZrENa9H8L5kHYXGxGHrbCPau6BQw2SHpWeuL5FDjRyOC9/T0XOzjIPYDb0oUmTv0VLaP
9agW02yNAsDRDSoT3k19DQAQdS6YcrF0sP0FCsGMCdsdJ2J6DSGEQJJUfxoWgANgtDqyHqdUeEiA
4K5+ziCJFJZ5K8o751wuaqpn4I+dGUKHK1wtbX64QU8GXsiqGrzWx7AiImIwFlOZ6JMUoZWTXZ6V
LZwv6alsFSEAHB7x6w7JAjip0pOes+KAHMbXeN/kUyQmZ4/EVHo24CywrxH89R6U+1s+8T5JKoA8
PXcY6Cz+ft40anSqOjI9ni75Vwtu9vtSnByYqCw3jRo9Ue+svFtdD4XRUrGy5x9iB+fsHcXRxwAA
AABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABkklEQVR4nG2SPWgUURSFv3ffc2MR
3QRShKAB0VaMgnUaFxIhRYIisikFLWwsXGwsbGwsAsElRYp0KoJiYSEWCUmRwkpdAyJp4w8R1r+I
M7s7x2LW7Dozp3zn3XPPvfdADoNXLP+YwnOzeQhXyBkTvzSFL+IcBzelxWLSc1eR3oUiXU+lkyTS
WfKeHOWd+mvFul2g63nYYFmR1vOynmoywWW19Od4VtcY/3kDxr6ppauEbMfVNbzjpSI9yVQGaj+O
YoGaYu2O/NfVOB1XCRhnEnU01+/XYe8f4MExsKVIS/2kZ2FnCAcE6oq0PdDT9VR0Lv3smVFHmtwv
dQx/XOCAmZl5RncV684+6Xn8ln86nqeK9AqXzhra8xfPDx3udMnmm1nj1MmGpVMc+6K9dtyD1NZ1
vAMs2Uiqg0nP+ff7c3HpxbQBntreeP+6PJfUUvNIuhrNd51a1+/YV7V0ARylrUeZ2xrPFWkFAouf
ypnbBq4p1nYZplTJhsI48VuJKox8vlcUxDVFqvOsUcoHJnBLsT78BQa9o9I46XHmAAAAAElFTkSu
QmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABtUlEQVR4nG2QvWuTURSHn3PuTUuJ
1K9SaqTVqmmSipuTFaGLg4OL4ODQSXD3T3HWf8GhaxctoiiCgjRpPvoVa9GgQ6WNje9973FQTN7o
b314Ds+9AgAuhcs3FsqFE6PxsLP1euWFIfaHkb//rGv9xVdLoAAi3G2aWa8XzMziz15iZiuTv5k8
MjtKzMyS7o9gZhaSxN5NCKg+WQri+PD8zWbnwOUnigs3Z7DUL4NSssTs6aLj78Yf7FlI34PjVgz7
twHvnYqq8w5m1lJ7rAhlcW+XnZMQ0mgxpiGVXPuTUlWgAi0nqfXPkoyVoeqJlKApfgChsTBJt+Ul
jp2HlyGQ2elRPu96sbNTcOeaWMa8GnX7yAsXclEfMrygDbxQIloCg6aQg3U8zINz/5iROj5SQlfX
NA6KduyeSzeBkS2zxWGvGG0vj+dMgfSLz5g+XBe2D8UzO0KnHTIvIRShgVPmYOcgy4wy1EApQ4Ns
baqX+rCWrRFOTRM3iJqbhVrmBxDOHefrR0ynCsRWFipFYee7mF4c59tuFkIFmji0Au39/8SuA3oF
6sOxzEEV0HmoD8eenMY2iPwCfiLNWm5dWDQAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACSUlEQVR4nF1QS0hUYRg93//fmSw1
Z9SJTFO0l1mWWvRuxNICK0slAhdNRBguKrLHQojKisgggp4GgRAJGYUJii2qhRQhIkkUJhoEae8U
HdNx5t7TYkwbz+LbHM7jO4JJ2FMAALT5eiyEQmO7d3B42Dvk+z3qFj2VvEOLNHnK1VkPNVXawTGL
vI8t372zIP9TCuufHKe/s9h2maQHRiiZWT69jnuM6yT5GKGhEQAiL9nryR/fRr44IJhQK5XwyV/e
+yrs1le5eWW5K71FmaGNzlUXRjVtADa18sJkqGDOroRgvzgFYMYhz+QzSjeyFBXxBXZJepDvCPFT
mGu24GCDPHdicdPK6MwcbZ8kJfln3kV2ZS8wBMaRbvOzdpQa8i/SfpUcYyvEwD6SfQ5kxQZHEsRM
QyX9gTdKNAosv0n3xHoaB9YAZRarYQhifwXM3kToZeNK++6okxuR25ENDY17ZCNiZj6NAwAt6e0p
VQOpiBBDQUtR8w7bsbvzuD/oeoOvK/ghJVhcRWThKIvL2msE0LKiO+cF/ewpTN27CMDMtUXsi7+2
5G0CoPHQV9dhWibp875cnZyN8N7+nUkZeYFcaKwKWCRpmWTVNu+JEtSwDBEIazuriPPaNC1Q1Dv6
E9VI7VZPS5fTK7aM+YblzvUriCks6W77oyqttNvNg60Zzgad7wceMQgP7O7ZcLkyNiMRC5ficBok
6eOz/ujhdQNnao0AIAQgFALOUR9Ovw8HEGmHArRARGkIRADAGCka1pYMQZuACRAcP0L8BQpd8V+r
binjAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABbElEQVR4nG3Sv05UQRQG8O+cGWSR
XUIICYnFRgsoeAE6ShqMLT2ViQ0WBAseAQsrbaxoaICClhj/tJuND0C0EIiJJqurcHeZmfNR7GZZ
7tzTTDK/fGfOZAaoKvECv9GqNCeY2WyRVaRY2P5OWspIVWrPL8mYsqSoYq1NhkSWUT2WjwJjIjN0
qlt/hqkSikfzmDHSLEP1WP/GkJgsS6r4XUuRjLy4KqGi9po3iRZ5vnjKNI6K+jv2jRb4YQlf7qFi
dp83Rgt8O+PweRwFU2+GuT2Rh/g0hgK8YI9k4PsHrlYvtV1jIC1xTyCYHCU9IHxyYApAf9V2GhG+
8xgyuuL0ASOrCgCesU/SYgy9oiiK4jrd4fzPZCQtT3q4VwsmoPz/2nUEAC1W5zg8tGmBZOQxJgYb
Y9PKS3EAXecQzgavejdrvWskEz/CSzmpTxsAqP0TSPYVdX3Q5HcbVjboCgAQ/86Q/2F9NFj//vA5
3gI6kUaLn+/mWgAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABxklEQVR4nG1SPWhTYRQ9994vL6Rp
Q1OqFZOSTtopOFgFFwdBF4UirgraLoI/4Cy6uFRcUmmtIAjipKCCOCiK6KIFxYKborUpClrQhtKm
re+90+HZJO+Zs13OPefee74PiEOx5cX8TijaQLRrmnzcnjTc59k6y7B23GFeQJWn4dqYpmffqTzn
VKSMdWhwZmA4xCwGwaRQpXvpFtK4xE9ZyH8Tx4Lt4uEUlwaS+6psW6vADIfIPcl1Ddf/9okqyiGP
JUiVgj8Og6JU43k4oMVaeBFjQhC13ygkJxb9KRggsBneidsaJoOSKADFKz6NnaLSH9wVz8zMcw/5
QVpZw8R632ZR4XwG0ohPw/7RmaFCd4cnwVq1iM6e763CClvhl6GbSg0LJz/e+Lq4HkJTmfzxo5Zv
zjRc476mzwFyuPFeKltXXiJlEVK21+cI3D9bCc9lLiMMolaGv1azvY3gpKf2VhpBCvILvAoDVJxL
cyR3xVJRYOKcqy8jp86ilXp/LMe+S6nGJwAguSP5rhOD4b1nq39erwjYeTDnjQ6Fwe33C28wSZI+
SXI/zOFmsx53D+znl7lF69ixuzqNQPHI5j5/q3vZ4i5MbAA9Ra3zm+LrSAAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABkElEQVR4nHWSv0scURSFz3v3zmYX
wXVFEUmwkEBCYBubYGNAthFEbIQUFlqKKFr4DyQQSJMEgk2KtbHbLexCSEQQRPBHYyVkQ4IIYgRF
VFBn5p0UuzOj6+SW83G+O+fygKYRlF4baf5aHyPZXyv4D1R85mErTBoTjPKWQ6lRax4fuxsuQlMW
Kr4yCPnzUYpXsUCfdK7/oVfw8jZwpM+3D7xGWvcZkgy5a5u1giX6JEn6L2Cb2HjMOH/fa/H0LHR1
GHD1XtKIXWdQZ3S8fHKXKt7wuhEkA06YxCt4FfwZZwKrSdLaQo3DOGAYeU/a4yMplvkJphz9LkOO
REcSTHI7qxiLkvTdlwa0eHZ+WYSi65wuSv7OwQAwktngFDwj+Ba3CTkAASB4x0rdPx0v9fkeCghK
rtbd0pbPF/L9fuLdExjLjq2eo+POnAXBvBe1o+vbg6LCtPG5AIPJ8vePHtWqFc8U59joHsraIJ6f
XvQmJ267ipY6XvRih7PIiIiqqnqyeafMDP5WbfKYFB/iMgF//AN9XShx91pEbAAAAABJRU5ErkJg
gg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABvElEQVR4nG2Sz0vVURDFPzPflyiV
RFCZFeULCWoXoki+THlJi2jTwlXQtr8tyCAIIojcCJUIEWWQtegHQRD0Q3zEu3dOi3ufuegsLndm
7pw7nDkA4Jz8rdAAHZqaBjA6B8IoSMxje4rQJeoNY4kM/8LhD8qSIiSFfp4uTfWYmpADZoDl0dnC
W2kXCAhevyns10q2BRAsAYj7o+cFxuxIz0Qd6syOQsq6sqy+pNA0XmmN+ZFsyLc3NmkJMt3dIlxF
EDz/tfUJgbFALkXL+y/jIFbZWUfgzIzLwMGZOSWHhifwAoHlg5doKu0CGcI+voK1KmsXVX2eKUtJ
Kwxz/HuZ++0+DHDO9RRS0i1azkMlSdIUTgtjbjg34Cx3hqx3Fgdys7huQMPd+ngPkh7hYBz6Uvec
+v1+P0uSQj/GMBqW9nhgF1k3adzo1tUO8pRdLAKwofy/zs0GuPCn0EaqqJ/GRZy5oWQQ3Dk62W63
25NHVshgyeaAe0pSaHuiSNlwW0lS0gM49rnIs0bj7u4tJnsKKfR13KdPyEA8hYiISPbuJQGmsRm/
QQDO6sCnzmMEBNfZKhzfDleX09BVse/7v0hBRYoLc/HTAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABrUlEQVR4nG2QO2iUURSE5979FyRR
F5QYND5Qg2CnhWgQBLVJIYgi2PgAQcGksLAI2IUI2cImVdAusgQsLLTVIoRgE1MJamMixEcM7oIK
Gvfeez6L3S3c/z/tMN+ZGaf8OXbM7NrUMzBVoKmkB0SM4QLN62S0GFnZWgCVf0Uk8rjAmOkOESJX
i6AHv2MYv/cWiU9axnm5fNKL/AUC95Tl0lSWlxpgcFylnHFqfZxE4l25G+t1jJEZIoHpHFV6/Wbn
GkbkfDc10yhDZ4kY6/1dVK89G0/1kEDkuXyuoh3QexKBka6XJZ1jTENgRjz8v9Np84ePu7MJIolF
dV461zJWiVgCAtV2VuclL3kdYeHm6H0DjNMt0Tlt3yYnp7lwSLpMIrHa26b21eqNSWW6xW31aJZI
oNam9i6QEtc08OOlvLaskohcaYuTNK3JrGphUGWdIWH83Ncu8gkjMHGBGyqVVSUQmev0CAbGiz/T
8l5aJBEY68yzRIgx8kjeucrwhsWUGOrMc6pO4tdd+UyXMACs8eWovKRs/sT1wbe15ZKZPj9b+bZW
r/T37W9+FZL+Ae4RBdXWCLX3AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACsUlEQVR4nDWSS0hUYRzFz/+734wz
d5xxRp2aGZOUnmomRYZhghhFJFGrogcVREQgtGzbPoMiaRURRYs2QZYEulB7IFppSYW9rIYejjM6
cUdveu/9vn8L7Wx/nLM45wAUCAHxAMqLAECQQfgvSYZ5cNuI7d8U6vu5zsz3VPxeIPASJDRGL9Vm
sytiXsAaXKzKfnv1cM6hJUr1B2e7FAnt+RkEAPPDd15+dJfMZumYzUppVjz3V7PrKW2Pb1uKFbae
CGohSAtPBBYswxAs61vXlksAEgfkfIjJKbzNPVjZVlRdzWLRt6/mQTcACf5pkenZhWNqxr3d2jF0
FEFU//CDGCL0NgYTFB1dM6190886G8GwKDdhMCBWZSIJBiH4KxlQxcnNDOiIO2IoAsSHhesFYsL2
Q3UNxsaG9vWaxIwzlwswIEuOZwyAED6UmuzYKKtA2pvvGiwQAJnKtksQwBsamADA87qf9hT+Fzzg
aWZmT7F2NSvX+n21ORYAAImtn5oJABvKEsVps5zCwTORqbuzv4glWsP5UgOefD4sijeULXoJR/pO
/pkbqHhBQPvFtMOK+49sSbTUrt59fmpcsdZ8IVoJrK3t/8Fa8f0avyADWNP5Js9auXYTSEx/f5wC
CPFEMgot5Bcr6SkS6nMLTGBnW441a3VahImIhHzJihX3bk2cEvV76ksBRX23UoWIaUTpZHxKsNC7
d8yOy8lrPXYIhq4493VvNrNqXfxszgTTkwz7XgOhm6yZlcP5Ozfej+aV4yp2eOxyggRw4l6BlWKt
5+0sa/Y0e3m2uusgIEGOzWFmkAn/36AiPTPedOXFm3dCQ9JQfFfYykSi7Eh/MOslrde9E11pJTRA
Rf7WysOjM2FfumRFunFzZxU9+oJZd/nWKI4itL8MsVQyhHAJ4DOxPNg/HwVPlq8jcpoAAAAASUVO
RK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABx0lEQVR4nG2QzUuUURSHn3Pf950a
QSOy0gzaSAi1KBBapFAQuCgId0GroIWL/ouSiKBNLWoRRSDVpqR2QTuhcNcXCRIh0fSNmiHOvPee
X4sxzXF+m3Ph4dxzzmP3z3hc9hgTWEAxz5YWZ55PLgQHzt++V5NLklKjbD5cH08TADKGldyTFge3
9fQfu7yoGJN0lgyyCn0NuVy1AiMw9FuuUl/3EkIq+ZeABdsydQUnj7tHCQHwVejIU8nDlUwYh1Gg
JeLzHAICbIKQSsB5h7WB27sxL5Yn8RZoVjDYE5O4OBscjN7VUyoEjOq0opYuNAeuwwKzzuMv9P3l
eD8ByNc+pHtalnf1ZT8eTUwJM613/hdX7cYAmWGYeucKmeznqUae7zhwckhmNMYvoZaZYIzOK5ZJ
D/INC221PMvynJEkeV1XW7cFrMIdRbnqw5sNKfEYw1JlrI0+8WYliMDRtnChARh72kDobKrZIN6a
JeNQhxvO24CtKQwhmIXCGUPImSAr2FfK5fpSbUqw60oplnqSQcaIyhhjTLdO7N+56+C5aZWSdLMC
154+m9/oXZJ/unuEYPZ+YHbmWwIgVro6qvFP/deHV6/nCdJfL7cibfZU6ZoAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACD0lEQVR4nE2Ty0uVURTFf/uc76Zc
MxMtH/SQJgU91DKEoOghjWrUHyA0sEnUrHBS1KCgsEFEEQRpTWrkJChpUJCIEHZBGpqUdZGoKI0e
937fOavB1Wt7uvbae+219wYwmj4oqBqlmReXex0OA1zsKkju1khDAL9my5G+nHh6/q0D8PQri9qP
B8DYNq5Mfw4DkHBbqRY2kvPee5946gv6q2JHJfWlSpqs9ADIcVwh1RDgaJlXWcMkSxhG40dlqjTd
1CrHFFoGZd8XgA4HRjfRmKIapvrVGL8dGHuJ7uv7FaajczORAhi8Uknj2LIe5xlVOegYONq+KdW9
ih5z3jsuqhx0CXDsU8x0isTMDIyWYQV9OolBwhllUZ04gFzzgaFinH020IQnAbqRMVY2kOXzNTZ3
9fG04QNmchO9WfLuZo3A5Vt2dtXJfjy4sOAiONoWler+kuvQcTfGoIlGDDwHFTMNUJMkSZJ4c5xV
KGmkouecsqjeKtMlPFEWYjfOiV0EK84Sl8AoHoGsD+dCbgfG7BdXNQ8+g2jHHOu3YhSquwTYAMYi
cmyvFUz+Bxl7wHiDYFCpsu6KP5WLap1Xqpl6DB6qpJm65bKWOO4oTdWPh9pplTVWvS3DrqsUdA0D
On4p1WB1ylVHXyvo52k8kPTkMZKehoDy65p3H2oXxdGhOR8ArihbeQRl889vnFjLUqF/Ekz8/uIm
MksAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABvUlEQVR4nGWSv2uTURSGn3PvSZsh
Fs2Q2qJWbJM0tZWiuOsmuAjSUXEQ3B3EVRAc/RucbUVcHFt0ERWhILTFRFGagjSN+KOk5rvfPQ6m
9Ut81sP7nve8HEB5YIntE7ut909uz4IHwLOUGf5l9+lFRABk1UK6T0i63SSY2UPnQCi2B3QWkyTY
IxSxE4dp39pzBkB+ZHTuXFmNcL0Bnqtmr8kyfOGxWUjfOIQqfPJDvoeq/72ysLCNe+eAGmyk8SBR
SMXr4ivPmpIyBQ3vLeMr5KdgHaHQtHiaAQo/bLesYuMlwtljklW6eOaQtZp4Llk6eKeZBXuOChWi
pNbvKuiXG6JQA9HBnRaLk181UkFa3/tWig0dj4UxIPfR7IrLuQzenepYqKIcHSPWI7Ev7GienS2U
iTztJkh2aNPw+acoZdj8JlkhWA0+4B1VaOD6s7ppWAelAhtZUxEXKMMaqJuE+kHtgqUWS/fKUeoY
pZbZXNbSz9/fshB/FRE9eYTk/ETvR3RkfGZ+Fro5udt2kWv/1R73EuvcxIHOYP8KMIs4HWb5zluf
As8sDCi3Fy/3/l0rmRtjZ2dz9eWLJiIpwB8scx5CSLhKNwAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACX0lEQVR4nGWSWUiVURDHf3PO95na
7V63ut40UgxyabENlZI2KqUoI4qKQh+SooWgh6DIMNsgQvJJAgPbiCKIeuihB4k2coEoKigiQULb
TMKSutv08N0bQfN0ODP/M//zmwEQDGDxQgQjiSOIOtGpc3s/ONHcjpGeB88RRTRRisPqb/q5HvF1
qF4L1RAK4Gmt1L3dflNVtSkV23Cytr0k9OqRK+LJzqrGwgf6VYtSLGQeaqnu0Q4xALL2SzgyVkNh
W9e5zuMBC1Axpuux4GhNTsSGJa1/v2TFIr/y60ZzbnVXHlxwSwBOxSNx1dZiRwDcnBc63AyZntc6
jWpUL6RYEQFLs6puS34kc1hjGtdyj4LDrvePj85qCCJYLBc1Etcf08RLurWjQ33fB/1iqEbKN/2M
h2NXPRxC7nuNqy7CQgEsm/0yHtVPjUGAqsXsVx1ci/F6zOt7Xfb7RdZA9M7xpu4rDm3FX9qH3IjH
vav18Lsdqzb7fBumfdSvu/OCkDYlOaG3T2eeIMDKVJh14v6ovlySwqXTxgBQe55xtiQDrACBI6oP
ayfcXYEBinfk+i2XlxsLxlq4rqo3AqkCcOYNMi+4b09iE1xT3/NMtccagCdbYbxPshPjxaSTsbB3
p9dzIWUVeQiIESCFxnv5Sey4c351Vjqezgrkd6+eEPAYwPxjY35KA8iMNSFIXzdQh+92codSJ5UG
pzeUYNMqeu8W1msnbuWVtISB7Mn+e0sL0sGwV1vdLRMlr9wm3c1t2VjkAhhTFBvOBBz+D5FxvSPV
1gGRv3fGn+O9YqiqMvJv/R8OCcgDk9+/qwAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABtklEQVR4nF2SMWhUQRCG/9n3IBEV
jFoZJYegIEg0tiIGK00ldgERrO0ECxHSiFrYXpfKxt7CCypEkoAoiE1ELuYOUhiDd+EZlVzu8nbm
t3ib3L7bav79dmdn/h3xPs/zvLP1O9tsNdZ+tLuAiCgAQIho7f7daC59rGcQIQGQZmammu96NZL0
jdlrAhEAjJZ6r94buT1/9TAkgv/qO0ZTo6ka2w9Oxjfnhis3qitBeNt6OhTB1wBwZsYXyvjhDtx+
pSIukdXZmT+hi9OXI0ia0mUvtsPZkdEIAoBDOpYUoWXrcVqXOkvPV0fCuW+1gYIuPmnuyYXpJIKL
l+6/+klqod5PQpDupz04fuvCIe5ZPXFbl6SUduzeAmlBv7kepa05AU7cbeaFCeoXR0s3XeKGzi33
wsba41Kfpswbz74HdXSqbAJoNt8K8XBlABZ/HMIkjQFE6KZPBdlZ6UNxBuL4zUfHigeQ1fqQ5o6c
vTI1GZR0vz7vt9J+9/lXL3hg3novJ8oDRlMlzXuy9bCCyD7NvWoxfLZZHT8gMjDUAID2l7dzdQqI
lDQr5pra7WTrq5+WN3aQkAT+Ax10ihg6FUAEAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACB0lEQVR4nFWRTUiUURSGn3vvGYvS
lLKc0REN+7EEhcAgJZOIAjctXBQk7fqHFoKraBm0btHaTUELMaI2FUFQYQX2Y6EQYs40RP40Wjrq
ON89LWa+T3p3l+fc8768xwAYrX3QkUvNLfwtiKA+mxr/Mu2tAuDoLuRWdENe/7w4awlVUV1+atXn
73Qkq6ribWfurajel4haDuR0iOK4ofOX6q2QmRiXVK9SZoyxVsroVz8dftWAdvxHAgXFO96hNZGr
t0dIfcaH7xrsrI0smxsYWyrFx3IURsJB4ZzqAAJgbIxEWhfaQ+i4q3qcMidiMZQ/0kIfGxrVTAUG
YGtrf1onTuBKaa3f28RXadmRrGts2p+UiWuDORtEW3s1WM0Xywt0bDfiIKroGPpjPD2TXdLy+q7D
n64PusjQ8Ebn40VLMKdn9CIhtTT+1uc4cSIiTjip+c5Szzh6VG9HHsbaVzqMDa/QDa/RsGjrv9FR
64sw4BCLoxFE2cSuquJeq/E2xjIRNIHsY22tCA0t1XxAIkhzK+OpEHbBy42tjr4YT9alNPlYl/eE
0W2M5qzO1mMxIjEqf+pbKzEREWcMifeqV0olOHpVh6JG6i5/V72BAxPracgnLiR88Gxkft1tqU4e
bNnM5MCw9cBNLej/yjw8vw1rAHlat5zOzOn2+M7KCreymJ2amlzAuADgH2hE5W26Y2hSAAAAAElF
TkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB70lEQVR4nFWSz0tUURTHP+fcN5OJ
C8sGKSqSflg6RhhChLsgo02LILCE6D+Q1rpxlbSuVYsW1SJoUUMFLUqhiIpSSsgklaFfVjoRpOm8
9+5pMe+9sbO6nO+593zP51wBsdy7dq/Uwogqldmx0gxigLLzr3n7PyqjzQjg6LM4yUV2v/dk/9C9
ZbNXzQIEDFqYiKENAtB+NbK7CjiuW5SI3o67vAsUzq3aGUDkZSp6W9mBAprnsj0ApfAz9RPbVA4B
cLq/uqjAri0m6RwfQmcA3peXWhShiM+GnCCpQ92KInRhSUJ4m56ksGlGiSmm1eaq08krzg4FDxEa
yimD2ObyklNBApHn1W6UjrXUbGSlWjvQK3YTAk5lCEIbpWP4iLCx75l9bRMChjN4kfVzy6pvSu/N
fvTicNzJRB8eZKBWNrkHJYiDfSS79Lowz40/p1vnunuafjkPbFuu+3mMCEDLa7uEQ9nbWIc3iZpz
ml+6aH0So3QSr+MjxLEPZaJaUEQpkoJ1TNX4CK35hRiUrgw1ix9rlJ2dkHGcsflz3c9TEUE0R2He
H0WhJx3SQrsWbFABto/ZbRxwft3PGwBo6Bz6YtNbRSE4nC1TuXAsn2tq253jxdlv6oHx7GYW5ZHG
GrTgQN0s8drq70+zTx59Rz3APzSXU3oOjqFlAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABfElEQVR4nHVSPUtcURScc+9d8SMJ
LgtWBoRYb0hjAlpoWn+ClVW6dEKalCnyJyJYCgYkCylMY5pNEQTdxoUFq6yEIFgsu6v3nTMW7728
5e3zdMNw554zM0KUhuNh/+pnqysgWDXGwf4SXBVpmqiyt4Lql6Td8Ruk+JMAoOIzJOONUGwiABBA
SZHNvslJ9afv6wq/uL0bcqFGThI3FyEB/PHtnvpUaOAmVL33PuAw1Ye7axck4JxA8TwFEaft/JTI
IwRA8LJLJZPIf83/p5jrHc2bPF19PQNQKJc7Z9MOmZIcd/aewU04ZDHGGBMj7493FgDvJhyiZluB
96O/vw9+mEx7q1kuJ8ulhYCFtSYA0hDOt0qnQPCBlsXyqSC/Yq5WCwHuF5NUuDPpkJkRs3adhid4
UURGqAJu/GoTWaSak4JGs66QJ+vvFtNEKX2Zbl+Wivov5ZoYvWQovn2kYJYk/FjVPtNEzfgZFfaR
JEetdTiE8j42HP7ptb936Q0PIIR7/ir4tTsAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB/klEQVR4nF2SzUtUYRSHf/djHHBi
LCqKYVoISUmfBC0EV0GQWZSVgRYuWrVpEUH0B7Rp2aYWBeWitmpZkGkUBOGmRUmSm/wqRVKpLGfm
vvc8Le6dG3Q2L7w/znMeDsdTWrlSsdBYKDYVm0pN4frKl/F3FT+NPD2h4gCIJqZWAZvsUFZt7ddw
cRzxVoFuUjWqx7Iw0B0cRFxXg0Zx1BhWxt00S4xR3SvtrmAYH+tDfbXvMF+m8YlQHfnYE1r0M26X
kKQheTohSeh1Rt04h2HUdkk7qxgxS+VMp4sYHG+U0xWcRTG9/1wfEoHjqvIapepYuyg/c13AMP60
Si1rmA23KvifOqbi4X6qj9ukQArT+GziOvagJ0Te5HsvcJnr1q8YxtqBy+f2z+KY3lOfqEDdOHCM
KNRxYqvxSp7q+ZnkGVJe3TIv1MEyfkrdvIRh/G6WNqQrbkn7AvUkri+UUycGxkpZvnxJ6FTiOiBP
JxVLaHk1+fK07TuG8aNZKkwnkMGM2pu4PlNOR4mBiD4FqW3qOiBfp4Vk4dSQLKGWEuqvslT4TAwR
F5LN+nn1JdSnatARYqjRL69+IIPUDMcl5XWbKK4x0pCGh27c+okRs9zcmMtN4oz7jfXGBYzK/GLE
o7sszBt8Oi8/zcJ7Wz7MfJvJ7et8Pjdf2s7iy5H1wEjCv+WXTOwdpcb2AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACW0lEQVR4nG1TTUhUYRQ993t/DjMv
x9GZ0skMNXCMhjTMH5LANkGtskURWQQFhYsWtYtatGnXyk1UUKsWLcQgKs0oxCyk0EKirHQGmdJQ
Z7SZ5r33fbfFqAl5VhcO53Du4V6gAAGDjCYbW0Ja1ILQAABU4IgDdXZDtjY63jGwHHw/sqTIWyGJ
jd3t7dtrpc9UnjkRErfePFcuc0FXWtX7kXMuK1eqPLs8P3P+4IpnsLblmetIz1ueYzeppFIeZ+6c
BOkQqix+5oBQrE2RnZrzDTdAN127VbkPdCAUOX5IsnD6rZdvv/4uKY9HurytMvbnZiksf+tjpaT6
dr2lEgQTlYFN+7rG5scvhiO6S3vbCFn0DC6mSLBDScLwmD88OpQhkD3CipeGaiAK+YgE7PLYTo1I
56PVAJyHWaCwF4OxnE0BgLBTCdCngd4UFNbAkgQAYcaDgC3mV4tcpRUAUceAE/2S0Rn/QXzORGBO
ZoIebUCKrinAXCg2N1Jagz5g89kKZ71yZRa/7qbhWSK+PhCxKCIAIptOQmBbdaPS19w4ZLWVQQAC
h5Ms+ft9P4iICCAqLjt2oxMCIHS/kCw521cDTQOEYUaaLizyeHNFMaCh+12aOZftv3rqiBWKGeee
PsmzUrOdJQTiYGePNAwGMvd+NE7uioUCGvLTucsDAOATl37O5tjjjMtScTrPkhO3TxdFCAA0f0f4
yp9qneERlAG5MPHh0SuXC6dpONFrc817OGA4bE3y9EzfaIJ4rQtVr8JVDfrEicRw/eshTAvGvz4J
IAFrx/4qVAlQ4R3+AvRIAkjLR9cFAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB0ElEQVR4nG2SP2iTQRyGn7v7Ummx
BtS0aFtFdHDoVJRqwEGDQeji5Oamizg4FFzs5ubkIE4dCq4iNIOIOgiKIKioixIkERrBf21KIiH9
7u51+BJNsO94zz3H+/txBgBrAjOl00f37x41W82vjS/Vaq2xCQDOMH9vXVFS+9dGV5LU/r6cMQor
QTFV/UZxamd+5sydlrzX04zN1+TTVMvjGADLXF1dVQBH6bdSBd3CJM4YY1yO4+2oCljmmvLyeoy1
9JLjtrQKjL2RV5RO4voMxympAlxXKnk95K8HhsmGVrH5S9np/axMP+sdEpLyEVnk4gv0D4l0cfoz
rMhLQfX8sAlAMosB8XNz0AScUUgOZEYHG4dgAOyuDA5rvfT7j2yHbROBYczp/0J2LYOThe2efY/A
aOLgNqPYJ1ggcm5wfQDWGfbUFKWgDyPDanb1plJJQZdJBljC0jVgoqEgRX07TK6PTI7zQXdxXJCP
UtC7KZwzgE0c5abqs+BYkg9SUL2MwVjAXO1o4wSAY1HyQSGGysJeg52++FJaK2YdHKVPitFveenH
q2evm4p6sK//axzjV95KUgiSolqVsxhLbzanuKO4cOxQYbTbalSfP/qIJcIfVF/x5k8axasAAAAA
SUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABj0lEQVR4nHXSP2hTURTH8e85J5Gk
ItUWxSCWKg2aQSwoFeoSRBGcXBUHIYggLo5OxUmE6ihtnUXESRcHcaiL4FQo/aMoCmJd0oIiaWPy
3s/hiSi+d9bP/Z17+XENACwSVU+emmjUjGRt5dWzRUKpZebJ4NXLh432ykYyNHxwO/M3X3uWC7bd
+CK1704MADB4duaHHu8EwKm9UKIHNQyLMDD23tNSAwiOfVLSuYRFmAFmEcbkm9Pg1NfU3zxH6fcl
2bYAMIYW1FWLMv9OuBPMaksPCfLmRD/Vtzqei0/V1VxBcHxLqZoFOKWePlaxPPNJxOKmKxcbwGp+
EN8DbBRhALk7Ae8AuwrYvwLDRckl4ChpPs7jHDqg/PZG2+rpekFD3FdXy/9VFNnpkXX91C3Kf6v/
+VwX1O+nF/FwAzArhdG8U8EguNJTL50qY1iUHIx9c/qwHweC5lslWr42Vgbw3eef9NLbFQwDIhlo
tY44ev/5u3aMjHnn0fSqS9kjQ2nl+Jnx+mgVOu8Wnr9cJ1LBL83ujbgVaJuAAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABvUlEQVR4nHXTTWtTQRTG8f+ZuSlF
MQWV2IXSCjaKtoiLVgsqguAXEMQ33LkQ3Aqu9Tu4EF33C4jgSmwrKEIXxRRt60uLSBM1VirBm3tn
Hhe3Yozp2f5mzsw5c8YAcER2Tpw+NlTZUcrWPy+/nH0V8AEAD+P3ViVJipKkMHe7gitseEpSlmaF
Z2lb0trlIueFhvJUkn416431ICm2M+lWgg/X75OV/Mqz56/XfqS2bffQxLnJUh5sA4z52NbM+e10
xOQj6SoYA3XpDuAT78zMnE8M7t4kwXE0Kh6izzp3egOHc1SNZoNMnRjkXSSBI/Cxaf8YEAAnRuFt
UXB3uGBVqGE9kV1DUKM76ybuLxOXtsKD0FjdCg/D+5//XfYvvsH3MlwyArWeBG5wLyz0PhI3UiZ/
142u6EkyCqsffOwQMwuba8aIsRyUeOeK50oUw5mHmAFzIdPypf7OnJMPMt3Ag82czL2x+GR26Usr
7RsYrB4/NUaIpeqSiwwvKstySdr4Vv/akqQ8laYqZsC+p5LaabsY2DxNJS1c/NMirk0XAxsL//74
Sj/OAMNFGD974sCecim0mp/mX0yvsPkVfgP+NOfXT/brxgAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACI0lEQVR4nGWRT0iUURTFz73v+wYt
LDTF/BNiGTkpEVKYUItSQqwIiiSCLAohgiAIkoKCFm3LhQ4qBDZEYUS1S5KIKIgWEZhgItiUkw3m
pJWkznzfOy10pinP5j3uj8M79zwgLdHFIzsAcUzG3AgAuIf7ysPDIx/bXUiaGYEIVuZlR1jXQ89y
8NJWZwkblO4LGJyI4tQ55DbefjdtOeRAF1lDlA9d1EaqoRAYdJB9x1qggEFTggkeh1GogbgonfHZ
saWxAqp+ea/rK4qOlFixPugh1q8YH+mpAwzuMkmftfdakcqv9b01IRYC2G4tfS9eEMxL5ReBoHob
BOik589/i21aTAcAgjOhEgiAoklay/i1VX8hkBOAGkCa9rZ7ZZXjT4VYJmdo5lDNfPR7/lQmTd1f
cHZglrwTyKgzrZf8FMz/2q9mOQIe0fPb6zcv96kjuMmk5XT4oPsfFQFw9Enc8zwOu/96HRR0tyFY
WLz7B3lyw/oMqorqGLv0Q3xi+v6X0cnBs+lqRWF33ijELygqvLmpmSlOli1Rg+bLuMLfbIMgq5uj
YdpkFVSM4yhywjyNt2QjAMGesQneyhYpzYJgNYo/k81r514LAFFzYZbvO2vxIHL1/MXK/QhxgQdq
glh6pew52eq+ou/z8a7cLnocXpH6pgB2DMy1bKSfSCYYAtqeXS9Jh4cqiivWvFkg56MjDSlPanGF
BUzVOi8W+ekmDNS3wB+vCOI88kqphAAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB4UlEQVR4nG3SzUuUURTH8e+59xmF
zEVUSBEpiC2kFzSIwqAX0KBFi4hw0aZF5C43VhD9Cy0iiGrVpoiEaZKggUQ3QRgWBC2DJgQhc+jN
9JnnuffXQsfU6be5iw8HzrnnGAA4IjsHjuzf1br5d3Xu7eTrWRwRAHPY8afz+pdvDw4bDsA8Pa+i
lKdpkBSWn+ddK3XXlpTnWZQU0iApZlnQzyHD1Hz3YsTk9GZs+svCpm0H+vtbIjEpY+YeqhZj0ETf
cnMYXfeCMhVx3FCmGPKbHpd455xPvHGqIpXg4IJi1OI5Ek89PqHjnYpwX5mChimwNgkd1Rd0zyoE
vcRsHVJgaJwR5cp1Br/eMJoGGVXI9bFt+Ts2sGvHxMxX1ICY24OJOSWNKDmBYf8rxNwnBG1JsEbD
VZCxYysNaNriPiAfuw81oFPnVXp/KAaV2aBmjE7CI9UUdYmmtWoJwyrCsVQxKj1L4lfZJ5xf0jMc
I8pijH+uN6+uzBlXFoNKmHFHWYi5pk64+gw9JYVcRcMo3L4cQV7TY1OVXy3be0+fLASLSRkwx+C8
8iwLksLS6oHNXwAwT+dYkEItzSWFtBak2pP2+sRG3+O5NUc9c2sv5la6d0TaBo7u293aklU/vx+f
+I5X/AscMhvKjpeUTwAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABjUlEQVR4nHWSPWiTURSGn3PuTasE
tESiCdJO0qFpdLNDBUWc6qhzB4cubTcrqJujCNKli0s3oYPSrSBWsCJoLYjQTcUfBGtqUKv4A/le
h1yixi/vdO99znvOy+EaHQVlMDBS318eaD58/Kp0Y6iD3GHw/IMdtdV88lq3OzbjxPIvbd+aPjZS
KdUXskyNWrIFhpcy3T+7O925Ls2kszH3Vc8nMAsxuFkfx/V0V6rbuyQtFAnB0hCmNEUEnMFnal3A
w590TC5GDIx9G9Is0fhHBhh9d6X5bmbBgMglab1gXb6k2hdpgpDLWJRW8HxW/SBN9jLOSFsHyZ/o
p2DznSsfjsJGDyNezXiZj8CjaPZ0NgL9PZ1voEJ+HnwVxv9/TUup72h7qGtD3slwVZqn8HekSO3e
aLu++Eitc4SYfoGFyOH3Hys44JTX9PNKP4aFGA3j9JZm07ad4rUfejE3XACgcPSmdLHd1MAsOzJ9
pkRj89NnP1Cvsn75jmcJYt6ifHJ87NCeyLe3q8tr30MLgN/dqYOkXkGnTgAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAByklEQVR4nFWSP2hUQRDGf7v7wl2C
RhIIBsTTFJorYhSsgnaSxkbtFcTC1kbinyJiJWoKBTsbCTZyiAhWVkpIkRPxJMqhFgqSqFxMjFHE
vNv9LG7fe950w2++2flm1hDDeZLDRw/tGAwra80nc1+wIUPG0XumrjyWrvbiIrMw+VoKqf95bWZ2
fkPSwt5IHeU7UturrXmA0all6etE1A0/l/eSUt1OShbYfk9qjQCW6julkqS2TpGATeC6NAuWoQ+R
BfkxLIB11NTCuNLTyOT1qYzpPGWG7p/GMa3NaCDV444wd7hz3YccXiEprDurqX6Z3G4dZVDeM7Ac
fBQGbVS6255Q1lRtNZz5n9ljhCJr+C6hHScvFgt0KytF7tQo5gEgzc8U1NpWVBoLNs3LAovrBVMA
u5p3Eq9wypgZ68E2lUFTrMBSqi1OwiXlO9gcjStwuAda2QWVHyHEk7zvnMQkbH0kncTBjfzQD3Fg
EhivSxdwYLc0OzTV5Z6yM9B3fk2/z+IAS/Wj0iD5cBBg97m30ssJHGBwfk9tPwo23P3mBvYd6Of7
zVt/nc/m7ru4VPznN9MjxKkNYAPDR45XBwf+rH5+8WzuFy50/P4D7Tospy21mPcAAAAASUVORK5C
YII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABy0lEQVR4nF2SO2iUURCFz8y9a5I1
iiBx10LQBNFCWNj4KqwWYqmFoKCljWBhJZaCoMZXqi20srKOjSAWNjEQMEkhCBIxSRlBIsEsIbnz
sNj/v+zuVMN8d2bO4Q4BALFi5Oyl5vhYdbSyu7WxtjT3dYfYAIAZxx//EO8JXXl6AgSAMfyo42Yq
aubuRdK5TwCjPu+a1PtCk/iDyFb72EgxIocTAOYUxqLjTSNVyroSE8GMGQSLfuOqlkxDBBzEDDeA
It0DZbY1+/nnXzt4rDF1Ie4BaO25FRr8XT0/bM6qP8e0S8lmQCEyM4fIhFv+Cp9cC7YQibPkEHH9
IVaLqeI30eMHYK7iX3eo+eY4GH0UyBt/VbKajHfKTBJ8EP4pS0P7BzqJS0ioneyHRMbfCijDrT5B
wWuXcTv7XD+SvRBHjHxpo/47G/1QBYUYYwxEOLfs00DbU+lmeSoUMyff7oq/IEwsHvKuEmN8n1/Z
1MOnLp4JJvteIuCOp/Jf8q2YmPgz1vB6Jqp1TZOJiIgYBQgCQIQnbgMHpkm9cw0ABVxZdXOV7mWa
qLnb+9NdVwEH7i6m3sa1dhPEXZ3BPEy2zk8cHR1K2xvrS3ML22DYf7RNVS2SbRWWAAAAAElFTkSu
QmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABp0lEQVR4nGWQT4hNURzHv+fc698r
M1akaSJKvIVJRiaRndU0ymJWpCxYUpISoRRqFhNZK2yUJk1ZzVK8haRmQcoIibweajKeuffc87E4
97w7c+duP/dzvt/vT6o+k0hqDI3u08Dk3GLn+hIka7Vh/NHcIveGv+DxHK9YorUXv1PwedOuDrkn
48YStuMV3v3jmqbJgILTFRtpkxeehcE9HsDT2dZjB36Rg2NKl8i8dxlXYxc1v+EAz5guk4NnQiZs
0Lo3OKBgNtVgyxV/nh+VjY/eIgfIOa9E6fbhASNrykdHsrJEe6uMMZJs0kucxgE47iuRZK2tVhym
IJiHFI0efBzFlsqKvZNq9198gGdWineC6Pm6eYW4pR3Fu0rr4pWwEdgruxxq/afQ1TEjY2rwVEik
4ES9jtQKYsHHftXF0bAfx816HelB3JE1Qx2bVv+8jzumZCSTLovtUp71mFalVkb9Y+caMXy+rPpu
jYxR3/izLk/TCGfIvMdxVn3Nk0+6tG/vrEof/BlC387Ow++HR1arOoXR0IX9Gxt0ix8fXr54vSCl
FFH8D8qIMj/yIV5kAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACmUlEQVR4nD2RS2tTURSF1z7n3Juk
eZortlprlVaw0oEKKgVfrYhUcCAKDoQ6ERw48g+IA0HszIkgiODEiaIURfCB+MLWJ4qPVo22VNFo
+jBpGpN779nbgYlr+rFg728BiEaRSiGbJiACECk0QnDaBmwu7CnebekaGd74vEwBKduAG7oGIzlv
YWz+/YwXSY1UJ4Y+UpUYAChzKn4gNGwNQQgInnU8e/hmZJYEAOJ9ebE2ZAnKVqwVEf/X5SN9AAAT
/tYgEvGDuF9Mh2GanWxn952XFZ/E4FA57WD818sfU0ujY3u91sWsV8jqg9e+AKb2rtcR+VQ56kNt
n7420JdIcVJ6RzdNuhW0brldkbnC6Sw5CiBsG/gplsWeyHow2gtiHEt8maEAWsS5b/p3mSarO4oA
0HNSWGoXsqD6422nLom1U+sBhd2KSdz2SF2ZEBfjIOsd86IqNbdFScCPfmip48r95UVy5tzjVVW6
uQ7ilirghu7ZRbkqJD4+lFLNOwtM8Meyzv8xxoNmger+s0b9bGcWPN6Z9P/DSBsgtdzmRypyOW9U
OaNm6tfCRJvnAXa8t6xaFwGIbnPdek0F3fvXAqb2uQw1NTEJqzA2rUAAaUlnDAH4PTgcU6XuUatV
bc8qJpCCmM59uzXT8JUDtT9mwRqtJYw8HUOTW1LJra8HDrNiUPkBlKldvQg4frZ/WaFilmS6BjuY
rM6/uPWEGO72orCEZcmd//qtUJ6tCdtAHvQnACB+9rMvliWcKzFzKBJa+XCuXSsAZn50q2YlohNc
jTLJbHr+1dCV72QBmJZ7O1bShLOQg6bYtM7k3ySv3/he+GeaYhujK3c9TOp8C1q7zvS+el94odk2
FnJB6OlE85I4UgkkPChqSP4LWLY5ylFX9YgAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABlklEQVR4nG3Sz4vNURjH8fdzzndi
kjsiw5BMaVY2UooN0diyk8lyyobyXygpTYOFjYXV1CQyioWy1JXcDTUsmDHR6F41Ysade358LO69
Sfd8Vqdez3OezumxxhF+dkLChkeq2FlbXVmpN96DTwBXbz9VN+31jc3uoX6thqeblznkkF+M7d41
dvjiY0nS4iQe8FvdQwUFzfRKp36nGBQv4YGKRwoKumtDZq6qOBdTjjmexjv6kSTlGIeezLrss79f
0z/sJ7nrP7x8HL+SBzFba56E0+Xtg4jZAg7H+GQBk97+ciJzpoDQXEYYRwsoS98RxsFSp6OFMEZK
aAQAhosze7/+p4SZGoZolt6ZbS+G+FS8dtt+DPGq1MnEqMCnZwV0nHLJkhr1Ama7gIHNpkH0+eQJ
+eRfz7kBdNhNlPz6dKBCZr0WZ2YWmTmWVIWpdz7ht7CgqKAH3ZIdd7QpfT3b3803sRNDaE0f2Dlx
/sYXSe17+/CA3Ro9dPy/oa2Pz+cXuxtvq3uWPzQ3kqHsQ3vt2+elJXASwF8NEcfJDH6trQAAAABJ
RU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAByklEQVR4nFWSPWhTYRiFn+/9ri3G
P6RxsYiKRWmaWg0oiIODg4qDIEVQFBzdxE2L4iBOgmRyEYXMbg6aTcRBHaoOVopKGkTIILSitMlN
7v2Og03uzVkf3nMOnBfAc1GpBur9fHa1iHcQAY4ZkpEP1zcIYNP0pdnZH/ee4gRgPFdHVTzruqVU
tcg5wFFoqKtrjHrvvfeR54HaeowBxkRXQcew9UOjsKhYFwA855VoeQzXt424oVjvPBBxRx29JYPG
/raCThkEysAXIvWhWGqScMZwwWYwPpNJ1lsAKoZj10488yijjhVgr+EobQn2tzEMfwPbDMckPb62
8hACUDACh4FvaZSDYiuwZgSmMT4NHf6HK2aMj+P4mPd0gT1Awxz7iiFabQxHbp7AsWgwSUKzOVz2
QBHPK4MjwPfE56Bxwnru1xsLlID5vCcpZxH1Fuxoqadz2dJglNtKdRKoKFV7ajAmEPFIsV7g4Ip6
WhrN9sIz9UchPopBVbHqOWZEr9XRHB54qY7uZ5HeU1VbTzBge0NdXR48l7Gxpq5q3jmgnEhxKetz
/L1CfBNzQFTxwdZ2F72AkbGDpw+xWr+74IMAHipRTsv12yX6Df4B+BbUoSK5p6EAAAAASUVORK5C
YII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABpElEQVR4nG2SwWoTYRSFv3v/P7UQ
TYljXSg12iY0QdGVqyL4Cu50KyqIuHTh2mfozkcQxAcQdKOCiyyKxEk0KV2MqQiiUnCcmf+6CMaZ
tGf7ce4953IBz0PLbK7s287zx1seHIBnuwzNzCz0HzVRQHlpeZiryNM0M7O9G4CwNLZiwZlnmdld
QawVH+NmLAaAP35y4+rWGSy4KTium32vU1bz9tDy8Ao898x2nHOqqqrOOe+g0Q+27YEefCpcUXKK
+1kIH5RAF2KkMjdfbcNAJfh1GFQQwtoKv8YqnD4LI6wMlTYkiQoX6hzsViH0YJKp0IFkvwptlkOh
B+PCVWCgAx9Ro3corNjKORiihW4cFTYim6BEazCsrhTayvQLSusE6WQRdmHyW5U2TJMjmsSo0oXd
VKthtQMD0Hmj/+ephXAeYvDShpH7V1OwEAJ3Vsk/E4j2za5V9q3ff2dF/rWO+FaEXW7MnLbciDav
XFqmCLX3Bxq4dei5LE3Nnp1SwV/ECPODW0BqS+w9eYoYvLB80fj2QRMVwG+WatifH8nozes+zD7q
L/xF/QrO7CJoAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACM0lEQVR4nGWTS4jOURjGf+ec//eN
ic+4jShyKRGzMkOmkNgwrgtRyhASk4UoKxulXHc2RixRyqWURJSMLAzJLbnfqXEfzMx3Lo/F/2OS
Z3NO/eo5T8/7Hsj4T65ymsZX75sahhW6O392V9cO7dfTce/qbQwCYM66G/pX6foysAAs0Nvovfe+
7L33Ifgg6dyInC7seqokKSn4qBAlRa/HY7DAvIqXvuSXKEll3S1Ziy3dPkMkmta65tWzGtY/sQko
+Lo9ycDijqdKUReLefpBlxQkpRDqcLY8ZCxG9C+5QuZs4fOShy6BkVuFsUYRDO5b8iEmn3WujQgs
iwqRpjzOj0p4HK25cZqMFc87geqBf7ozxzBANI1Yxf5FSHYAJmeqJwEwmayPG5yiC5T+1l6bAAyj
sQ/OYx0F+6bStWi3Agw1hqFsPrlr6Ysd1lSetFVXVE6KajesaAMY0DtMw5AzUgjpAvbj8b7j4Guh
lxar97V8c9HcggkLrv04PLMXZWZp2/eWgUfl66FFku4e2tgvZzbjsvRrJc3zMewP5eSlX4NMwWUO
2Kqe9LirFQxsU5CC75map6ndrZikoJ3WkXUAuFhcc2f91/HPTt8cmSyQNHe7JfuUF6769klQflIT
LRCdPYiB6TGmIEnqeRe04VQKKQSFTVhgYpek9Palj9py/8PxBiVJbTNyv+F+7d6zmn1A3Y+aDi++
wpH4+sSSP0tf1cTgPstpbJ5SxaziKFOaVvP3Q/wGxmxGhtoL1DUAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABjklEQVR4nG2Tv0vVURjGn/ecr14F
jYY2bShccgjHWsTRIWhwU2gTLGgKXKzJP8AGwbGgtbaWMKSEaChCFw0kI72hN0SuN/DXed/3afhe
7/12vz7TC5/zHDjP+xwhAMDPz+p/qhvrX3cMEYamWJCz8enprYAY/oeeUkrqdJ6+HYsIJaermqob
X99AlBZ0VhdXNk9IU6caD6ZE5AIaP6KSDT96f051UhPnItpwFb0QkdF36k6acj4rOnskZCFgcp9G
euJjKV4LALEboz9pJBNHOiHQjfs1Oun8lpUgevCSTtJ45yKLthJe/BYCATNlSHyvgwBwuwy9q9bI
p5tlKIA077gE6rW+fNouw8jxwdy7VoICTF51ARxLne+UCp55HsLnjhAkduFhg0bSdLgYfMhiQP/z
RCNdOY3CyioQ9D3YYspXNhdRcF65fm/hF93yZT8JQKsmh8s//tJpRlfj3gTaNcllyVzVzV4NFAtG
elJVdTqP39yVS6pJZ/3D7JC0Sp01j5ydHtWqG2tfdln4Dv8Aos59R9xQItIAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB3ElEQVR4nFWSwUtUURTGf/fcO8qk
wxRJkVNgWWYFY9CiAUNoE7PLFq1iVu1aFvQfyGxcSdAmohYVLVpHOIirgjAsNIUJS7PQLKZGzdHJ
906Ld9/0Oqt37o/zfd879xrABpeepVdrGxtN0eb21np1bvYnogqA5criWqiJWn5YQAy+XGf/tDZG
Cr25nnzxVqWpeq8DT40xjOsL3xryFdWJPfGk0LWqZdpFRKwT5JHqWAwtQ6pXsbEL2aqu54VYiZ23
qIe7rn6XTMlDpcCHzy1IyOQfBiNoAjnN/I5tQeXjd455yNETvCZZm9tkY3iqk+n/oLOEMTzP2hxh
AmbS1MX75/m0YlqWGHL7WBYAE3YMMIWQgD0pFiJIXzfvMAlVhqAi0fLOpoKphKUJuMCPCb+8O7qU
TUwKA019HvmEnGO2LpqApRQP/Gf3Ny3jEnEOftGXxqteVL3cuhJwjKoORweO27rZ9+9PHIO/dcz3
lqc6I608jkNVHU9FvSH9Xh/Hg9aRe6WTBxDAuDaON/QmbSJinTEMLun9tljHckO1GOfpf6Ir1zEC
4NLFwydLUFxsBO17e/PDZxqj5ZoNo22N6G7iNdcr1zIY6zXdZNfM/Ob+I7luU/v19c3CFlgNfO6/
oaC+nl/Y6/IAAAAASUVORK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABzUlEQVR4nE2Sz4tNcRjGP+/3e86I
y5UfC0UNjTHElYWywCQZhaWNZiVlO7G1YOE/0FjNNEkJCyVJ15L8uBak2zQxzcTCEGnuNTMM7jnn
sTjne653dTpPz/M+3+d5AWPtF2UqprM49/rW8Co8ADj2lFCY5ikcAJ4zSoufmZ5dv/cmkTSScyOu
qlOAiY5CtH8slYbxgOO+kkBcHogj4MS8WlsNIHoXZFPN9mDmYg61dRNw9C4Fs4ke5kZizmtxl8Po
q2SWGxfNHEz8+KvVpx1GjSzHMJoIQKYxBh1QI4zXZA6S8SLdjRnPg9lUn6pYoVH9+tehan+RBmJm
walQ+bkcO0f/Bv7zY2HFmsqSMwZcWi59G0Bj3foPDmoEpUhT4dvY7houY29XtT0dXmUM8RhWTIfw
EjXCRrP4/a/Njk29XeaUoqJjndzxYA6GyitINEIOWuQbOgxcKMtMdaS4jphLeuIdjAcw08KW0Mnx
P7/34eFlN7xJB+A8x1q6goeNn7tl3sWb93D2h257b3AgKY9Sl6MY6JuQ6j0YcK68vFQHoTI42pIm
VubLR1VSdefGo1lJ7YsUPT0tmcV8u7YNl8cS7eyWRGf++0y9/hFf1PQPr8dM5vs+/akAAAAASUVO
RK5CYII=
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABWklEQVR4nHWTu0qDQRCFz+ySLIqI
hRbBwghWdgqCiKVvIIKlEAQfwGcQH0Ht7H2ARBEUm4AgVqKkEUSTJhIvwVx2Ziz2zx+TjdPs7nyc
ZWfmLCkGovvdrD5eF1/JMACNQ/T9JA8zAoqwZ9HGJuxIpap0VbdgUyjMzMySHL3W52OlT3BXj0Dh
tUrNZ6vAWM4pKGTqy+jdco5x59xEfr+hQcu6l8IiLAAYrH4E6vXU9KonEBERXPkAEhKLKVQkReCs
ZRUAYdZgKBQvFQQ4FUPTqSOU4CIIQifZ+RgqXLJ+RZDETYc2oBpDzC2AAAieImiw4ZgAEO6HoeXM
brjVcCltXwlZa60xOFQOmRsa7C0hdxyYei30R1a7zCrMzNKkGABge7fW/mfYrO11mL5NvPfeJz7w
rIXRBhPvtbUDi2Eo7FlFb1fC6GPlz9V2JjD6+x2k/flWKV88iAlm+AVtvYErPQjBWAAAAABJRU5E
rkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB5klEQVR4nE2SS29NURiGn7X3bk45
bmWgCBKlKi1iIAYSM6WJuP4AfoFLk2oMDCQY1oS5SBhURRgoKWm0oRMaMSDpgBpWelFtnZ6z11qv
wVr78I128u73+Z6VfAYAjDYc36pSuXFFuWFh/uvHiUWTOOKk9FYmqyrGf7+zl5T6lEpbfiq3tqax
nYf6pLwXw7/ueVlJVt1wUlWr2/wXPpeVvJZ2wVNZ7/MjRZawfU5eshqE5hl5WfUlMTQcXecMQD8c
W+8NsLYIxVkApTMv4RQCWKxTty0G6kPYPC8vOV1OivBE2RkwDEDnGmcgYby+clBWcvqxikJ7qrko
tlTkpVz3qGu/IolhV6M1kDIAnVF7pE59E6ifS3GBvA4W1LalgLoJLb+D65eGgDV0rbQGpRqAztXO
gHicp5E6IitZjZEwFFwrHaGYsKcaXLthRyUs6I+uKVfD3wutcDHqHC42MhqoL0h4HT77649sdwF1
AXYvy8trtjWGGdeUS16zG+GKcinXJbKoasbkpFyPyHgrq5oexJ7JOGDDs89AR0WupuFyPC6TcV25
5DTZlNKjZasn5VikaX/7J+XOVXWXjPdy7lZiiqOckI+XfPrG8DdN399HWmTZ0IepuV/Tfza12fFz
tWej76ZIvWL4F/+9Xfkt1Gc6AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACvklEQVR4nCXBS2hcVRwH4N//3HPn
dmZy59WZxnRotE3SRiNNkBRqEFF8gYuSLqUFBVFw4bpL3UhBdBF0J4i6EMSFm1JxodgQqWDG1KaF
mjhN2jw7kziPZObOnXvP+bnw+wBxUwr6qINiLgOB+MARH4ACtDjuMy/E9VpyxpnfGB327rrnK83N
qcLaz3FbMKHef6u95RxLJ00zzKfatVM7rWjs9rUv/SqKH8/eZkya0FpL2zeMDQ2vfnHZA1KJz8OA
xljG7HYMrbVkwL27k0jorr8aJaEAOpHyuJaJM4emFCx+KgPQeOX8xjgFgfyo/6yr+ulrF0Z2wl+f
PIx6VvD61OxYDlbtzDa2Ozh6Zr09pipJhBaAO/TJYkhaXn/H1S7+pwQiApXfq00KAJxePeJH5fE8
0o7WKueQEAwNzj1vHEr7erVxY7p4v/Le1l9+9l7rQWpP49JqE4Ag81p2691kUPD6CXH0B7Jwi7q8
kj5LBwByLIsAAPqxeyGz9hvh4MOwR5I01liSNIYk5wa1r83I7s7jFJAq6h6U/umkxzcbw+vNWy8t
rWtMPlUvazBKfH/vYYUvDy2PDpvKUvDvnapoVE9OBD6RWF76oebu/627RhX8g326oC48GjmhIMTB
naoKxVAcu9cAVASoTu27QpoAzPHhxyAUGoi1sAKocCb4BRbA9PR2U1tFpUEQQkB5F8+MQWCxMDfU
8oo2qWLfoyIEkHT36pV+AojWf7p5fHXgvpcZuOEXd9ncFwiylz7KCoBQub8vvhFtZr3DVg43v+pt
NAVvnzv7rBUIEUgvR2XpYOlk/Fnnm4bCyn5qDQJAUsn8IQgQU7m43GtZLSuFmUnstgtZE4nrR80S
zENTSmx96/bFl9GJ50bmmcWDfEbh1e2v36wvZ+zCH0/PE4BTUnjiokbuxLFBuL4HnHsR4rjAfx8L
Vmj4yxNsAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABpElEQVR4nG2QvWpUURSFv73vuZNx
/qLGIhjFREIIzoBgp42+QB7AB7CI2Aki2Nqm0VaxsNTaQgUbu4COMgRjERshRBRzoxMzueecbXFn
yExmVnVgnbX3t5c8eJh3d//u7f3J/vX2pTxVazQa0ydPpNXmhrqdLX9+njEZgIja3Nslr4bkzz/3
YlI+s3ztbBRpbiiQ8Nq8WbDNIiTU1yxYC3WCIINRqQHE7t36LaqImlmxAITce+99VB57ZkCPQwAE
tjrMghsHBaO7UtshTjRrLvsOmE7w5MX7ComMjhUSQPPG1eyQaMeBQgghcGd6N8cYTZYvJ5KeWl65
jiKjpnKhXbxy7R81nDxoC6JTC9Wji4+6/VJgLa3bx6LRYSBBVUW/rhHGxxoRMNqUxs3Bl+1H24Ak
Nr5zSBO7TSxqbN3+MKlbQkS5t3pllHYgLfkbN3nlpN83IJIAmEUOW8/cj3VAeWfeLNrPuX7YXbz/
K9obHBLnFyFAnHn6MrpKbfbcwmIl5qVNeNL5lNkEeVvFXWpmv7/td3s+9/7Ap6lL01KlXqtWTnf4
Dx/9xEeFRo08AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABY0lEQVR4nG2TTUubURCFn7n3RqkW
i+CqtAuXulJK/CgIKW0Ruu2ua/+Cv8eFP0LcJYKiG0VXhdISEVpB+mGpYJN753TRkJg3eVYXDjNn
5gwXAIwdZQ3jaicA02SDgGy7NVPooXgDQKCepaL2UwIPSADB30YP4uPXiRIHmhKAs4YHo0UpVAg8
a6tIejHcFYDIaxW5Pj/BKlUgNhCF5q1pjLiJYRwTqWI8/yF33S5VLROE0piVuV2dJw1K5ZDAWKUk
2Jd7tdLy9AoG3K1P9UWly08mCCy4JJW/eUBHWwQSsGYeSmy+74bBJnaHk4B3gDj8VesO7QDJ/NEy
KPkRepiP/mf3qiN3XT+uZAcEo17LJk7+VLIDQuYlhtgbcxGY+y53eX1MsPBGrqzTmVFLApsIcfE7
jVgSWEVEWoxqsHit4rqfJ8U+/dE+KKvoYNQQSA1AfFuf7LdV/HnWe36RV/5B1m5v8n9UH8quvvut
FwAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABpElEQVR4nGWSPWtUQRiFn3fm3Y2K
cSMGNBJFCZvdECEolinERv+BCBbaabBYtLbyT9j4B8QmtYUS8AMtohaiS5CoEBLFBC1WdvfeORab
j3s3p33mHM7MHMBpqa9d9X59fHr/IhABnEdFKEnqv144RAQCz5XlO8qyXq+XSfp8CTBGVpUPO/t9
/bvmmE6ewO6uRgGoOnq0fuH8CKl34AZELku/qxQ1/WBDenYYnNvScvS4LfdocGrpwxEcmIGVPOYF
Z4g/rh78G5xEE9rRS7lZ6HQsuSU/C2/yvASRIdx0fBKmroRUQPZ2EwGReSUN6xwBcGOaPOYqRa5/
RYDDDFi5DusdE+CiiW1uWcGaxxeEQcHwSboZKmFPFrZPOeOT8CVRLKtdeHqUznfD2E+dOqz9FMW6
ECQg0ITVfiizmMQObBOKLidv1Mwg2BSsxMJ/kbJ4611LETi2Ic2XMhutZWmrTsDPjKO52mAjxNpE
c262QpaP3bkXEtf3jUvdrvRkIhg+i/YeQEpYpcq3h48xwaKyYePLhTGCAd4oXEPdP2vtV0vvYbCo
/6xkBwhLGGykAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACL0lEQVR4nI1SQUiUYRB9M9/n6q6t
irSa2tK6SpusKS5JQSGEiKVGdAiEoksWQSEdOlSXOkRkB4/RpVIo6lKoJUZKEBodMgoLwthMwY0y
sVXXNtv//6aD2992650G3pv3ZpihutdNn2aOTI6VNif7AsH5+JSFzqz+KAkAXG1Pjjf03vE9Ftl7
WlYTOxrRJfugAADTIvM7i5E/Z+T8IUnKsb5o/VGsgR8ZfH7+Nfu+z8LHBBhTI7GXNyjNHliUxJvt
vvZQOOLJDVdVqfVe6DSHrpjYYnUzHLBT68JSQSprm8k2sIQBwyKOzA3D35fL1q1aKUCEckxxGdKZ
DKjYqDf4rH/krhtS2e32+rOdhNsiF15JSqxfEoE/Ej4xEPrTCAYmYnWi4x0jaIN9MH+6a1I7obfk
2kWRJwHa2FoJ4gIQOa7aBV8jMDDtmp0FgLgS85ccWnBvlvlC2Bq2KNEgBkxa0FPQ9P7UuRAYYMeQ
PQAA2votru7tOjxhBd4m8s5WL46jzqVXbo6SAFrKt5TuwcOfy0VLndVn8GD3fpt40IAE4JXajkuk
l34UfcmrGDIYLAGx1doGBqDn/MM9Oc3JK8eHkzVP51wfFocBO+8dnF2hcgGAUF6LTBAUAcYwGxID
0Nq9jPyjIQLACv8BJpCzNsHr11Aq/SBZa+bOu+hNKwtGwDBQdkvkMipKopThFQoE7N4UAFDNTGXL
2KRDEhkObgg1vLhOmZNmzuw5WQ8CwCDF9BuAE9JcQdDIwwAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABtklEQVR4nHWSv2vTURTFz33vmW9M
DLVCbEQtBbW0zdAiRlFpJ0EKFbp3FFcHNwdxVKijo/YfEEHcSpw6iUhXMUKRVpAgKdaA+v3x7nF4
SZPmi2d7fN6575zLE/QlhiTc2NTF+uREdfxEISrIIfJAbeH6tXo1wlGJEdjll7sZSfo0juMk80oA
gDEYW/uYkD7LstSzLwFgWFp8uAQNB6D9pbXzfb8bJwBELj3t0HvSK/+2nt86bQfv4corVU9SefBm
9RQAY51z1hoAV9+RSlK5uVqBWCsD40Qz0cDWL0CMDLfAi46GbI9r1jk7LDR2A0uaVYzK3a2EQcnb
uThHP8X8r+R3sRdBNT+2W+hVNiYPt5dKAAD/mczRZ/thfvdeOcdw+1uoop1pKyMCNjq9bB8uWzOy
IKlt+d76tleOy2isO+/D4j3b67OAuCG74MbrVDMlvbL1ZB4AxFrnnAUgMvnoB5kpVZW/mg8aJ23f
BxiWGvdXjsHDEAbA3tedvfbPP2m4ISg2Ng6UmqVZmh75YAAMFHNry9NlAEoNDjkMZsSjPLN4s36u
MpQVA6wEilOzM+fPnhkvR1H0Dz3vC0wfwOQHAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB40lEQVR4nGWSwWsTURDGf/PepjVo
lRKUmLYaxNpLMA0iHhQ8iKjgQc9epHiqgn+Al5z0DwhSPXvwUPSkB0ELKiKUgCBUKIUKtsVQmzRN
m02bze542N000Tm9ed8388037wmAaHZ6aL26Ud1uB+jg6MnsifTRdPI+AJYX2tF/oqOPJawsXPLS
D1K+Xf1cabf/rKzV/UdTXCUOS0n19UEEAMPx3d8pJ4SMsf4RWsVmIkAgEJo7K9UIDLRj8yx9Fy/M
BQ5sYIizM+PMd1Nou99wumAuSTlUtPjK7rXlLtGhpHsFTNiyPwQ+6XISAeHeNAKmSzJkajqLFbFM
6LuuoVhymDKiCrd5hY20IvAiLCSGAvFOP9Q5gn7NN+q5ruu6zZZ+pa+t6OFzBApgLQtY7QENuWPM
HBrLZEZSMzRiN1El5w0ftF6vN5qz+DEYDhRwga0fIAge62jfOM6ilqNjppRBsD0rOOvq88hcvLFY
05BP8iW6EUcwWrwZcy3PtDW5/16Wy3p9v9G8Lg3QI/PxpyAg1hng1Ka+xIqIMY7jDHJLn8SLtdxV
nUvElUJqUW9gQeyVcclODQfyq4bTqa2tVpqpO/lqriIKxf+/s3r6FgM470f2Nre269WGHyiCHZ0s
TIztPAXgL6vKzplhLTo1AAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABd0lEQVR4nHWSzWpUQRCFv6puZwgD
CYpRDIQ4KPiXjIj4Du7c+RS+Qh7ApWQlZCHiS7hxJ+jG3wmTELJQIYKIiwgqmdt9XNy5nR7QWlX3
qVN96lQDGM/VqIuUmqaZTo///NqMYFq4gtGFl2wYwTS8cALmB19OLwwGg37/xxYQuFe6Zn07VZhE
MG6hjhcmKbapKTmIUakVY5+BkiKWeleLCuNl05RSw/PaXl/WMV8f5jazyUMI3FXSv2IUMTbIs7bZ
Pz89t3z+TA/p9/YYnGdlkkaPWyPcHYjI1osF4kMM00wGCCl6XrlYwMC4UZ4dEm5cWsqdVvs5ocMA
N0bFH7H/nSqc2jzGOagCk10rTxrvq92Ba6k27x0VEbhTHMk6Wq12Dc51UtHz6dDyHLhRid1JNRHn
ZuXP2zk9+OLlcuF8nNcThysdKD/eC94eTEkQ13tl0bZ7UMS1zNvk0E159okpS1mJr4+OTLz4zze4
TyTeqATqZOI3r0j8BZe93DE5ZPjpAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAAo0lEQVR4nLWSMQoCMRRE52cDAQvB
K3grz2Cvd/Ea3mKvsO1iJ5YiJhkLleT/ZcMiOFXIYyb/DxFiRtEf3BwDgN+hL8esSQYraEIcpMA4
aJg2V/msQrlsKRrH4uTTQqqBbCEFrnbGF3pp1HesYqOFqYIeRm5pfZPY3IrtvjeU214jhh58K3Ns
vSmh1e1j4iwN3c+apPVpaX3JONWenYaE/OnfvgAbKDv8tFAviAAAAABJRU5ErkJggg==
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAB6UlEQVR4nFWRO2iUQRSFz8zsRoIY
IYpBLAyCBMTYBCxMo4U2ChoIgmKxYGEjFuKDEFArSWMlEVTwAUIKtbBQgvhCo42yhXEFhRWDgiSi
UZNIsv/MfBb/P8k6zRQf595zzpWWnrNa3n/1zQ8e6MT7uYX7nUvIOLUN1Al8OLfnNoHAnWa2d4IY
G/RpiEYgUl9kVufBh8C49uEjBJ4lZnSRLIBnUKN48BknkxcdJ4sQ+d2pEeZ9jFwomNWWv0TAc1Pa
NkOgtl8mwRE8QGSHnDYcOby1RdYUrDsXBl46GWNy97KSZNTXGowkdCuUhSmVLEEq5XM7hSTc97vy
KMa0TZJUk0GKujTV0r7WqfkZrbxHhMjo6Mdfz9uTz/xzxK6zBzBfXn1+W6vP/id0ajs2No2nkjw0
nUq7PxGJTLarXCriLdYzCD6QcTn5a9IN4D3EyC65dCNbsJ2EvJ13BXJLWcpVAkDGGTlJ1korejbm
OQ6myue6ZSVntHm4zul8w+Nc6HkoIzmtu54FHi2TkdQ7T8xhRU5O/VMsUF2dT72Rpn7rUKmsU/gG
L9YUmf5ALrwma1Uh0hgqp7yT+BCJke1q7RkO/LyySTZ1cWgm35m9Hp+m8eRoh4xLBRp1VXrXr2r1
s2GiOvb0q+QUUgX/AKSeNiHWHjEEAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now let's load the data in a more manageable format. Since, depending on your computer setup you might not be able to fit it all in memory, we'll load each class into a separate dataset, store them on disk and curate them independently. Later we'll merge them into a single dataset of manageable size.&lt;/p&gt;
&lt;p&gt;We'll convert the entire dataset into a 3D array (image index, x, y) of floating point values, normalized to have approximately zero mean and standard deviation ~0.5 to make training easier down the road.&lt;/p&gt;
&lt;p&gt;A few images might not be readable, we'll just skip them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Pixel width and height.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pixel_depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Number of levels per pixel.&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_letter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Load the data for a single letter label.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;image_files&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndarray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;image_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndimage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;pixel_depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel_depth&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Unexpected image shape: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_data&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;IOError&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Could not read:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;- it&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;s ok, skipping.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Many fewer images than expected: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; &amp;lt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_num_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Full dataset tensor:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Mean:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Standard deviation:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;
        
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;maybe_pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_num_images_per_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dataset_names&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.pickle&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dataset_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# You may override by setting force=True.&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; already present - Skipping pickling.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pickling &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_letter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_num_images_per_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HIGHEST_PROTOCOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Unable to save data to&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset_names&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_datasets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_datasets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maybe_pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;./notMNIST_large/A.pickle already present - Skipping pickling.
./notMNIST_large/B.pickle already present - Skipping pickling.
./notMNIST_large/C.pickle already present - Skipping pickling.
./notMNIST_large/D.pickle already present - Skipping pickling.
./notMNIST_large/E.pickle already present - Skipping pickling.
./notMNIST_large/F.pickle already present - Skipping pickling.
./notMNIST_large/G.pickle already present - Skipping pickling.
./notMNIST_large/H.pickle already present - Skipping pickling.
./notMNIST_large/I.pickle already present - Skipping pickling.
./notMNIST_large/J.pickle already present - Skipping pickling.
./notMNIST_small/A.pickle already present - Skipping pickling.
./notMNIST_small/B.pickle already present - Skipping pickling.
./notMNIST_small/C.pickle already present - Skipping pickling.
./notMNIST_small/D.pickle already present - Skipping pickling.
./notMNIST_small/E.pickle already present - Skipping pickling.
./notMNIST_small/F.pickle already present - Skipping pickling.
./notMNIST_small/G.pickle already present - Skipping pickling.
./notMNIST_small/H.pickle already present - Skipping pickling.
./notMNIST_small/I.pickle already present - Skipping pickling.
./notMNIST_small/J.pickle already present - Skipping pickling.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-2&quot;&gt;Problem 2&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-2&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's verify that the data still looks good. Displaying a sample of the labels and images from the ndarray. Hint: you can use matplotlib.pyplot.&lt;/p&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pro2_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_letter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_folders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;./notMNIST_small/A
Could not read: ./notMNIST_small/A/RGVtb2NyYXRpY2FCb2xkT2xkc3R5bGUgQm9sZC50dGY=.png : cannot identify image file &amp;#39;./notMNIST_small/A/RGVtb2NyYXRpY2FCb2xkT2xkc3R5bGUgQm9sZC50dGY=.png&amp;#39; - it&amp;#39;s ok, skipping.
Full dataset tensor: (1872, 28, 28)
Mean: -0.132626
Standard deviation: 0.445128
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pro2_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pro2_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[[-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5        -0.45294118 -0.45686275 -0.49607843
  -0.5        -0.46470588 -0.48039216 -0.5        -0.49607843 -0.5        -0.5
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5        -0.44117647 -0.40980393 -0.17843138
  -0.04509804 -0.26078433 -0.1509804  -0.35882354 -0.5        -0.49607843
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.49215686 -0.5        -0.2254902   0.11960784  0.26862746
   0.5         0.37058824  0.38627452 -0.01372549 -0.37843138 -0.49215686
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.49215686 -0.5        -0.32745099  0.06862745  0.30000001  0.5
   0.48039216  0.49215686  0.5         0.39411765  0.04509804 -0.5
  -0.49607843 -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.49215686 -0.5        -0.31960785  0.03333334  0.44509804  0.49607843
   0.49607843  0.49215686  0.49607843  0.46078432  0.13137256 -0.3392157
  -0.48823529 -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.48039216 -0.5        -0.17058824  0.49607843  0.49607843  0.49607843
   0.5         0.5         0.5         0.44117647  0.4137255   0.00588235
  -0.5        -0.5        -0.49607843 -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.49215686 -0.5        -0.20196079  0.20980392  0.40588236  0.48823529
   0.5         0.5         0.5         0.49607843  0.5         0.45686275
   0.01764706 -0.37843138 -0.5        -0.49607843 -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.48823529 -0.5         0.00980392  0.20588236  0.45686275  0.5
   0.48823529  0.48823529  0.5         0.49215686  0.5         0.35882354
   0.36666667 -0.26862746 -0.5        -0.48823529 -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.48431373 -0.45294118  0.04117647  0.36666667  0.5         0.49607843
   0.49215686  0.47254902  0.4254902   0.49215686  0.49607843  0.5
   0.42156863 -0.06078431 -0.5        -0.49215686 -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.5        -0.49607843
  -0.5        -0.31568629  0.23333333  0.5         0.49215686  0.5
   0.45294118  0.21764706  0.23333333  0.30000001  0.5         0.49215686
   0.49607843  0.06862745 -0.22941177 -0.5        -0.49607843 -0.5        -0.5
  -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.49607843 -0.5        -0.44901961
  -0.37450981  0.17058824  0.31176472  0.5         0.49215686  0.5
   0.2764706  -0.43333334 -0.10392157  0.22156863  0.44901961  0.5         0.5
   0.37843138  0.04901961 -0.34705883 -0.5        -0.49215686 -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.49607843 -0.5        -0.36666667
  -0.46078432  0.04117647  0.5         0.48431373  0.49607843  0.49215686
   0.0254902  -0.49215686 -0.23333333  0.1627451   0.46078432  0.5         0.5
   0.46862745  0.10784314 -0.22941177 -0.5        -0.49215686 -0.5        -0.5
  -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.48823529 -0.43333334
  -0.1509804   0.4254902   0.44901961  0.5         0.5         0.33137256
  -0.06078431 -0.42156863 -0.48431373 -0.09607843  0.24509804  0.37450981
   0.5         0.5         0.37450981 -0.20196079 -0.44117647 -0.5
  -0.49607843 -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.48823529 -0.41764706
   0.18627451  0.48823529  0.49215686  0.49607843  0.42941177  0.0882353
  -0.28823531 -0.5        -0.49215686 -0.36274511  0.1509804   0.45686275
   0.49607843  0.5         0.41764706  0.05294118 -0.26862746 -0.5
  -0.49607843 -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.49607843 -0.5        -0.19803922
   0.40588236  0.5         0.5         0.49607843  0.36274511  0.0372549
  -0.3509804  -0.5        -0.46862745 -0.37450981 -0.10784314  0.47254902
   0.49215686  0.49215686  0.5         0.15490197 -0.37843138 -0.40196079
  -0.48431373 -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.5        -0.5        -0.38627452 -0.21372549
   0.24117647  0.5         0.5         0.42941177  0.21764706 -0.19019608
  -0.5        -0.49215686 -0.5        -0.44509804 -0.17058824  0.12352941
   0.5         0.49215686  0.48823529  0.5        -0.14705883 -0.44117647
  -0.46470588 -0.5        -0.5        -0.5       ]
 [-0.5        -0.5        -0.49607843 -0.48823529 -0.33137256  0.17450981
   0.46470588  0.49607843  0.5         0.46470588  0.29215688  0.06078431
  -0.11960784 -0.26078433 -0.04509804 -0.17450981 -0.12745099  0.38235295
   0.42941177  0.49215686  0.5         0.47647059  0.22941177 -0.3509804
  -0.48431373 -0.5        -0.5        -0.5       ]
 [-0.5        -0.49607843 -0.5        -0.42156863 -0.1627451   0.35882354
   0.49607843  0.5         0.5         0.47254902  0.44117647  0.30784315
   0.24117647  0.42941177  0.18627451  0.28823531  0.35882354  0.4254902
   0.45294118  0.49607843  0.5         0.48039216  0.43333334 -0.21372549
  -0.4254902  -0.5        -0.49607843 -0.5       ]
 [-0.5        -0.48823529 -0.48823529 -0.31568629  0.10392157  0.42156863
   0.5         0.49607843  0.49607843  0.5         0.5         0.5         0.5
   0.49607843  0.46078432  0.49215686  0.47647059  0.5         0.5         0.5
   0.5         0.48823529  0.5         0.16666667 -0.36666667 -0.48431373
  -0.5        -0.5       ]
 [-0.5        -0.48431373 -0.48431373 -0.07254902  0.38627452  0.39411765
   0.5         0.49215686  0.5         0.49607843  0.47647059  0.48823529
   0.5         0.49215686  0.49607843  0.49215686  0.5         0.5
   0.49215686  0.49215686  0.5         0.48823529  0.5         0.33137256
  -0.33137256 -0.45294118 -0.5        -0.5       ]
 [-0.49607843 -0.5        -0.43333334 -0.00196078  0.47254902  0.45686275
   0.5         0.5         0.48431373  0.48039216  0.48039216  0.48431373
   0.4137255   0.49215686  0.40980393  0.44901961  0.38627452  0.46862745
   0.48823529  0.5         0.49607843  0.49607843  0.5         0.36666667
  -0.16666667 -0.4137255  -0.5        -0.49607843]
 [-0.5        -0.47254902 -0.14313726  0.21764706  0.47647059  0.5
   0.49607843  0.47647059  0.06470589 -0.03333334  0.26862746 -0.04509804
  -0.17058824 -0.10392157 -0.17058824  0.06470589  0.1        -0.19803922
  -0.02156863  0.31176472  0.46470588  0.45294118  0.5         0.49607843
   0.26078433 -0.36274511 -0.5        -0.49215686]
 [-0.48431373 -0.33529413 -0.04901961  0.33137256  0.5         0.48431373
   0.5         0.13529412 -0.21372549 -0.36274511 -0.5        -0.46078432
  -0.44509804 -0.5        -0.43725491 -0.47647059 -0.36666667 -0.4254902
  -0.47647059 -0.01764706  0.23333333  0.38235295  0.5         0.49215686
   0.31960785  0.15490197 -0.5        -0.49607843]
 [-0.44901961 -0.30784315  0.09607843  0.48039216  0.49607843  0.5
   0.43333334  0.00980392 -0.29215688 -0.47254902 -0.5        -0.49215686
  -0.49607843 -0.48431373 -0.49607843 -0.49607843 -0.5        -0.49215686
  -0.5        -0.43725491  0.02156863  0.44509804  0.5         0.5
   0.4254902   0.07254902 -0.11960784 -0.48431373]
 [-0.39803922 -0.12745099  0.3509804   0.5         0.48823529  0.43725491
   0.19019608 -0.11176471 -0.43725491 -0.5        -0.49607843 -0.5        -0.5
  -0.5        -0.5        -0.5        -0.49607843 -0.49607843 -0.48823529
  -0.5        -0.25686276  0.39803922  0.42156863  0.49607843  0.48039216
   0.36274511  0.00588235 -0.5       ]
 [-0.33137256  0.21764706  0.48431373  0.5         0.4254902   0.44117647
  -0.02156863 -0.40980393 -0.44509804 -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.49607843
  -0.5        -0.41764706  0.1627451   0.44901961  0.45294118  0.5         0.5
  -0.00980392 -0.34313726]
 [-0.33137256 -0.02941176 -0.00588235  0.08431373  0.33137256  0.02156863
  -0.40980393 -0.49215686 -0.49215686 -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.49607843
  -0.5        -0.35490197 -0.2372549   0.19803922  0.29607844  0.01372549
   0.20196079 -0.17843138 -0.45294118]
 [-0.48431373 -0.40196079 -0.37450981 -0.48039216 -0.45294118 -0.46470588
  -0.49607843 -0.49607843 -0.5        -0.5        -0.5        -0.5        -0.5
  -0.5        -0.5        -0.5        -0.5        -0.5        -0.5        -0.5
  -0.46470588 -0.4254902  -0.48431373 -0.38235295 -0.45686275 -0.46862745
  -0.19803922 -0.44901961]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Merge and prune the training data as needed. Depending on your computer setup, you might not be able to fit it all in memory, and you can tune &lt;code&gt;train_size&lt;/code&gt; as needed. The labels will be stored into a separate array of integers 0 through 9.&lt;/p&gt;
&lt;p&gt;Also create a validation dataset for hyperparameter tuning.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;make_arrays&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndarray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndarray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;merge_datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_arrays&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_arrays&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tsize_per_class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;start_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;end_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsize_per_class&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;end_l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tsize_per_class&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;       
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;letter_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# let&amp;#39;s shuffle the letters to have random validation and training set&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;letter_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;valid_letter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;letter_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_letter&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;start_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;end_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;
                    
        &lt;span class=&quot;n&quot;&gt;train_letter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;letter_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vsize_per_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_letter&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;start_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsize_per_class&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;end_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsize_per_class&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Unable to process data from&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt;
    
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;
            
            
&lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;merge_datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;train_datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;merge_datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Validation:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Testing:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Training: (200000, 28, 28) (200000,)
Validation: (10000, 28, 28) (10000,)
Testing: (10000, 28, 28) (10000,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-3&quot;&gt;Problem 3&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-3&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another check: we expect the data to be balanced across classes. Verify that.&lt;/p&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[9]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(Counter({0: 20000,
          1: 20000,
          2: 20000,
          3: 20000,
          4: 20000,
          5: 20000,
          6: 20000,
          7: 20000,
          8: 20000,
          9: 20000}),
 Counter({0: 1000,
          1: 1000,
          2: 1000,
          3: 1000,
          4: 1000,
          5: 1000,
          6: 1000,
          7: 1000,
          8: 1000,
          9: 1000}),
 Counter({0: 1000,
          1: 1000,
          2: 1000,
          3: 1000,
          4: 1000,
          5: 1000,
          6: 1000,
          7: 1000,
          8: 1000,
          9: 1000}))&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, we'll randomize the data. It's important to have the labels well shuffled for the training and test distributions to match.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;randomize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;shuffled_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:,:]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;shuffled_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffled_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffled_labels&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-4&quot;&gt;Problem 4&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-4&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Convince yourself that the data is still good after shuffling!&lt;/p&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt output_prompt&quot;&gt;Out[11]:&lt;/div&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(10000,)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Finally, let's save the data for later reuse:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;notMNIST.pickle&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;save&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;train_dataset&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;train_labels&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_dataset&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_labels&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;test_dataset&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;test_labels&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HIGHEST_PROTOCOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Unable to save data to&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;statinfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Compressed pickle size:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;statinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;st_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Compressed pickle size: 690800512
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-5&quot;&gt;Problem 5&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-5&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;By construction, this dataset might contain a lot of overlapping samples, including training data that's also contained in the validation and test set! Overlap between training and test can skew the results if you expect to use your model in an environment where there is never an overlap, but are actually ok if you expect to see training samples recur when you use it.
Measure how much overlap there is between training, validation and test samples.&lt;/p&gt;
&lt;p&gt;Optional questions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What about near duplicates between datasets? (images that are almost identical)&lt;/li&gt;
&lt;li&gt;Create a sanitized validation and test set, and compare your accuracy on those in subsequent assignments.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(200000, 28, 28)
(200000,)
(10000, 28, 28)
(10000,)
(10000, 28, 28)
(10000,)
[4 9 6 2 7 3 5 9 6 4 7 6 0 1 8 0 1 9 6 5]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Problem-6&quot;&gt;Problem 6&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-6&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's get an idea of what an off-the-shelf classifier can give you on this data. It's always good to check that there is something to learn, and that it's a problem that is not so trivial that a canned solution solves it.&lt;/p&gt;
&lt;p&gt;Train a simple model on this data using 50, 100, 1000 and 5000 training samples. Hint: you can use the LogisticRegression model from sklearn.linear_model.&lt;/p&gt;
&lt;p&gt;Optional question: train an off-the-shelf model on all the data!&lt;/p&gt;
&lt;hr&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datas&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;encoded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;encoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3 [0 0 0 1 0 0 0 0 0 0]
6 [0 0 0 0 0 0 1 0 0 0]
4 [0 0 0 0 1 0 0 0 0 0]
7 [0 0 0 0 0 0 0 1 0 0]
7 [0 0 0 0 0 0 0 1 0 0]
7 [0 0 0 0 0 0 0 1 0 0]
7 [0 0 0 0 0 0 0 1 0 0]
1 [0 1 0 0 0 0 0 0 0 0]
7 [0 0 0 0 0 0 0 1 0 0]
4 [0 0 0 0 1 0 0 0 0 0]
6 [0 0 0 0 0 0 1 0 0 0]
0 [1 0 0 0 0 0 0 0 0 0]
9 [0 0 0 0 0 0 0 0 0 1]
0 [1 0 0 0 0 0 0 0 0 0]
0 [1 0 0 0 0 0 0 0 0 0]
2 [0 0 1 0 0 0 0 0 0 0]
2 [0 0 1 0 0 0 0 0 0 0]
8 [0 0 0 0 0 0 0 0 1 0]
2 [0 0 1 0 0 0 0 0 0 0]
9 [0 0 0 0 0 0 0 0 0 1]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(200000, 784) (200000, 10)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# HyperParameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;total_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Hyperparameters for Stochastic Gradient Descent &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mini_batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;



&lt;span class=&quot;c1&quot;&gt;# Feed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[21]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Neural Network Model &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;layer_1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;w1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;b1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;b1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;variable_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;layer_2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scope&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;w2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;w2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;b2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stddev&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#operations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;layer1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layer1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax_cross_entropy_with_logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#tf.reduce_sum(tf.square(prob - train_y))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GradientDescentOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;



&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_log&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;step_log&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#stochastic gradient descent &lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#mini_batch 획득 &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;batch_mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mini_batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mini_batch_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mini_batch_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;#획득한 mini_batch 만을 통해 gradient descent 실행해 W,b parameter update &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mini_batch_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mini_batch_labels&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_sum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mini_batch_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mini_batch_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;loss_log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;step_log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;step :&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; loss in current mini_batch : &amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Finish stochastic gradient descent Optimization !&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;float&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;ac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_y&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Accuracy for validation set:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;step : 0  loss in current mini_batch :  4601.67
step : 100  loss in current mini_batch :  1326.26
step : 200  loss in current mini_batch :  1195.37
step : 300  loss in current mini_batch :  1190.59
step : 400  loss in current mini_batch :  1132.75
step : 500  loss in current mini_batch :  1044.28
step : 600  loss in current mini_batch :  1068.86
step : 700  loss in current mini_batch :  974.242
step : 800  loss in current mini_batch :  1004.78
step : 900  loss in current mini_batch :  965.052
step : 1000  loss in current mini_batch :  1032.54
step : 1100  loss in current mini_batch :  948.49
step : 1200  loss in current mini_batch :  992.098
step : 1300  loss in current mini_batch :  898.133
step : 1400  loss in current mini_batch :  937.777
step : 1500  loss in current mini_batch :  907.827
step : 1600  loss in current mini_batch :  965.427
step : 1700  loss in current mini_batch :  918.821
step : 1800  loss in current mini_batch :  862.558
step : 1900  loss in current mini_batch :  920.642
step : 2000  loss in current mini_batch :  908.376
step : 2100  loss in current mini_batch :  952.623
step : 2200  loss in current mini_batch :  922.263
step : 2300  loss in current mini_batch :  759.279
step : 2400  loss in current mini_batch :  884.643
step : 2500  loss in current mini_batch :  820.881
step : 2600  loss in current mini_batch :  895.333
step : 2700  loss in current mini_batch :  813.88
step : 2800  loss in current mini_batch :  837.536
step : 2900  loss in current mini_batch :  761.909
step : 3000  loss in current mini_batch :  796.58
step : 3100  loss in current mini_batch :  831.549
step : 3200  loss in current mini_batch :  762.656
step : 3300  loss in current mini_batch :  704.09
step : 3400  loss in current mini_batch :  755.157
step : 3500  loss in current mini_batch :  753.041
step : 3600  loss in current mini_batch :  757.668
step : 3700  loss in current mini_batch :  717.796
step : 3800  loss in current mini_batch :  680.764
step : 3900  loss in current mini_batch :  722.954
step : 4000  loss in current mini_batch :  729.337
step : 4100  loss in current mini_batch :  716.981
step : 4200  loss in current mini_batch :  776.64
step : 4300  loss in current mini_batch :  704.61
step : 4400  loss in current mini_batch :  717.521
step : 4500  loss in current mini_batch :  747.119
step : 4600  loss in current mini_batch :  720.399
step : 4700  loss in current mini_batch :  723.838
step : 4800  loss in current mini_batch :  728.95
step : 4900  loss in current mini_batch :  768.013
step : 5000  loss in current mini_batch :  762.636
step : 5100  loss in current mini_batch :  674.274
step : 5200  loss in current mini_batch :  725.508
step : 5300  loss in current mini_batch :  644.987
step : 5400  loss in current mini_batch :  700.892
step : 5500  loss in current mini_batch :  712.414
step : 5600  loss in current mini_batch :  686.918
step : 5700  loss in current mini_batch :  729.377
step : 5800  loss in current mini_batch :  659.036
step : 5900  loss in current mini_batch :  717.935
step : 6000  loss in current mini_batch :  717.452
step : 6100  loss in current mini_batch :  751.168
step : 6200  loss in current mini_batch :  624.755
step : 6300  loss in current mini_batch :  671.416
step : 6400  loss in current mini_batch :  714.373
step : 6500  loss in current mini_batch :  692.471
step : 6600  loss in current mini_batch :  657.005
step : 6700  loss in current mini_batch :  664.928
step : 6800  loss in current mini_batch :  748.706
step : 6900  loss in current mini_batch :  708.959
step : 7000  loss in current mini_batch :  689.302
step : 7100  loss in current mini_batch :  576.379
step : 7200  loss in current mini_batch :  633.845
step : 7300  loss in current mini_batch :  634.733
step : 7400  loss in current mini_batch :  633.668
step : 7500  loss in current mini_batch :  651.758
step : 7600  loss in current mini_batch :  682.321
step : 7700  loss in current mini_batch :  693.369
step : 7800  loss in current mini_batch :  692.234
step : 7900  loss in current mini_batch :  669.476
step : 8000  loss in current mini_batch :  682.369
step : 8100  loss in current mini_batch :  625.788
step : 8200  loss in current mini_batch :  677.573
step : 8300  loss in current mini_batch :  657.304
step : 8400  loss in current mini_batch :  661.556
step : 8500  loss in current mini_batch :  651.978
step : 8600  loss in current mini_batch :  605.606
step : 8700  loss in current mini_batch :  595.129
step : 8800  loss in current mini_batch :  605.027
step : 8900  loss in current mini_batch :  632.582
step : 9000  loss in current mini_batch :  688.383
step : 9100  loss in current mini_batch :  635.524
step : 9200  loss in current mini_batch :  660.438
step : 9300  loss in current mini_batch :  593.719
step : 9400  loss in current mini_batch :  655.906
step : 9500  loss in current mini_batch :  641.276
step : 9600  loss in current mini_batch :  620.561
step : 9700  loss in current mini_batch :  639.464
step : 9800  loss in current mini_batch :  713.408
step : 9900  loss in current mini_batch :  635.882
step : 10000  loss in current mini_batch :  616.373
step : 10100  loss in current mini_batch :  635.377
step : 10200  loss in current mini_batch :  617.724
step : 10300  loss in current mini_batch :  651.883
step : 10400  loss in current mini_batch :  624.633
step : 10500  loss in current mini_batch :  689.182
step : 10600  loss in current mini_batch :  643.464
step : 10700  loss in current mini_batch :  632.735
step : 10800  loss in current mini_batch :  657.008
step : 10900  loss in current mini_batch :  727.608
step : 11000  loss in current mini_batch :  604.399
step : 11100  loss in current mini_batch :  678.079
step : 11200  loss in current mini_batch :  602.736
step : 11300  loss in current mini_batch :  628.098
step : 11400  loss in current mini_batch :  631.935
step : 11500  loss in current mini_batch :  486.739
step : 11600  loss in current mini_batch :  600.978
step : 11700  loss in current mini_batch :  661.016
step : 11800  loss in current mini_batch :  658.212
step : 11900  loss in current mini_batch :  591.686
step : 12000  loss in current mini_batch :  561.555
step : 12100  loss in current mini_batch :  590.612
step : 12200  loss in current mini_batch :  625.416
step : 12300  loss in current mini_batch :  631.534
step : 12400  loss in current mini_batch :  576.341
step : 12500  loss in current mini_batch :  561.747
step : 12600  loss in current mini_batch :  610.397
step : 12700  loss in current mini_batch :  646.197
step : 12800  loss in current mini_batch :  571.696
step : 12900  loss in current mini_batch :  597.438
step : 13000  loss in current mini_batch :  571.774
step : 13100  loss in current mini_batch :  605.854
step : 13200  loss in current mini_batch :  587.422
step : 13300  loss in current mini_batch :  629.188
step : 13400  loss in current mini_batch :  580.812
step : 13500  loss in current mini_batch :  618.708
step : 13600  loss in current mini_batch :  601.535
step : 13700  loss in current mini_batch :  592.996
step : 13800  loss in current mini_batch :  513.31
step : 13900  loss in current mini_batch :  573.671
step : 14000  loss in current mini_batch :  568.322
step : 14100  loss in current mini_batch :  534.002
step : 14200  loss in current mini_batch :  530.757
step : 14300  loss in current mini_batch :  596.364
step : 14400  loss in current mini_batch :  617.588
step : 14500  loss in current mini_batch :  612.434
step : 14600  loss in current mini_batch :  544.609
step : 14700  loss in current mini_batch :  573.086
step : 14800  loss in current mini_batch :  658.637
step : 14900  loss in current mini_batch :  682.304
Finish stochastic gradient descent Optimization !
Accuracy for validation set: 0.8785
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;In&amp;nbsp;[24]:&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#show loss changes&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;


&lt;div class=&quot;output_area&quot;&gt;
&lt;div class=&quot;prompt&quot;&gt;&lt;/div&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjkAAAFkCAYAAADCEyrZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAPYQAAD2EBqD+naQAAIABJREFUeJzt3XucVVX9//HXBwhUChAvQ0paSiFqmgwpfFW0KK95SytH
/VlqX8sQjTIvZWnat4sXIAHLvKSmTBlqKqKkaKiAkjPmjZsXVJQAuQ0IyADz+f2x9vbsc+bMzJlh
Zs7Zw/v5eKzHnLP2Ovuss2Fm3rP2WnubuyMiIiLS0XQqdgdERERE2oJCjoiIiHRICjkiIiLSISnk
iIiISIekkCMiIiIdkkKOiIiIdEgKOSIiItIhKeSIiIhIh6SQIyIiIh2SQo6IiIh0SEUPOWZ2hZnV
5ZTZOW2uMrNFZrbOzB4zs34527uZ2XgzW2Zma8xsopntnNNmezO728xqzGylmd1iZt3b4zOKiIhI
+yt6yIm8ApQBfaJySLzBzC4BzgfOBQ4E1gJTzKxr4vVjgGOBk4GhwC7AvTnvMQEYAAyL2g4FbmqD
zyIiIiIlwIp9g04zuwI4wd0HNrB9EXCtu4+OnvcAlgDfdvd7oufvA6e6+/1Rm/7AHGCwu88yswHA
q0C5u78QtTkSeBjo6+6L2/ZTioiISHsrlZGcz5rZe2b2hpndZWafAjCzzxBGdqbGDd19NfAcMCSq
GgR0yWkzD3gn0WYwsDIOOJHHAQcOapuPJCIiIsXUpdgdAJ4FvgPMAz4JXAk8ZWb7EgKOE0ZukpZE
2yCc5qqNwk9DbfoAS5Mb3X2zma1ItKnHzHYAjgTeAj5sxmcSERHZ2m0DfBqY4u7Li9GBooccd5+S
ePqKmc0C3ga+CcwtTq8+ciRwd5H7ICIikmanE+bFtruih5xc7l5jZvOBfsC/ACOM1iRHc8qA+NTT
YqCrmfXIGc0pi7bFbXJXW3UGeifa5PMWwF133cWAAQNa8nGkBUaOHMno0aOL3Y2tio55+9Mxb386
5u1rzpw5nHHGGRD9Li2Gkgs5ZvZxQsC5w90XmNliwoqol6LtPQjzaMZHL6kCNkVtkhOPdwNmRm1m
Ar3M7IDEvJxhhAD1XCPd+RBgwIABDByYd160tIGePXvqeLczHfP2p2Pe/nTMi6Zo0z2KHnLM7Frg
IcIpql2BXwIbgb9GTcYAl5vZ64Q0eDXwLvAAhInIZnYrMMrMVgJrgBuA6e4+K2oz18ymADeb2XlA
V2AsUKmVVSIiIh1T0UMO0Jdwrm4HwlLwZwhLv5cDuPs1ZrYd4Zo2vYCngaPdvTaxj5HAZmAi0A14
FBie8z6nAeMIq6rqorYXttFnEhERkSIreshx94oC2lxJWHXV0PYNwIioNNRmFXBG83soIiIiaVQq
18kR+UhFRZO5V1qZjnn70zFvfzrmW5+iX/G4lJnZQKCqqqpKk9VERESaobq6mvLycgh3G6guRh80
kiMiIiIdkkKOiIiIdEgKOSIiItIhKeSIiIhIh6SQIyIiIh2SQo6IiIh0SAo5IiIi0iEp5IiIiEiH
pJAjIiIiHZJCjoiIiHRICjkiIiLSISnkiIiISIekkCMiIiIdkkKOiIiIdEgKOSIiItIhKeSIiIhI
h6SQIyIiIh2SQo6IiIh0SAo5IiIi0iEp5IiIiEiHpJAjIiIiHVLJhRwzu9TM6sxsVKLuz1FdskzO
eV03MxtvZsvMbI2ZTTSznXPabG9md5tZjZmtNLNbzKx7e302ERERaT8lFXLM7IvAucCLeTY/ApQB
faJSkbN9DHAscDIwFNgFuDenzQRgADAsajsUuKnJjm3YUOhHEBERkRJRMiHHzD4O3AV8F1iVp8kG
d3/f3ZdGpSbx2h7A2cBId5/m7i8AZwEHm9mBUZsBwJHAOe7+vLvPAEYAp5pZn0Y7t3p1K3xCERER
aU8lE3KA8cBD7v5EA9sPN7MlZjbXzG40s96JbeVAF2BqXOHu84B3gCFR1WBgZRSAYo8DDhzUaM/W
rGnWBxEREZHi61LsDgCY2anAF4BBDTR5hHDqaQGwJ/AbYLKZDXF3J5y+qnX33CGXJdE2oq9Lkxvd
fbOZrUi0yU+nq0RERFKn6CHHzPoS5tN8xd035mvj7vcknr5qZi8DbwCHA0+2eSdra9v8LURERKR1
FT3kEE417QRUm5lFdZ2BoWZ2PtAtGq35iLsvMLNlQD9CyFkMdDWzHjmjOWXRNqKvuautOgO9E23y
GjlmDD3vvz+rrqKigoqK3LnPIiIiW5/KykoqKyuz6mpqahpo3X4sJz+0fwfCEu7dc6pvB+YAv3X3
OXle0xd4GzjB3SdFE4/fB0519/ujNv2jfQx291lmthfwKjAonpdjZkcAk4G+7l4v6JjZQKCq6oYb
GDhiROt8YBERka1AdXU15eXlAOXuXl2MPhR9JMfd1wKzk3VmthZY7u5zohB0BWFOzmLC6M3vgPnA
lGgfq83sVmCUma0E1gA3ANPdfVbUZq6ZTQFuNrPzgK7AWKAyX8DJojk5IiIiqVP0kNOA5PDSZmA/
4EygF7CIEG5+kTOHZ2TUdiLQDXgUGJ6z39OAcYRVVXVR2wub7I3m5IiIiKROSYYcd/9y4vGHwFEF
vGYD4bo3DZ5XcvdVwBnN7lBdXbNfIiIiIsVVStfJKV2bNhW7ByIiItJMCjmF2Ly52D0QERGRZlLI
KYRCjoiISOoo5BRCIUdERCR1FHIKoTk5IiIiqaOQUwiN5IiIiKSOQk4hFHJERERSRyGnEAo5IiIi
qaOQUwiFHBERkdRRyCmEJh6LiIikjkJOITSSIyIikjoKOYVwb7qNiIiIlBSFnELoBp0iIiKpo5BT
CIUcERGR1FHIKYRCjoiISOoo5BRCIUdERCR1FHIKoYnHIiIiqaOQUwgtIRcREUkdhZxCaCRHREQk
dRRyCqE5OSIiIqmjkFMIhRwREZHUUcgphEKOiIhI6ijkFEIhR0REJHUUcgqhicciIiKpU3Ihx8wu
NbM6MxuVU3+VmS0ys3Vm9piZ9cvZ3s3MxpvZMjNbY2YTzWznnDbbm9ndZlZjZivN7BYz695kp7SE
XEREJHVKKuSY2ReBc4EXc+ovAc6Pth0IrAWmmFnXRLMxwLHAycBQYBfg3py3mAAMAIZFbYcCNzXZ
MY3kiIiIpE7JhBwz+zhwF/BdYFXO5guBq919kru/ApxJCDEnRq/tAZwNjHT3ae7+AnAWcLCZHRi1
GQAcCZzj7s+7+wxgBHCqmfVptHMayREREUmdkgk5wHjgIXd/IllpZp8B+gBT4zp3Xw08BwyJqgYB
XXLazAPeSbQZDKyMAlDsccCBg1r1k4iIiEjRdSl2BwDM7FTgC4SwkqsPIYgsyalfEm0DKANqo/DT
UJs+wNLkRnffbGYrEm3y0+oqERGR1Cl6yDGzvoT5NF9x943F7k8+I19+mZ7HH59VV1FRQUVFRZF6
JCIiUjoqKyuprKzMqqupqSlSbzKKHnKAcmAnoNrMLKrrDAw1s/OBvQAjjNYkR3PKgPjU02Kgq5n1
yBnNKYu2xW1yV1t1Bnon2uQ1ep99GPjgg839XCIiIluFfH/4V1dXU15eXqQeBaUwJ+dx4POE01X7
R+V5wiTk/d39TUIIGRa/IJpofBAwI6qqAjbltOkP7AbMjKpmAr3M7IDEew8jBKjnGu2hTleJiIik
TtFHctx9LTA7WWdma4Hl7j4nqhoDXG5mrwNvAVcD7wIPRPtYbWa3AqPMbCWwBrgBmO7us6I2c81s
CnCzmZ0HdAXGApXu3uhIjkKOiIhI+hQ95DQg68I07n6NmW1HuKZNL+Bp4Gh3r000GwlsBiYC3YBH
geE5+z0NGEcYPaqL2l7YdG90nRwREZG0KcmQ4+5fzlN3JXBlI6/ZQLjuzYhG2qwCzmh2hzSSIyIi
kjqlMCen9GkkR0REJHUUcgqhkCMiIpI6CjmF0OkqERGR1FHIKYRGckRERFJHIacQGskRERFJHYWc
QijkiIiIpI5CTiF0ukpERCR1FHIKoZAjIiKSOgo5hdDpKhERkdRRyCmERnJERERSRyGnEBrJERER
SR2FnEIo5IiIiKSOQk4hdLpKREQkdRRyCqGRHBERkdRRyCmERnJERERSRyGnEAo5IiIiqaOQUwid
rhIREUkdhZxCaCRHREQkdRRyCqGRHBERkdRRyCmEQo6IiEjqKOSIiIhIh6SQUwiN5IiIiKSOQk4h
FHJERERSp+ghx8y+b2YvmllNVGaY2VGJ7X82s7qcMjlnH93MbLyZLTOzNWY20cx2zmmzvZndHb3H
SjO7xcy6F9RJra4SERFJnaKHHGAhcAkwECgHngAeMLMBiTaPAGVAn6hU5OxjDHAscDIwFNgFuDen
zQRgADAsajsUuKmgHmokR0REJHW6FLsD7v5wTtXlZnYeMBiYE9VtcPf3873ezHoAZwOnuvu0qO4s
YI6ZHejus6LAdCRQ7u4vRG1GAA+b2UXuvriJTrbw04mIiEixlMJIzkfMrJOZnQpsB8xIbDrczJaY
2Vwzu9HMeie2lRPC2tS4wt3nAe8AQ6KqwcDKOOBEHgccOKjJjmkkR0REJHWKPpIDYGb7AjOBbYA1
wElRUIFwqupeYAGwJ/AbYLKZDXF3J5y+qnX31Tm7XRJtI/q6NLnR3Teb2YpEm4ZpJEdERCR1SiLk
AHOB/YGewCnAnWY21N3nuvs9iXavmtnLwBvA4cCT7dI7hRwREZHUKYmQ4+6bgDejpy+Y2YHAhcB5
edouMLNlQD9CyFkMdDWzHjmjOWXRNqKvuautOgO9E20aNHL9enoef3xWXUVFBRUVufOfRUREtj6V
lZVUVlZm1dXU1BSpNxnmJThKYWZTgbfd/ew82/oCbwMnuPukaOLx+4SJx/dHbfoTJi0PjiYe7wW8
CgxKTDw+ApgM9G1o4rGZDQSqqrbZhoHr17f+BxUREemgqqurKS8vh7Dop7oYfSj6SI6Z/Zow7+Yd
4BPA6cBhwBHRdWyuIMzJWUwYvfkdMB+YAuDuq83sVmCUma0kzOm5AZju7rOiNnPNbApwc7Ryqysw
FqhscmVV2EHrfWARERFpF0UPOYTTSHcAnwRqgJeAI9z9CTPbBtgPOBPoBSwihJtfuPvGxD5GApuB
iUA34FFgeM77nAaMI6yqqovaXlhQD7W6SkREJHWKHnLc/buNbPsQOKqh7Yl2G4ARUWmozSrgjJb0
USM5IiIi6VNS18kpWQo5IiIiqaOQUwidrhIREUkdhZxCaCRHREQkdRRyCqWgIyIikioKOYXSKSsR
EZFUUcgplEKOiIhIqijkFEqnq0RERFJFIadQGskRERFJFYWcQinkiIiIpIpCTqEUckRERFJFIadQ
CjkiIiKpopBTKIUcERGRVFHIKZRWV4mIiKSKQk6hNJIjIiKSKgo5hVLIERERSRWFnEIp5IiIiKSK
Qk6hFHJERERSRSGnUAo5IiIiqaKQUyitrhIREUkVhZxCaSRHREQkVRRyCqWQIyIikioKOYVSyBER
EUkVhZxCKeSIiIikikJOoRRyREREUqXoIcfMvm9mL5pZTVRmmNlROW2uMrNFZrbOzB4zs34527uZ
2XgzW2Zma8xsopntnNNmezO7O3qPlWZ2i5l1L7ijCjkiIiKpUvSQAywELgEGAuXAE8ADZjYAwMwu
Ac4HzgUOBNYCU8ysa2IfY4BjgZOBocAuwL057zMBGAAMi9oOBW4quJdaQi4iIpIqXYrdAXd/OKfq
cjM7DxgMzAEuBK5290kAZnYmsAQ4EbjHzHoAZwOnuvu0qM1ZwBwzO9DdZ0WB6Uig3N1fiNqMAB42
s4vcfXGTHdVIjoiISKqUwkjOR8ysk5mdCmwHzDCzzwB9gKlxG3dfDTwHDImqBhHCWrLNPOCdRJvB
wMo44EQeBxw4qKDOKeSIiIikStFHcgDMbF9gJrANsAY4yd3nmdkQQhBZkvOSJYTwA1AG1Ebhp6E2
fYClyY3uvtnMViTaNE4hR0REJFVKIuQAc4H9gZ7AKcCdZja0uF3KGAn0vOAC6Nnzo7qKigoqKiqK
1ykREZESUVlZSWVlZVZdTU1NkXqTURIhx903AW9GT18wswMJc3GuAYwwWpMczSkD4lNPi4GuZtYj
ZzSnLNoWt8ldbdUZ6J1o06DRwMBRo6C8vDkfS0REZKuQ7w//6upqyov8e7Ok5uQkdAK6ufsCQggZ
Fm+IJhofBMyIqqqATTlt+gO7EU6BEX3tZWYHJN5jGCFAPVdQj7S6SkREJFWKPpJjZr8GHiFMFP4E
cDpwGHBE1GQMYcXV68BbwNXAu8ADECYim9mtwCgzW0mY03MDMN3dZ0Vt5prZFODmaOVWV2AsUFnQ
yirQnBwREZGUKXrIIZxGugP4JFADvAQc4e5PALj7NWa2HeGaNr2Ap4Gj3b02sY+RwGZgItANeBQY
nvM+pwHjCKuq6qK2FxbcS4UcERGRVCl6yHH37xbQ5krgyka2bwBGRKWhNquAM5rfw4hCjoiISKqU
6pyc0qOQIyIikioKOYVSyBEREUmVFoUcM/u2mR2beH6Nma2Kbq65e+t1r4Qo5IiIiKRKS0dyfgqs
B4iuSjwcuBhYRrisTMejJeQiIiKp0tKJx58CXo8enwjc6+5/MrPpwL9ao2MlRyM5IiIiqdLSkZwP
gB2ix0cAj0WPPwS23dJOlSSFHBERkVRp6UjOY8AtZvYC8DlgclS/D+GCfR2PQo6IiEiqtHQkZzjh
Vgk7ASe7+/KovhyobPBVaaaQIyIikiotGsmJLqx3fp76K7a4R6VKIUdERCRVWrqE/CgzOyTxfLiZ
/cfMJpjZ9q3XvRKi1VUiIiKp0tLTVdcCPQDM7PPA9YR5OZ8BRrVO10qMRnJERERSpaUTjz8DzI4e
nwxMcvefmtlAMpOQOxaFHBERkVRp6UhOLbBd9PgrwD+jxyuIRng6HIUcERGRVGnpSM4zwKjo4n8H
At+K6j8HvNsaHSs5CjkiIiKp0tKRnPOBTcApwHnu/l5UfzTwaGt0rOQo5IiIiKRKS5eQvwN8LU/9
yC3uUalSyBEREUmVlp6uwsw6E+5bNSCqehV40N03t0bHSo6WkIuIiKRKi0KOmfUjrKLaFZgXVV8G
LDSzY939jVbqX+nQSI6IiEiqtHROzg3AG8Cn3H2guw8EdgMWRNs6HoUcERGRVGnp6arDgMHuviKu
cPflZnYpML1VelZqFHJERERSpaUjORuAT+Sp/zjhGjodj0KOiIhIqrQ05EwC/mRmB1nGYOCPwIOt
170SopAjIiKSKi0NORcQ5uTMBD6MygzgdeCHrdO1EqPVVSIiIqnSopDj7qvc/QTCFY5Picrn3P0k
d1/VnH2Z2WVmNsvMVpvZEjO738w+l9Pmz2ZWl1Mm57TpZmbjzWyZma0xs4lmtnNOm+3N7G4zqzGz
lWZ2i5l1L6ijGskRERFJlYInHptZU3cX/5KZAeDuP2pGHw4FxgLPR/35DfBPMxvg7usT7R4BvgNY
9HxDzn7GEK64fDKwGhgP3BvtPzYBKAOGAV2B24GbgDMa7WGnTgo5IiIiKdOc1VUHFNiuWed13P2Y
5HMz+w6wFCgn3CMrtsHd38+3DzPrAZwNnOru06K6s4A5Znagu88yswHAkUC5u78QtRkBPGxmF7n7
4gY7qZAjIiKSOgWHHHf/Ult2JKEXISityKk/3MyWACuBJ4DLE0vYywmfZWrc2N3nmdk7wBBgFjAY
WBkHnMjj0XsdBDzQYI/MFHJERERSpsW3dWgLFs53jQGecffZiU2PEE49LQD2JJzSmmxmQ9zdgT5A
rbuvztnlkmgb0delyY3uvtnMViTa5KeRHBERkdQpqZAD3AjsDRycrHT3exJPXzWzlwmruw4Hnmzz
XmkkR0REJHVKJuSY2TjgGOBQd/9vY23dfYGZLQP6EULOYqCrmfXIGc0pi7YRfc1dbdUZ6J1ok9fI
2lp63nILPPHER3UVFRVUVFQU9NlEREQ6ssrKSiorK7PqampqitSbDPMSuP5LFHBOAA5z9zcLaN8X
eBs4wd0nRROP3ydMPL4/atMfmEO4/cQsM9uLcKf0QYmJx0cQbjTaN9/EYzMbCFRVde/OwF/+En78
41b5vCIiIh1ddXU15eXlEBb8VBejD0UfyTGzG4EK4HhgrZmVRZtq3P3D6Do2VxDm5CwmjN78DpgP
TAFw99VmdiswysxWAmsINwqd7u6zojZzzWwKcLOZnUdYQj4WqGx0ZVXopE5XiYiIpEzRQw7wfcIK
p3/l1J8F3AlsBvYDziSsvFpECDe/cPeNifYjo7YTgW7Ao8DwnH2eBowjrKqqi9pe2GQPNfFYREQk
dYoecty90asuu/uHwFEF7GcDMCIqDbVZRVMX/stHIUdERCR1Wnrvqq2PQo6IiEiqKOQUolMn3aBT
REQkZRRyCqHTVSIiIqmjkFMIra4SERFJHYWcQmgkR0REJHUUcgqhkRwREZHUUcgphEZyREREUkch
pxAayREREUkdhZxCmGkJuYiISMoo5BRCp6tERERSRyGnEAo5IiIiqaOQUwjNyREREUkdhZxCaCRH
REQkdRRyCqGRHBERkdRRyCmEVleJiIikjkJOIXS6SkREJHUUcgqhkCMiIpI6CjmF0JwcERGR1FHI
KYRGckRERFJHIacQGskRERFJHYWcQijkiIiIpI5CTiE6ddISchERkZRRyCmERnJERERSRyGnEJp4
LCIikjpFDzlmdpmZzTKz1Wa2xMzuN7PP5Wl3lZktMrN1ZvaYmfXL2d7NzMab2TIzW2NmE81s55w2
25vZ3WZWY2YrzewWM+veZCcVckRERFKn6CEHOBQYCxwEfAX4GPBPM9s2bmBmlwDnA+cCBwJrgSlm
1jWxnzHAscDJwFBgF+DenPeaAAwAhkVthwI3NdlDna4SERFJnS7F7oC7H5N8bmbfAZYC5cAzUfWF
wNXuPilqcyawBDgRuMfMegBnA6e6+7SozVnAHDM70N1nmdkA4Eig3N1fiNqMAB42s4vcfXGDnVTI
ERERSZ1SGMnJ1QtwYAWAmX0G6ANMjRu4+2rgOWBIVDWIENiSbeYB7yTaDAZWxgEn8nj0Xgc12iOt
rhIREUmdkgo5ZmaE007PuPvsqLoPIYgsyWm+JNoGUAbURuGnoTZ9CCNEH3H3zYQw1YfGaCRHREQk
dYp+uirHjcDewMHF7kjSyLlz6fnmm3D88R/VVVRUUFFRUcReiYiIlIbKykoqKyuz6mpqaorUm4yS
CTlmNg44BjjU3f+b2LQYMMJoTXI0pwx4IdGmq5n1yBnNKYu2xW1yV1t1Bnon2uQ1ep99GNizJzz4
YPM+lIiIyFYg3x/+1dXVlJeXF6lHQUmcrooCzgnAl9z9neQ2d19ACCHDEu17EObRzIiqqoBNOW36
A7sBM6OqmUAvMzsgsfthhAD1XKMd7NwZNm9u9ucSERGR4in6SI6Z3QhUAMcDa82sLNpU4+4fRo/H
AJeb2evAW8DVwLvAAxAmIpvZrcAoM1sJrAFuAKa7+6yozVwzmwLcbGbnAV0JS9crG11ZBQo5IiIi
KVT0kAN8nzCx+F859WcBdwK4+zVmth3hmja9gKeBo929NtF+JLAZmAh0Ax4Fhufs8zRgHGFVVV3U
9sIme9ipE2za1JzPJCIiIkVW9JDj7gWdMnP3K4ErG9m+ARgRlYbarALOaF4PgS5doLa26XYiIiJS
MkpiTk7J69RJp6tERERSRiGnEJ0763SViIhIyijkFMIdFi4sdi9ERESkGYo+JycVHnqo2D0QERGR
ZtJIjoiIiHRICjnNoftXiYiIpIZCTnNs3FjsHoiIiEiBFHKaQ8vIRUREUkMhpzkUckRERFJDIacQ
hx0WvupaOSIiIqmhkFOIr30tfNVIjoiISGoo5BSiS3Q5IY3kiIiIpIZCTiE6RYdJIzkiIiKpoZBT
iM6dw1eFHBERkdRQyClEHHJ0ukpERCQ1FHIKoZAjIiKSOgo5hVi+PHzt37+4/RAREZGCKeQUQrdz
EBERSR2FnEJ00mESERFJG/32LkQ8J0dERERSQyGnEGbF7oGIiIg0k0JOITSSIyIikjoKOYXo16/Y
PRAREZFmKomQY2aHmtmDZvaemdWZ2fE52/8c1SfL5Jw23cxsvJktM7M1ZjbRzHbOabO9md1tZjVm
ttLMbjGz7k12sE+fVvmcIiIi0n5KIuQA3YH/AD8AvIE2jwBlQJ+oVORsHwMcC5wMDAV2Ae7NaTMB
GAAMi9oOBW5qsndaXSUiIpI6XYrdAQB3fxR4FMCswVm+G9z9/XwbzKwHcDZwqrtPi+rOAuaY2YHu
PsvMBgBHAuXu/kLUZgTwsJld5O6LG+xgskvLl8MOOzTzE4qIiEh7S9MQxeFmtsTM5prZjWbWO7Gt
nBDYpsYV7j4PeAcYElUNBlbGASfyOGHk6KBG3zk5kvPee1vwEURERKS9lMRITgEeIZx6WgDsCfwG
mGxmQ9zdCaevat19dc7rlkTbiL4uTW50981mtiLRJr/kSI43dDZNRERESkkqQo6735N4+qqZvQy8
ARwOPNmunXntNdh//3Z9SxEREWm+VIScXO6+wMyWAf0IIWcx0NXMeuSM5pRF24i+5q626gz0TrTJ
a+TIkfSMn3zjG3DccVRUVFBRkTv3WUREZOtTWVlJZWVlVl1NTU2RepNhXmKnX8ysDjjR3R9spE1f
4G3gBHefFE08fp8w8fj+qE1/YA4wOJp4vBfwKjAoMfH4CGAy0DffxGMzGwhUVVVVMbC8PLOhxI6Z
iIhIqamurqY8/O4sd/fqYvShJEZyomvV9APiyS97mNn+wIqoXEGYk7M4avc7YD4wBcDdV5vZrcAo
M1sJrAFuAKa7+6yozVwzmwLcbGbnAV2BsUBloyurREREJJVKIuQAgwinnTwq10f1dxCunbMfcCbQ
C1hECDe/cPeNiX2MBDYDE4FuhCXpw3Pe5zRgHGFVVV3U9sLW/zgiIiJSbCURcqJr2zS2nP2oAvax
ARgRlYbarALOaHYHAfbeG2bPDo/N4N//hkGDWrQrERERaXtpuk5Ocf3lL9nPp07N305ERERKgkJO
ofbcM/vjlKpNAAAgAElEQVT5pZcWpx8iIiJSEIWcQvXs2XQbERERKRkKOVviD3+AyZObbiciIiLt
riQmHqfWD34Qvuq6OSIiIiVHIzkiIiLSISnkNMd++xW7ByIiIlIghZzm6NYtf/3y5bBwIUyf3r79
ERERkQYp5DTHffflrx8/PtyZ/JBD2rc/IiIi0iBNPG6Ovn3z119xRfv2Q0RERJqkkRwRERHpkBRy
WtuiRbDTTnDBBcXuiYiIyFZNIae5Dj+88e277grLlsHYseGriIiIFIVCTnM9+WThbXfdFerqMs/f
eKP1+yMiIiJ5KeS0pdpa6NwZVq+Giy6Cfv3gX/8qdq9ERES2Cgo5LXHOOc1r/8wzcP314fGXvqTV
WCIiIu1AIaclzjuvee2PPTb7+VVXZR4/8ACYhfLKK1veNxEREQEUclqmvHzL9zFxYgg2J56YqfvD
H+q3W7lyy99LRERkK6SQ01LHH79lr//GN+rXPfQQTJuWeV5ZCb17h1tGJN17b/NPmYmIiGxlFHJa
6oEHoKKidfe5cGFYon7vvfDhh3DaaaF+0aLw9S9/gfPPh1NOgdtua3g/dXVQXd26fRMREUkZhZwt
kTvXprWccgpsu23mebwM/cwzw32ymnLDDeGUmpasi4jIVkwhZ0ucfnr7vM+bbxY+N2fBAnjkkfC4
pqbt+iQiIlLidIPONDjjjPz1s2fDihWZu5+//jp89rPt1y8REZESppGcNNtnHzj00PD44ovrB5wl
S2Dz5vbvl4iISAkoiZBjZoea2YNm9p6Z1ZlZvaVLZnaVmS0ys3Vm9piZ9cvZ3s3MxpvZMjNbY2YT
zWznnDbbm9ndZlZjZivN7BYz675Fnf/5z8Npq/feg549t2hXLTZ7Nlx7bf36Y46BQYPC4zfeCKM+
sbq6zFyfCy6Ab3+77fspIiLSjkoi5ADdgf8APwA8d6OZXQKcD5wLHAisBaaYWddEszHAscDJwFBg
F+DenF1NAAYAw6K2Q4GbtqjnV10Fd90Fu+wCq1Zl6lev3qLdNss++zS87T//gd/8JtxSYocdYPly
mDcv3G5i331Dm7Fj4c47w+PNm8Hr/ROEuv/+t/X7ns/ixbBxY/u8l4iIdFglEXLc/VF3/4W7PwBY
niYXAle7+yR3fwU4kxBiTgQwsx7A2cBId5/m7i8AZwEHm9mBUZsBwJHAOe7+vLvPAEYAp5pZn1b7
MGPHwrBh0H3LBoha1U9/mnm8447w17+Gx3PmQFVVdtsuXaBTJ9i0Kbv+xhtDkFu6tG37CvDJT8L3
v9/27yMiIh1aSYScxpjZZ4A+wNS4zt1XA88BQ6KqQYRJ1Mk284B3Em0GAyujABR7nDBydFCrdfj8
8+Hxx0NQKNX5MFdemXkcn87KNWMG/OMf8N3vhuDz3HOhvrWvwPzkk/lvZ/HEE637PiIistVJw+qq
PoQgsiSnfkm0DaAMqI3CT0Nt+gBZwxDuvtnMViTatK5OneCDD8IS8G7doH//NnmbVjNrVubxYYdl
b+sU5eF8p7Ia2tePfgSTJoXA8vWv52/35S/n3++yZYW9j4iISAPSEHKKbuTIkfTMmVRcUVFBRSFX
PO7eHT7/ediwoY1614oOamRA6447wtd4snLSunXw7LPhNF28n+22g+nTwwUMH3oorPTaeef6r42t
XQsnnQS33x6ef/ABzJ0Le+3Voo8iIiLtp7KyksrKyqy6mhK4VlsaQs5iwjydMrJHc8qAFxJtuppZ
j5zRnLJoW9wmd7VVZ6B3ok1eo0ePZuDAgS3+AEAYyVm8OFzLJr6uDcB998HIkfD221u2//ayzz4h
tNxzT7itxb77wm67ZbeJT21BaAtQVtb4KNBZZ8Fjj8Ef/5ipe/vt4oQcd/j1r0Ofdtml/d9fRCRl
8v3hX11dTXlr3NB6C5T8nBx3X0AIIcPiumii8UHAjKiqCtiU06Y/sBswM6qaCfQyswMSux9GCFCJ
38ptqKwMDj448/wf/wijFwsWhEnAaXHcceE+WsccUz/gNCZ5Oiy5hB3g738PX6++OlM3f374+s9/
wvr12fvauDEcv9gf/gBDhtAqamrg8svhe99rnf2JiEhRlETIMbPuZra/mX0hqtojev6p6PkY4HIz
O87MPg/cCbwLPAAfTUS+FRhlZoebWTlwGzDd3WdFbeYCU4CbzeyLZnYwMBaodPdGR3Ja3X33wcsv
wwknhOdmYcTiqqvatRvtLj4dNmdOmJ/U1HWFLrggLHc/8shw+ivp2mtDQHz55fD8Bz8Ip8xaQxy+
8p2aExGR1CiJkENYHfUCYUTGgeuBauCXAO5+DSGQ3EQYddkWONrdaxP7GAlMAiYC/wIWEa6Zk3Qa
MJewqmoS8BTQ/n+un3RS5ho1ST//eWa595w54fo2jz8OJ+d+jBSbNAn23juctvvgg6bb77135vH8
+WEJ++rVcP/9oW727HAaMJ+nnoKpU/Nva0x8Ws0sE8jWrm3+fkREpKjMC10tsxUys4FAVVVV1ZbP
ydlS69aFibv6ZVvfwIFQXR0ev/RSmOgNIaRAOK11yCHw29+GCzYefXRmtVddXagfPjwzsrRsGey0
E3zta7D77uHO7//+d8PL7WMrVoTg1pxTeB3JV78aVuFNmVLsnohICUjMySl39+pi9KFURnKkKdtt
F36BusP//V+xe1NaqhPfO/vtF8JN8qKFJ54YLoJ43XVwyy1hZOy998Icoc6d4Wc/g169QuBZsyYU
gIULM6esLN81KnPstVcIRRUVYWVZbMWK7Ocd1eOPh/lTIiIlQiEnjfbcM3y9777w9dhjM6MQXRN3
uvjEJ9q3X6WkrKzx7fffX3/J/A03QI8esMce4fmLL0JtdEZ048YQdMwyK+FWr4ajjspc6+f998PX
v/4Vzj47jL5BmKidXFH39NNhcvO6dXD99Q2vOrv/fpg5M/+2LfX972cme4uIdFTurtJAAQYCXlVV
5SWlrs79pZfcN2xw33VX9xkz3E891R3cv/CF8PUXv3CfPz88Vtny8sAD2c+/+c3CXvfee+49eoTH
MXA/5hj3iy8Oj6dPz/73Xb8+8++ZfN3ixe5TprTO/6HcfZfqPkUktaqqqpwwz3agt+Hv6saKRnLS
yCzMO+naFd59NyydvvXWMG/kyivDKMYvfxluynnKKeFUTdLZZ8O0aUXpemoll6tDuE5QIS6/PHOz
1jFjMvWTJ8M114THS5Zk30Pse9/L3F8stmQJHHpoWGmWNHdu9uTq73wHRo8OcWPcuOybxubTs2fm
pqw33VR/qb6ISJoVK12loVCqIznNtXmze79+9f/SXrbMPxr1iR+rtG259dbGt993X/265KhO/O83
ZEh23Ve+4v7KK/Vf+7//6/7226GMHOn+05+6r12b3WbCBPexY8Pjn/88+//OmDHuhx5a2P+zeH9/
+1t4ft997jU1+duuWeP+7rvN+388f777NdeEx5s2uf/5z2FUs6OprXWvri52L0S2WCmM5BTlTdNS
OkzIiQ0d6j5gQHbdW2+FEOSe/Ytv/nz3mTPDqbCmfnE/+6z7ww833U6ldcqLLxbeNhlu49KrV8Pt
f/Sj8H9h4kT3f/87U//hh+G02gEHuO+5Z+b/TFJyPy+8kHns7j5iRAhYsZ13zmyLvfFG+Lp+fTgV
m6t//8xrbrklPH7wweZ9D2zc6P6rX4XP4x4C3ocfui9c6P7YY83b1+LFzWufz9y57kceGYJN7Cc/
CZ+toYBYTBs3FrsHkiIKOSVeOlzIaUr8S+mhh7LrJ0wI9bfe6n7TTfV/Mea+PlnMwrZ58/JvVymt
cu65mTDRWLnoojD6V1sbgvBzzzXcdvXqzOPRo8MoRfx8/frstpMmha977pn5fzV6tPsNN2TavPGG
+w9/GB5fdZX7d74TQte6daHu0Ufr/9/evDmUv/wltLnxxkxYvOIK9112CY83b3Z/7TX3E090P/74
hr9Xnn02tJ86tcXfbu6eGaWLA557mK8F4fiWkni0t7Ky2D2RlFDIKfGy1Yacphx4YGi3cGGYWBuL
f2AvXx4mRq9Y4b5qVWb7bbeFkaNi/yJXKd1y9dWZx6tWhf9Hzd3HN7+Z///2brtl2vz+95nHF1yQ
eXzZZdn7uv569wULwj5ee8196dJwimzXXcP2iy/O/z3yt7+F7StWhNNqmzZltk2aFEZKk98zb7wR
2rz/vvtRR2VeG4tHSufNc7/22vCHR0Ouuy6MpLXUokXhcz/5ZHb9q6+GPpx1Vsv2O2eO+8qVzX/d
bbeFQFpMy5eH0/od8fRoG1LIKfGikNOADz5o/nyKfO+jotJY6datZa878sjsUDF9euPtkyGnoRL/
v91++/qjT/H3Ql1d+GXo7n766WHbNdeEr7fe6v766+5VVdn7HDYsPH7zTfdLLgmPjzgifJ03L/MZ
Lrww1H3qU9mvjyXDA7h36pR5XlvrPmtWYd+T7uG0dvz829/OtHn55VB39tkN7+fSS8MpuIbeY7/9
Gu+He/gjavvts18XjwgXy7nnhn68/HJx+5EyCjklXra6kDNjRv2/3tpC/AN0330zj+fODacQiv2L
VaVjlSuvbLrND37QvH1+/OPZz19+2f2wwzLP4xGPpkryeyF5Ci9Z4jkwn/1s/W2rVoVJ5PHlDQ45
pP72vn3dt902PH/++cy2NWvyf0+6u3/+89n7qawMQfCAA8Lzc84Joz3uIVz98Y/Z+xk4sPHv+3h0
9+GH3f/7X/cTTsiefxS3W7w4jKLFz+vqwhys5GjKvHlhwv2WGDXKfZ99Gm9zzjmZf2spmEJOiZet
LuS0lw8+cH/iifB4+PBQYs39Jfa1r7mfeWbzX6eiUuwSzw9qrJx8cggAjbWJR36aKt/6VuaxWWby
+I9/nKlPThhvqOyzT+bx8ceHr2+9lX0q2j0EoeT8vnjbYYeFbcl93n57CCv/+EfD73vnneHrX//q
Pnmy+1NPZR+npLq6EIDWrQuvcw/PP/ggjGz17u1+7LHhGCT77B7mgCWfuzccch55JDOSt2qV+7Rp
zf5xWFRTprjfc0/T7R55JDNZP7Z+ffaIaR4KOSVeFHKKIPlDLXkawd29oiI8Hj/e/eCDw+Of/Sxs
W7Ikew4DuO+0U/jBnvzBGZ8SiMteezX8Q1VFpSOVo4/Ofn7ddZng0Nplzz0zjy+8MISY5PZ//jP7
eZ8+he/7j3/MX//+++F7PzmiFU/injMn83zx4uxjED+O7b13pq6yMgSh444Lz3NDTvK18fGNV/y9
9FIIeclRqunTwynLhjz9dDit2Zg4wOWzfHnzVv3lfvZcEyeGifwQwnDuaxubnL9hg1dNm+YKOSVc
FHKK4PXX3X/5y8w33vvvZ87x19SECZHxcPUrrzS8pPWyy7LnIcTfzLlXLv7qV7Ofx6tsbr45u15F
RaU0Snz5gNyy//7h50GyLp7DtN9+mbrHHsv/+r33DqfQunbNro9P90EIOaNHh1CWXPFXV5f52RFf
Vyp3/7l1//xnqHvrrXDaLtkv9/BeM2bUn+x80UWhze67h5Gjm28O4SY598w9XPvqkEPC48mT3ceN
y+yjutr9T3/Kbv/FL7r/4Q9hNeRPflL/WH7jG+533ZU51Znb1+uuy+7nEUd4FbhCTgkXhZwO5Le/
Df/dp07N/sZdtCic7or/kvzylzOvac4P3gcfzDyOh7v32COcliv2LwUVFZX2Lfl+fnTvXr+uocCV
W3baKcypik8P5pZ4RV5c3nsv8/jpp7P7de+99V+f+8ceZIcgCCESwhy2H/0oU//hh9n7T/z8VMgp
8aKQ04HU1YXrfCTnHOT+5XH99dmrxuIfQLkTTSGEIvfwDR5fyC3eFg/FxyNJLf1BmVxOXWhp6K9c
FRUVlRUr2nb/M2eGUaU333SnNEKO7l0lWwcz2GEH2H9/+N3vwl3Af/zj7DY/+hHsumvm+bBhcOON
4e7iNTXh3lGx//43fO3WDT72sfB49mxYuBC++lVYtAi++MXs/S9dGu5m/thj9fvnHu41lnTiieHr
LruErxddlL39G9/Ifr7TTnDGGfk//5bIPU4N2X//1n9vEWk9vXu37f6HDAk/Z/fYo23fpxkUcmTr
YgYXXww9ehTW9rzzYJttQvunnoJf/AIOOih/+wEDoG/f8PiTn8ze1r17CCFdusBXvpK9Lb7p5jPP
wIwZmfpPfzp8PffczD7+9a9wE83Nm+FPf4L/+R/4zW+gri6EqG7dYN994Wc/y+znySdDKBs+vOnP
PG8eXHtt5vnJJ4f9FeI//4ELLiisrYhIeyjWEFIaCjpdJa3hwQfD1XKTVq1yP+WU/Pcniod+Y/Ht
B+64o3nvm7ufeF833BAe//Sn9Yeb3cOy0vj5pZdmbsnxyithYniyfbzKbf/9w2uT1zXJnf8Ul8sv
z1/fknLuuZlbLKioqJRUKYXTVUV507QUhRwpiviHRNKLLzb/kvJHHRVWmTVmypQQeh58MCzRdw9z
jEaMcP/73/PfKNPdvUuXTB8hTEZ0D7cniPtfV/fRufmPVoTE96SK23z96+FqwPluJNq3b9M/SGPf
+EZ4fskl2Vfsje+uHpeePevvo3fvzLLca69t+j1bWvr2LXyiqYpKBygKOSVeFHKkKP7nf8Iv/1JW
U5O5cu0772QmX8cjPcnbAWzaFELEHXeE0BO/5q236u8zHjWKbx2wYEFYRpu8cN4DD4Rlvc8+m3nt
smVhKW0MQnhxz56M/fvfh/tP3X67e3l5qDv22Ox+JK/E3ZrlqacyfVNR2QqKQk6JF4UckWaqqwun
o5Yu3bLXxxd2S4p/eBZi0aLM/Zw2bw5X+IXsG8q6h5GntWuz65LXVInLqFHh6+zZmbp+/cKIV7Jf
tbWZ5+PGZe8j93PklkMPDSNiJ50Urtdy4on123zzm/X3d8UVDe8T3D/96czjV15puN1ppzW+HxWV
ZpZSCDnm7u07CShFzGwgUFVVVcXAgQOL3R2RrZtZ+NrWP7MOOCBMoo7tsAMsW5Z5fumlsGYNjB8f
+tKpU5icvn592H7ddfCTn2T6mdvv3XeHd94Jj198MbMqLd/nuu02OOccOP98+N//hf32y38camvD
ZPRtt81sj9/rrbfCxHSz8JrOnfN/7nfegd12a/i4/PCHYWL9tGlhpWH8MzF3In1jXn8drrwS7ror
u76uLqx6vOyywvfVXr79bbjjjmL3IpWqgfLwsNzdq4vSiWKlqzQUNJJTFBMmTCh2F7Y6qTjm8+a5
z5/f9u9z663hL9FzzgkjN02prc2crnMPo1HJe/qA+yc+kXke3Xl8AoTn8+e7N3T8//zn8Pqbbsre
X/zafL70pUyb556rv/2997Jvhvu734X7ECX3/dvfhtN28QgWNH538bgcemjmflC5N/pM9jm+nUJ8
ajA+bgsXhlOZU6e6n3FG5nV//Wvj142Krw5cVpapu+yyem0m5Htt8mJ5+Yp79v26mlt23735r/n6
11v+fiVUSmEkpyhv2uxOwhVAXU6ZndPmKmARsA54DOiXs70bMB5YBqwBJgI7N/G+CjlFcNxxxxW7
C1sdHfOE2lr300/P3Gl7S82eHS7bH1u50n3KFD9u2LCmX7t+vfsPf5h9Sq2pkNPQFWhzzZzpvttu
4b5vje374YdDXTwHK9fYseEmoXFQiiUD0uGHZ+/3ww/D6by6usYn1D//fGbuVvIqvvHtXSDcjiAW
r/aDcOHPd9/N+kzHffWr4X5U06Zlf9b4cfJqwNtu637eeWF7vOJw113rH6svf7nxK5vH1q8Pfb7n
HvdevTLbf/Mb90GDMs+XLw/tZs0K4S2u32OPht8jeawLLZ07N/81CjltGnJeAnYCdo5K78T2S4AV
wNeAfYF/AG8AXRNt/gC8BRwGHADMAJ5u4n0VcopAv3Dbn455+2vxMX/4Yff772+8zVNPNTzy0pgX
X8w/+tMSH3wQLv+/YUO4G3gyTLXUhg1hpCfWs2f2sXj++TCnKWnlyo/mZ2Ud84ULwxwld/fPfjb8
Oly/PnwdNCg71C1fHuqTvws+9rFQF0+Af/NN96uuCoHjkUcyd4dvyOjR7ieckHkeh4N167LbLV2a
uWN8fFuH+KaZP/tZmKdVV+c+ZEhmH6NGuU+a5P63v4XRQPcQaJMh5Pbbs8NWXK65puHgsn599p3b
+/fPnhO2445hBC46jlWjRyvkFNTJEHKqG9m+CBiZeN4DWA98M/F8A3BSok3/aETowEb2q5BTBPqF
2/50zNufjnn7a/CYv/FGuLu5ewgyDV06Iem119wPOKD+xPXYpk2F7ScWB4XGXrN4cQgw+WzYkNlH
Pm+9FUaq3EPAq6sLoQRCAL3kkvD4tdfCMRg8OLO/3r2z97vrrtnPx40L9wDMUVVVVfSQk6YrHn/W
zN4zszfM7C4z+xSAmX0G6ANMjRu6+2rgOWBIVDUI6JLTZh7wTqKNiIhsjfbYA773vfB44EDo2rXp
1/TrB9XVsN12+bd37lzYfmIvvwx/+1vjrykrg5Ej82/r2hX+/W+4887823ffHb7+9fC4b98wET2+
QvvOO8OvfgVTpoTPNXAgjBsXtv34x9mT2QFeew0++CDzfPjwkp2c3aXYHSjQs8B3gHnAJ4ErgafM
bF9CwHFgSc5rlkTbAMqA2ij8NNQmn20A5syZswVdl+aqqamhuro4E/G3Vjrm7U/HvP2V/DGPg1NL
deoE++xT+D6uuSbcyiVuv+OOmcdmUFUVHpeVwYQJze5b4nfnNs16YStK5RJyM+sJvA2MBOYCzwC7
uPuSRJu/AXXuXmFmFcBt7r5tzn6eA55w97zrFs3sNODuNvoYIiIiW4PT3X1CMd44LSM5Wdy9xszm
A/2AfwFGGK1JjuaUAS9EjxcDXc2sR85oTlm0rSFTgNMJE5Y/bJXOi4iIbB22AT5N+F1aFKkMOWb2
cULAucPdF5jZYmAYYQUWZtYDOIiwZBygCtgUtbk/atMf2A2Y2dD7uPtyoCjpU0REpAOYUcw3T0XI
MbNrgYcIp6h2BX4JbAT+GjUZA1xuZq8TRl2uBt4FHoAwEdnMbgVGmdlKwnVybgCmu/usdvwoIiIi
0k5SEXKAvoQRlR2A9wlzcAZHIy24+zVmth1wE9ALeBo42t1rE/sYCWwmXASwG/AoMLzdPoGIiIi0
q1ROPBYRERFpSpqukyMiIiJSMIUcERER6ZAUchpgZsPNbIGZrTezZ83si8XuUxqY2WVmNsvMVpvZ
EjO738w+l6fdVWa2yMzWmdljZtYvZ3s3MxtvZsvMbI2ZTTSznXPabG9md5tZjZmtNLNbzKx7W3/G
Umdml5pZnZmNyqnXMW9FZraLmf0lOl7rzOxFMxuY00bHvJWYWSczu9rM3oyO5+tmdnmedjrmLWRm
h5rZg9HdBerM7Pg8bdrl+JrZp8zsYTNba2aLzewaM2t+ZinW/SRKuQDfIlwX50xgL8KE5hXAjsXu
W6kXYDLw/4ABwOeBSYQVb9sm2rTKDVWBR4Bqwm07/geYD9xV7GNQ5OP/ReBNwjWiRumYt9lx7gUs
AG4ByoHdga8An9Exb7Nj/lNgKXAU4fIfXwdWA+frmLfaMT4KuAo4gbBQ5/ic7e1yfAkDMC8Trq/z
eeDI6N/+V83+TMU+qKVYCLeR+H3iuRGWpF9c7L6lrQA7Em6EekiibotvqEoIUXXAAYk2RxKuh9Sn
2J+7SMf644Rbn3wZeJLskKNj3rrH+rfAtCba6Ji37jF/CLg5p24icKeOeZsc7zrqh5x2Ob7A0YTL
xOyYaPM9YCXQpTmfQ6ercpjZxwh/mSVv5unA4+hmni3Ri3BvsRXQqjdUHQysdPf4qtYQ/o2ccCHI
rdF44CF3fyJZqWPeJo4Dnjeze6LTstVm9t14o455m5gBDDOzzwKY2f7AwYTRYx3zNtbOx3cw8LK7
L0u0mQL0BPZpTr/Tcp2c9rQj0Jn8N/zs3/7dSS8zM8KFGp9x99lRdWvdULUPYfjyI+6+2cxW0PhN
VzskMzsV+ALhh0wuHfPWtwdwHnA98H/AgcANZrbB3f+Cjnlb+C1hpGCumW0mnNL4mbvHF4XVMW9b
7Xl8+zTwPvG2FwvttEKOtKUbgb0Jf21JGzGzvoQw+RV331js/mwlOgGz3P3n0fMXzWxf4PvAX4rX
rQ7tW8BpwKnAbEKo/72ZLYqCpUg9Ol1V3zLChKuynPqmbuYpCWY2DjgGONzd/5vYtJjMDVWTksf3
oxuqNtEmd8Z+Z6A3W9+/UzmwE1BtZhvNbCNh0t+FZlZL+AtIx7x1/ReYk1M3hzAhFvT/vC1cA/zW
3f/u7q+6+93AaOCyaLuOedtqz+O7uIH3gWb+Gyjk5Ij+Eq4i3MwT+Oi0yzCKfKOxtIgCzgnAl9z9
neQ2d19A+E+aPL7xDVXj45u8oWrcJveGqjOBXmZ2QGL3wwjfhM+15udJgccJKxC+AOwfleeBu4D9
3f1NdMxb23Tqn77uT7i/nv6ft43tCH+AJtUR/R7TMW9b7Xx8ZwKfN7MdE22OAGoIo3jN6rhK/Vnl
3wTWkb2EfDmwU7H7VuqFcIpqJXAoIXnHZZtEm4uj43kc4ZfzP4DXyF6GeCNhie7hhJGK6dRfhjiZ
8Mv8i4RTYvOAvxT7GJRCof7qKh3z1j2+gwirSC4D9iScRlkDnKpj3mbH/M+ECazHEJbsn0SY2/Fr
HfNWO8bdCX8kfYEQIH8YPf9Uex5fQnB9kbDUfD/C6qslwNXN/kzFPqilWoAfENb6ryekykHF7lMa
SvSNsTlPOTOn3ZWE5YjrCLPm++Vs7waMJZw+XAP8Hdg5p00vwmhFDSFY3QxsV+xjUAoFeIJEyNEx
b5NjfAzwUnQ8XwXOztNGx7z1jnd3YFT0C3Rt9Mv1l+QsKdYx36JjfFgDP8Nva+/jC3yKcJ21DwgB
53dAp+Z+Jt2gU0RERDokzckRERGRDkkhR0RERDokhRwRERHpkBRyREREpENSyBEREZEOSSFHRERE
OmJ5m3AAAAArSURBVCSFHBEREemQFHJERESkQ1LIERERkQ5JIUdEREQ6JIUcERER6ZD+Pz+Pg/f3
lkwPAAAAAElFTkSuQmCC
&quot;
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;
&lt;div class=&quot;prompt input_prompt&quot;&gt;
&lt;/div&gt;
&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Run-the-model&quot;&gt;Run the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Run-the-model&quot;&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;with tf.Session() as sess  :
    sess.run(init)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;for step in range(3000) : 

    sess.run(training ,feed_dict = {train_x : train_dataset[:data_len], train_y : train_labels[:data_len]})
    ls = sess.run(loss_sum ,feed_dict = {train_x : train_dataset[:data_len], train_y : train_labels[:data_len]})

    if step % 100 == 0 : 
        print(&quot;step:&quot;, step, &quot;loss:&quot; ,ls)

prediction = tf.equal(tf.argmax(prob ,1), tf.argmax(train_y, 1))
accuracy = tf.reduce_mean(tf.cast(prediction, &quot;float&quot;))
ac = sess.run(accuracy, feed_dict = {train_x : valid_dataset, train_y : valid_labels})

print(&quot;\n\n accuracy : &quot; , ac)&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Deep Learning&amp;#182;Assignment 1&amp;#182;The objective of this assignment is to learn about simple data curation practices, and familiarize you with some of the data we'll be reusing later. This notebook uses the notMNIST dataset to be used with python experiments. This dataset is designed to look like the classic MNIST dataset, while looking a little more like real data: it's a harder task, and the data is a lot less 'clean' than MNIST. In&amp;nbsp;[1]: # These are all the modules we&amp;#39;ll be using later. Make sure you can import them # before proceeding further. from __future__ import print_function import matplotlib.pyplot as plt import numpy as np import os import sys import tarfile from IPython.display import display, Image from scipy import ndimage from sklearn.linear_model import LogisticRegression from six.moves.urllib.request import urlretrieve from six.moves import cPickle as pickle # Config the matplotlib backend as plotting inline in IPython %matplotlib inline First, we'll download the dataset to our local machine. The data consists of characters rendered in a variety of fonts on a 28x28 image. The labels are limited to 'A' through 'J' (10 classes). The training set has about 500k and the testset 19000 labeled examples. Given these sizes, it should be possible to train models quickly on any machine. In&amp;nbsp;[2]: url = &amp;#39;https://commondatastorage.googleapis.com/books1000/&amp;#39; last_percent_reported = None data_root = &amp;#39;.&amp;#39; # Change me to store data elsewhere def download_progress_hook(count, blockSize, totalSize): &amp;quot;&amp;quot;&amp;quot;A hook to report the progress of a download. This is mostly intended for users with slow internet connections. Reports every 5% change in download progress. &amp;quot;&amp;quot;&amp;quot; global last_percent_reported percent = int(count * blockSize * 100 / totalSize) if last_percent_reported != percent: if percent % 5 == 0: sys.stdout.write(&amp;quot;%s%%&amp;quot; % percent) sys.stdout.flush() else: sys.stdout.write(&amp;quot;.&amp;quot;) sys.stdout.flush() last_percent_reported = percent def maybe_download(filename, expected_bytes, force=False): &amp;quot;&amp;quot;&amp;quot;Download a file if not present, and make sure it&amp;#39;s the right size.&amp;quot;&amp;quot;&amp;quot; dest_filename = os.path.join(data_root, filename) if force or not os.path.exists(dest_filename): print(&amp;#39;Attempting to download:&amp;#39;, filename) filename, _ = urlretrieve(url + filename, dest_filename, reporthook=download_progress_hook) print(&amp;#39;\nDownload Complete!&amp;#39;) statinfo = os.stat(dest_filename) if statinfo.st_size == expected_bytes: print(&amp;#39;Found and verified&amp;#39;, dest_filename) else: raise Exception( &amp;#39;Failed to verify &amp;#39; + dest_filename + &amp;#39;. Can you get to it with a browser?&amp;#39;) return dest_filename train_filename = maybe_download(&amp;#39;notMNIST_large.tar.gz&amp;#39;, 247336696) test_filename = maybe_download(&amp;#39;notMNIST_small.tar.gz&amp;#39;, 8458043) Found and verified ./notMNIST_large.tar.gz Found and verified ./notMNIST_small.tar.gz Extract the dataset from the compressed .tar.gz file. This should give you a set of directories, labeled A through J. In&amp;nbsp;[3]: num_classes = 10 np.random.seed(133) def maybe_extract(filename, force=False): root = os.path.splitext(os.path.splitext(filename)[0])[0] # remove .tar.gz if os.path.isdir(root) and not force: # You may override by setting force=True. print(&amp;#39;%s already present - Skipping extraction of %s.&amp;#39; % (root, filename)) else: print(&amp;#39;Extracting data for %s. This may take a while. Please wait.&amp;#39; % root) tar = tarfile.open(filename) sys.stdout.flush() tar.extractall(data_root) tar.close() data_folders = [ os.path.join(root, d) for d in sorted(os.listdir(root)) if os.path.isdir(os.path.join(root, d))] if len(data_folders) != num_classes: raise Exception( &amp;#39;Expected %d folders, one per class. Found %d instead.&amp;#39; % ( num_classes, len(data_folders))) print(data_folders) return data_folders train_folders = maybe_extract(train_filename) test_folders = maybe_extract(test_filename) ./notMNIST_large already present - Skipping extraction of ./notMNIST_large.tar.gz. [&amp;#39;./notMNIST_large/A&amp;#39;, &amp;#39;./notMNIST_large/B&amp;#39;, &amp;#39;./notMNIST_large/C&amp;#39;, &amp;#39;./notMNIST_large/D&amp;#39;, &amp;#39;./notMNIST_large/E&amp;#39;, &amp;#39;./notMNIST_large/F&amp;#39;, &amp;#39;./notMNIST_large/G&amp;#39;, &amp;#39;./notMNIST_large/H&amp;#39;, &amp;#39;./notMNIST_large/I&amp;#39;, &amp;#39;./notMNIST_large/J&amp;#39;] ./notMNIST_small already present - Skipping extraction of ./notMNIST_small.tar.gz. [&amp;#39;./notMNIST_small/A&amp;#39;, &amp;#39;./notMNIST_small/B&amp;#39;, &amp;#39;./notMNIST_small/C&amp;#39;, &amp;#39;./notMNIST_small/D&amp;#39;, &amp;#39;./notMNIST_small/E&amp;#39;, &amp;#39;./notMNIST_small/F&amp;#39;, &amp;#39;./notMNIST_small/G&amp;#39;, &amp;#39;./notMNIST_small/H&amp;#39;, &amp;#39;./notMNIST_small/I&amp;#39;, &amp;#39;./notMNIST_small/J&amp;#39;] Problem 1&amp;#182;Let's take a peek at some of the data to make sure it looks sensible. Each exemplar should be an image of a character A through J rendered in a different font. Display a sample of the images that we just downloaded. Hint: you can use the package IPython.display. In&amp;nbsp;[4]: png_list = os.listdir(test_folders[0]) for i in range(5) : for j in range(10) : display(Image(test_folders[i]+&amp;#39;/&amp;#39;+png_list[j*100])) Now let's load the data in a more manageable format. Since, depending on your computer setup you might not be able to fit it all in memory, we'll load each class into a separate dataset, store them on disk and curate them independently. Later we'll merge them into a single dataset of manageable size. We'll convert the entire dataset into a 3D array (image index, x, y) of floating point values, normalized to have approximately zero mean and standard deviation ~0.5 to make training easier down the road. A few images might not be readable, we'll just skip them. In&amp;nbsp;[5]: image_size = 28 # Pixel width and height. pixel_depth = 255.0 # Number of levels per pixel. def load_letter(folder, min_num_images): &amp;quot;&amp;quot;&amp;quot;Load the data for a single letter label.&amp;quot;&amp;quot;&amp;quot; image_files = os.listdir(folder) dataset = np.ndarray(shape=(len(image_files), image_size, image_size), dtype=np.float32) print(folder) num_images = 0 for image in image_files: image_file = os.path.join(folder, image) try: image_data = (ndimage.imread(image_file).astype(float) - pixel_depth / 2) / pixel_depth if image_data.shape != (image_size, image_size): raise Exception(&amp;#39;Unexpected image shape: %s&amp;#39; % str(image_data.shape)) dataset[num_images, :, :] = image_data num_images = num_images + 1 except IOError as e: print(&amp;#39;Could not read:&amp;#39;, image_file, &amp;#39;:&amp;#39;, e, &amp;#39;- it\&amp;#39;s ok, skipping.&amp;#39;) dataset = dataset[0:num_images, :, :] if num_images &amp;lt; min_num_images: raise Exception(&amp;#39;Many fewer images than expected: %d &amp;lt; %d&amp;#39; % (num_images, min_num_images)) print(&amp;#39;Full dataset tensor:&amp;#39;, dataset.shape) print(&amp;#39;Mean:&amp;#39;, np.mean(dataset)) print(&amp;#39;Standard deviation:&amp;#39;, np.std(dataset)) return dataset def maybe_pickle(data_folders, min_num_images_per_class, force=False): dataset_names = [] for folder in data_folders: set_filename = folder + &amp;#39;.pickle&amp;#39; dataset_names.append(set_filename) if os.path.exists(set_filename) and not force: # You may override by setting force=True. print(&amp;#39;%s already present - Skipping pickling.&amp;#39; % set_filename) else: print(&amp;#39;Pickling %s.&amp;#39; % set_filename) dataset = load_letter(folder, min_num_images_per_class) try: with open(set_filename, &amp;#39;wb&amp;#39;) as f: pickle.dump(dataset, f, pickle.HIGHEST_PROTOCOL) except Exception as e: print(&amp;#39;Unable to save data to&amp;#39;, set_filename, &amp;#39;:&amp;#39;, e) return dataset_names train_datasets = maybe_pickle(train_folders, 45000) test_datasets = maybe_pickle(test_folders, 1800) ./notMNIST_large/A.pickle already present - Skipping pickling. ./notMNIST_large/B.pickle already present - Skipping pickling. ./notMNIST_large/C.pickle already present - Skipping pickling. ./notMNIST_large/D.pickle already present - Skipping pickling. ./notMNIST_large/E.pickle already present - Skipping pickling. ./notMNIST_large/F.pickle already present - Skipping pickling. ./notMNIST_large/G.pickle already present - Skipping pickling. ./notMNIST_large/H.pickle already present - Skipping pickling. ./notMNIST_large/I.pickle already present - Skipping pickling. ./notMNIST_large/J.pickle already present - Skipping pickling. ./notMNIST_small/A.pickle already present - Skipping pickling. ./notMNIST_small/B.pickle already present - Skipping pickling. ./notMNIST_small/C.pickle already present - Skipping pickling. ./notMNIST_small/D.pickle already present - Skipping pickling. ./notMNIST_small/E.pickle already present - Skipping pickling. ./notMNIST_small/F.pickle already present - Skipping pickling. ./notMNIST_small/G.pickle already present - Skipping pickling. ./notMNIST_small/H.pickle already present - Skipping pickling. ./notMNIST_small/I.pickle already present - Skipping pickling. ./notMNIST_small/J.pickle already present - Skipping pickling. Problem 2&amp;#182;Let's verify that the data still looks good. Displaying a sample of the labels and images from the ndarray. Hint: you can use matplotlib.pyplot. In&amp;nbsp;[6]: pro2_dataset = load_letter(test_folders[0], 10) ./notMNIST_small/A Could not read: ./notMNIST_small/A/RGVtb2NyYXRpY2FCb2xkT2xkc3R5bGUgQm9sZC50dGY=.png : cannot identify image file &amp;#39;./notMNIST_small/A/RGVtb2NyYXRpY2FCb2xkT2xkc3R5bGUgQm9sZC50dGY=.png&amp;#39; - it&amp;#39;s ok, skipping. Full dataset tensor: (1872, 28, 28) Mean: -0.132626 Standard deviation: 0.445128 In&amp;nbsp;[7]: plt.imshow(pro2_dataset[0]) print(pro2_dataset[0]) [[-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.45294118 -0.45686275 -0.49607843 -0.5 -0.46470588 -0.48039216 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.44117647 -0.40980393 -0.17843138 -0.04509804 -0.26078433 -0.1509804 -0.35882354 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49215686 -0.5 -0.2254902 0.11960784 0.26862746 0.5 0.37058824 0.38627452 -0.01372549 -0.37843138 -0.49215686 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49215686 -0.5 -0.32745099 0.06862745 0.30000001 0.5 0.48039216 0.49215686 0.5 0.39411765 0.04509804 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49215686 -0.5 -0.31960785 0.03333334 0.44509804 0.49607843 0.49607843 0.49215686 0.49607843 0.46078432 0.13137256 -0.3392157 -0.48823529 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.48039216 -0.5 -0.17058824 0.49607843 0.49607843 0.49607843 0.5 0.5 0.5 0.44117647 0.4137255 0.00588235 -0.5 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49215686 -0.5 -0.20196079 0.20980392 0.40588236 0.48823529 0.5 0.5 0.5 0.49607843 0.5 0.45686275 0.01764706 -0.37843138 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.48823529 -0.5 0.00980392 0.20588236 0.45686275 0.5 0.48823529 0.48823529 0.5 0.49215686 0.5 0.35882354 0.36666667 -0.26862746 -0.5 -0.48823529 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.48431373 -0.45294118 0.04117647 0.36666667 0.5 0.49607843 0.49215686 0.47254902 0.4254902 0.49215686 0.49607843 0.5 0.42156863 -0.06078431 -0.5 -0.49215686 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.5 -0.49607843 -0.5 -0.31568629 0.23333333 0.5 0.49215686 0.5 0.45294118 0.21764706 0.23333333 0.30000001 0.5 0.49215686 0.49607843 0.06862745 -0.22941177 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.49607843 -0.5 -0.44901961 -0.37450981 0.17058824 0.31176472 0.5 0.49215686 0.5 0.2764706 -0.43333334 -0.10392157 0.22156863 0.44901961 0.5 0.5 0.37843138 0.04901961 -0.34705883 -0.5 -0.49215686 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.49607843 -0.5 -0.36666667 -0.46078432 0.04117647 0.5 0.48431373 0.49607843 0.49215686 0.0254902 -0.49215686 -0.23333333 0.1627451 0.46078432 0.5 0.5 0.46862745 0.10784314 -0.22941177 -0.5 -0.49215686 -0.5 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.48823529 -0.43333334 -0.1509804 0.4254902 0.44901961 0.5 0.5 0.33137256 -0.06078431 -0.42156863 -0.48431373 -0.09607843 0.24509804 0.37450981 0.5 0.5 0.37450981 -0.20196079 -0.44117647 -0.5 -0.49607843 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.48823529 -0.41764706 0.18627451 0.48823529 0.49215686 0.49607843 0.42941177 0.0882353 -0.28823531 -0.5 -0.49215686 -0.36274511 0.1509804 0.45686275 0.49607843 0.5 0.41764706 0.05294118 -0.26862746 -0.5 -0.49607843 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.49607843 -0.5 -0.19803922 0.40588236 0.5 0.5 0.49607843 0.36274511 0.0372549 -0.3509804 -0.5 -0.46862745 -0.37450981 -0.10784314 0.47254902 0.49215686 0.49215686 0.5 0.15490197 -0.37843138 -0.40196079 -0.48431373 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.5 -0.5 -0.38627452 -0.21372549 0.24117647 0.5 0.5 0.42941177 0.21764706 -0.19019608 -0.5 -0.49215686 -0.5 -0.44509804 -0.17058824 0.12352941 0.5 0.49215686 0.48823529 0.5 -0.14705883 -0.44117647 -0.46470588 -0.5 -0.5 -0.5 ] [-0.5 -0.5 -0.49607843 -0.48823529 -0.33137256 0.17450981 0.46470588 0.49607843 0.5 0.46470588 0.29215688 0.06078431 -0.11960784 -0.26078433 -0.04509804 -0.17450981 -0.12745099 0.38235295 0.42941177 0.49215686 0.5 0.47647059 0.22941177 -0.3509804 -0.48431373 -0.5 -0.5 -0.5 ] [-0.5 -0.49607843 -0.5 -0.42156863 -0.1627451 0.35882354 0.49607843 0.5 0.5 0.47254902 0.44117647 0.30784315 0.24117647 0.42941177 0.18627451 0.28823531 0.35882354 0.4254902 0.45294118 0.49607843 0.5 0.48039216 0.43333334 -0.21372549 -0.4254902 -0.5 -0.49607843 -0.5 ] [-0.5 -0.48823529 -0.48823529 -0.31568629 0.10392157 0.42156863 0.5 0.49607843 0.49607843 0.5 0.5 0.5 0.5 0.49607843 0.46078432 0.49215686 0.47647059 0.5 0.5 0.5 0.5 0.48823529 0.5 0.16666667 -0.36666667 -0.48431373 -0.5 -0.5 ] [-0.5 -0.48431373 -0.48431373 -0.07254902 0.38627452 0.39411765 0.5 0.49215686 0.5 0.49607843 0.47647059 0.48823529 0.5 0.49215686 0.49607843 0.49215686 0.5 0.5 0.49215686 0.49215686 0.5 0.48823529 0.5 0.33137256 -0.33137256 -0.45294118 -0.5 -0.5 ] [-0.49607843 -0.5 -0.43333334 -0.00196078 0.47254902 0.45686275 0.5 0.5 0.48431373 0.48039216 0.48039216 0.48431373 0.4137255 0.49215686 0.40980393 0.44901961 0.38627452 0.46862745 0.48823529 0.5 0.49607843 0.49607843 0.5 0.36666667 -0.16666667 -0.4137255 -0.5 -0.49607843] [-0.5 -0.47254902 -0.14313726 0.21764706 0.47647059 0.5 0.49607843 0.47647059 0.06470589 -0.03333334 0.26862746 -0.04509804 -0.17058824 -0.10392157 -0.17058824 0.06470589 0.1 -0.19803922 -0.02156863 0.31176472 0.46470588 0.45294118 0.5 0.49607843 0.26078433 -0.36274511 -0.5 -0.49215686] [-0.48431373 -0.33529413 -0.04901961 0.33137256 0.5 0.48431373 0.5 0.13529412 -0.21372549 -0.36274511 -0.5 -0.46078432 -0.44509804 -0.5 -0.43725491 -0.47647059 -0.36666667 -0.4254902 -0.47647059 -0.01764706 0.23333333 0.38235295 0.5 0.49215686 0.31960785 0.15490197 -0.5 -0.49607843] [-0.44901961 -0.30784315 0.09607843 0.48039216 0.49607843 0.5 0.43333334 0.00980392 -0.29215688 -0.47254902 -0.5 -0.49215686 -0.49607843 -0.48431373 -0.49607843 -0.49607843 -0.5 -0.49215686 -0.5 -0.43725491 0.02156863 0.44509804 0.5 0.5 0.4254902 0.07254902 -0.11960784 -0.48431373] [-0.39803922 -0.12745099 0.3509804 0.5 0.48823529 0.43725491 0.19019608 -0.11176471 -0.43725491 -0.5 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49607843 -0.49607843 -0.48823529 -0.5 -0.25686276 0.39803922 0.42156863 0.49607843 0.48039216 0.36274511 0.00588235 -0.5 ] [-0.33137256 0.21764706 0.48431373 0.5 0.4254902 0.44117647 -0.02156863 -0.40980393 -0.44509804 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49607843 -0.5 -0.41764706 0.1627451 0.44901961 0.45294118 0.5 0.5 -0.00980392 -0.34313726] [-0.33137256 -0.02941176 -0.00588235 0.08431373 0.33137256 0.02156863 -0.40980393 -0.49215686 -0.49215686 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.49607843 -0.5 -0.35490197 -0.2372549 0.19803922 0.29607844 0.01372549 0.20196079 -0.17843138 -0.45294118] [-0.48431373 -0.40196079 -0.37450981 -0.48039216 -0.45294118 -0.46470588 -0.49607843 -0.49607843 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.5 -0.46470588 -0.4254902 -0.48431373 -0.38235295 -0.45686275 -0.46862745 -0.19803922 -0.44901961]] Merge and prune the training data as needed. Depending on your computer setup, you might not be able to fit it all in memory, and you can tune train_size as needed. The labels will be stored into a separate array of integers 0 through 9. Also create a validation dataset for hyperparameter tuning. In&amp;nbsp;[8]: def make_arrays(nb_rows, img_size): if nb_rows: dataset = np.ndarray((nb_rows, img_size, img_size), dtype=np.float32) labels = np.ndarray(nb_rows, dtype=np.int32) else: dataset, labels = None, None return dataset, labels def merge_datasets(pickle_files, train_size, valid_size=0): num_classes = len(pickle_files) valid_dataset, valid_labels = make_arrays(valid_size, image_size) train_dataset, train_labels = make_arrays(train_size, image_size) vsize_per_class = valid_size // num_classes tsize_per_class = train_size // num_classes start_v, start_t = 0, 0 end_v, end_t = vsize_per_class, tsize_per_class end_l = vsize_per_class+tsize_per_class for label, pickle_file in enumerate(pickle_files): try: with open(pickle_file, &amp;#39;rb&amp;#39;) as f: letter_set = pickle.load(f) # let&amp;#39;s shuffle the letters to have random validation and training set np.random.shuffle(letter_set) if valid_dataset is not None: valid_letter = letter_set[:vsize_per_class, :, :] valid_dataset[start_v:end_v, :, :] = valid_letter valid_labels[start_v:end_v] = label start_v += vsize_per_class end_v += vsize_per_class train_letter = letter_set[vsize_per_class:end_l, :, :] train_dataset[start_t:end_t, :, :] = train_letter train_labels[start_t:end_t] = label start_t += tsize_per_class end_t += tsize_per_class except Exception as e: print(&amp;#39;Unable to process data from&amp;#39;, pickle_file, &amp;#39;:&amp;#39;, e) raise return valid_dataset, valid_labels, train_dataset, train_labels train_size = 200000 valid_size = 10000 test_size = 10000 valid_dataset, valid_labels, train_dataset, train_labels = merge_datasets( train_datasets, train_size, valid_size) _, _, test_dataset, test_labels = merge_datasets(test_datasets, test_size) print(&amp;#39;Training:&amp;#39;, train_dataset.shape, train_labels.shape) print(&amp;#39;Validation:&amp;#39;, valid_dataset.shape, valid_labels.shape) print(&amp;#39;Testing:&amp;#39;, test_dataset.shape, test_labels.shape) Training: (200000, 28, 28) (200000,) Validation: (10000, 28, 28) (10000,) Testing: (10000, 28, 28) (10000,) Problem 3&amp;#182;Another check: we expect the data to be balanced across classes. Verify that. In&amp;nbsp;[9]: from collections import Counter Counter(train_labels), Counter(test_labels), Counter(valid_labels) Out[9]: (Counter({0: 20000, 1: 20000, 2: 20000, 3: 20000, 4: 20000, 5: 20000, 6: 20000, 7: 20000, 8: 20000, 9: 20000}), Counter({0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 1000, 6: 1000, 7: 1000, 8: 1000, 9: 1000}), Counter({0: 1000, 1: 1000, 2: 1000, 3: 1000, 4: 1000, 5: 1000, 6: 1000, 7: 1000, 8: 1000, 9: 1000})) Next, we'll randomize the data. It's important to have the labels well shuffled for the training and test distributions to match. In&amp;nbsp;[10]: def randomize(dataset, labels): permutation = np.random.permutation(labels.shape[0]) shuffled_dataset = dataset[permutation,:,:] shuffled_labels = labels[permutation] return shuffled_dataset, shuffled_labels train_dataset, train_labels = randomize(train_dataset, train_labels) test_dataset, test_labels = randomize(test_dataset, test_labels) valid_dataset, valid_labels = randomize(valid_dataset, valid_labels) Problem 4&amp;#182;Convince yourself that the data is still good after shuffling! In&amp;nbsp;[11]: test_labels.shape Out[11]: (10000,) Finally, let's save the data for later reuse: In&amp;nbsp;[12]: pickle_file = os.path.join(data_root, &amp;#39;notMNIST.pickle&amp;#39;) try: f = open(pickle_file, &amp;#39;wb&amp;#39;) save = { &amp;#39;train_dataset&amp;#39;: train_dataset, &amp;#39;train_labels&amp;#39;: train_labels, &amp;#39;valid_dataset&amp;#39;: valid_dataset, &amp;#39;valid_labels&amp;#39;: valid_labels, &amp;#39;test_dataset&amp;#39;: test_dataset, &amp;#39;test_labels&amp;#39;: test_labels, } pickle.dump(save, f, pickle.HIGHEST_PROTOCOL) f.close() except Exception as e: print(&amp;#39;Unable to save data to&amp;#39;, pickle_file, &amp;#39;:&amp;#39;, e) raise In&amp;nbsp;[13]: statinfo = os.stat(pickle_file) print(&amp;#39;Compressed pickle size:&amp;#39;, statinfo.st_size) Compressed pickle size: 690800512 Problem 5&amp;#182;By construction, this dataset might contain a lot of overlapping samples, including training data that's also contained in the validation and test set! Overlap between training and test can skew the results if you expect to use your model in an environment where there is never an overlap, but are actually ok if you expect to see training samples recur when you use it. Measure how much overlap there is between training, validation and test samples. Optional questions: What about near duplicates between datasets? (images that are almost identical) Create a sanitized validation and test set, and compare your accuracy on those in subsequent assignments. In&amp;nbsp;[14]: print(train_dataset.shape) print(train_labels.shape) print(valid_dataset.shape) print(valid_labels.shape) print(test_dataset.shape) print(test_labels.shape) print(train_labels[0:20]) (200000, 28, 28) (200000,) (10000, 28, 28) (10000,) (10000, 28, 28) (10000,) [4 9 6 2 7 3 5 9 6 4 7 6 0 1 8 0 1 9 6 5] Problem 6&amp;#182;Let's get an idea of what an off-the-shelf classifier can give you on this data. It's always good to check that there is something to learn, and that it's a problem that is not so trivial that a canned solution solves it. Train a simple model on this data using 50, 100, 1000 and 5000 training samples. Hint: you can use the LogisticRegression model from sklearn.linear_model. Optional question: train an off-the-shelf model on all the data! In&amp;nbsp;[15]: import tensorflow as tf In&amp;nbsp;[16]: def one_hot(datas, classes = 10) : result = list() for data in datas : encoded = list(0 for _ in range(classes)) encoded[int(data)] = 1 result.append(encoded) return np.array(result) In&amp;nbsp;[17]: y = one_hot(test_labels) for i in range(20): print(test_labels[i],y[i]) 3 [0 0 0 1 0 0 0 0 0 0] 6 [0 0 0 0 0 0 1 0 0 0] 4 [0 0 0 0 1 0 0 0 0 0] 7 [0 0 0 0 0 0 0 1 0 0] 7 [0 0 0 0 0 0 0 1 0 0] 7 [0 0 0 0 0 0 0 1 0 0] 7 [0 0 0 0 0 0 0 1 0 0] 1 [0 1 0 0 0 0 0 0 0 0] 7 [0 0 0 0 0 0 0 1 0 0] 4 [0 0 0 0 1 0 0 0 0 0] 6 [0 0 0 0 0 0 1 0 0 0] 0 [1 0 0 0 0 0 0 0 0 0] 9 [0 0 0 0 0 0 0 0 0 1] 0 [1 0 0 0 0 0 0 0 0 0] 0 [1 0 0 0 0 0 0 0 0 0] 2 [0 0 1 0 0 0 0 0 0 0] 2 [0 0 1 0 0 0 0 0 0 0] 8 [0 0 0 0 0 0 0 0 1 0] 2 [0 0 1 0 0 0 0 0 0 0] 9 [0 0 0 0 0 0 0 0 0 1] In&amp;nbsp;[18]: train_dataset = np.reshape(train_dataset, (200000, -1)) train_labels = one_hot(train_labels) valid_dataset = np.reshape(valid_dataset, (10000, -1)) valid_labels = one_hot(valid_labels) In&amp;nbsp;[19]: print(train_dataset.shape, train_labels.shape) (200000, 784) (200000, 10) In&amp;nbsp;[20]: # HyperParameters data_len = 100000 learning_rate = 0.0001 total_steps = 15000 # Hyperparameters for Stochastic Gradient Descent mini_batch_size = 2000 train_size = train_dataset.shape[0] # Feed train_x = tf.placeholder(shape = [None , 784] , dtype =tf.float32 ) train_y = tf.placeholder(shape = [None, 10] , dtype = tf.float32 ) In&amp;nbsp;[21]: # Neural Network Model with tf.variable_scope(&amp;quot;layer_1&amp;quot;) as scope : w1 = tf.get_variable(name=&amp;quot;w1&amp;quot;, shape = (784, 50), initializer = tf.random_normal_initializer(mean = 0.0, stddev = 0.01)) b1 = tf.get_variable(name=&amp;quot;b1&amp;quot;, shape =(50), initializer=tf.random_normal_initializer(mean = 0.0, stddev = 0.01)) with tf.variable_scope(&amp;quot;layer_2&amp;quot;) as scope : w2 = tf.get_variable(name=&amp;quot;w2&amp;quot;, shape = (50, 10), initializer = tf.random_normal_initializer(mean = 0.0, stddev = 0.01)) b2 = tf.get_variable(name=&amp;quot;b2&amp;quot;, shape =(10), initializer=tf.random_normal_initializer(mean = 0.0, stddev = 0.01)) In&amp;nbsp;[22]: #operations layer1 = tf.nn.relu( tf.add(tf.matmul(train_x, w1) , b1) ) logits = tf.add(tf.matmul(layer1, w2), b2) prob = tf.nn.softmax(logits) loss = tf.nn.softmax_cross_entropy_with_logits(labels = train_y , logits = logits) #tf.reduce_sum(tf.square(prob - train_y)) loss_sum = tf.reduce_sum(loss) optimizer = tf.train.GradientDescentOptimizer(learning_rate = learning_rate) training = optimizer.minimize(loss_sum) init = tf.global_variables_initializer() In&amp;nbsp;[23]: loss_log = list() step_log = list() with tf.Session() as sess : sess.run(init) for step in range(total_steps) : #stochastic gradient descent #mini_batch 획득 batch_mask = np.random.choice(train_size, mini_batch_size) mini_batch_dataset = train_dataset[batch_mask] mini_batch_labels = train_labels[batch_mask] #획득한 mini_batch 만을 통해 gradient descent 실행해 W,b parameter update sess.run(training, feed_dict ={train_x : mini_batch_dataset, train_y : mini_batch_labels } ) ls = sess.run(loss_sum , feed_dict = {train_x : mini_batch_dataset, train_y : mini_batch_labels}) loss_log.append(ls) step_log.append(step) if step % 100 == 0 : print(&amp;quot;step :&amp;quot; , step, &amp;quot; loss in current mini_batch : &amp;quot; ,ls) print(&amp;quot;Finish stochastic gradient descent Optimization !&amp;quot;) prediction = tf.equal(tf.argmax(prob, 1), tf.argmax(train_y , 1)) accuracy = tf.reduce_mean(tf.cast(prediction, &amp;quot;float&amp;quot;)) ac = sess.run(accuracy , feed_dict = {train_x : valid_dataset , train_y : valid_labels}) print(&amp;quot;Accuracy for validation set:&amp;quot;, ac) step : 0 loss in current mini_batch : 4601.67 step : 100 loss in current mini_batch : 1326.26 step : 200 loss in current mini_batch : 1195.37 step : 300 loss in current mini_batch : 1190.59 step : 400 loss in current mini_batch : 1132.75 step : 500 loss in current mini_batch : 1044.28 step : 600 loss in current mini_batch : 1068.86 step : 700 loss in current mini_batch : 974.242 step : 800 loss in current mini_batch : 1004.78 step : 900 loss in current mini_batch : 965.052 step : 1000 loss in current mini_batch : 1032.54 step : 1100 loss in current mini_batch : 948.49 step : 1200 loss in current mini_batch : 992.098 step : 1300 loss in current mini_batch : 898.133 step : 1400 loss in current mini_batch : 937.777 step : 1500 loss in current mini_batch : 907.827 step : 1600 loss in current mini_batch : 965.427 step : 1700 loss in current mini_batch : 918.821 step : 1800 loss in current mini_batch : 862.558 step : 1900 loss in current mini_batch : 920.642 step : 2000 loss in current mini_batch : 908.376 step : 2100 loss in current mini_batch : 952.623 step : 2200 loss in current mini_batch : 922.263 step : 2300 loss in current mini_batch : 759.279 step : 2400 loss in current mini_batch : 884.643 step : 2500 loss in current mini_batch : 820.881 step : 2600 loss in current mini_batch : 895.333 step : 2700 loss in current mini_batch : 813.88 step : 2800 loss in current mini_batch : 837.536 step : 2900 loss in current mini_batch : 761.909 step : 3000 loss in current mini_batch : 796.58 step : 3100 loss in current mini_batch : 831.549 step : 3200 loss in current mini_batch : 762.656 step : 3300 loss in current mini_batch : 704.09 step : 3400 loss in current mini_batch : 755.157 step : 3500 loss in current mini_batch : 753.041 step : 3600 loss in current mini_batch : 757.668 step : 3700 loss in current mini_batch : 717.796 step : 3800 loss in current mini_batch : 680.764 step : 3900 loss in current mini_batch : 722.954 step : 4000 loss in current mini_batch : 729.337 step : 4100 loss in current mini_batch : 716.981 step : 4200 loss in current mini_batch : 776.64 step : 4300 loss in current mini_batch : 704.61 step : 4400 loss in current mini_batch : 717.521 step : 4500 loss in current mini_batch : 747.119 step : 4600 loss in current mini_batch : 720.399 step : 4700 loss in current mini_batch : 723.838 step : 4800 loss in current mini_batch : 728.95 step : 4900 loss in current mini_batch : 768.013 step : 5000 loss in current mini_batch : 762.636 step : 5100 loss in current mini_batch : 674.274 step : 5200 loss in current mini_batch : 725.508 step : 5300 loss in current mini_batch : 644.987 step : 5400 loss in current mini_batch : 700.892 step : 5500 loss in current mini_batch : 712.414 step : 5600 loss in current mini_batch : 686.918 step : 5700 loss in current mini_batch : 729.377 step : 5800 loss in current mini_batch : 659.036 step : 5900 loss in current mini_batch : 717.935 step : 6000 loss in current mini_batch : 717.452 step : 6100 loss in current mini_batch : 751.168 step : 6200 loss in current mini_batch : 624.755 step : 6300 loss in current mini_batch : 671.416 step : 6400 loss in current mini_batch : 714.373 step : 6500 loss in current mini_batch : 692.471 step : 6600 loss in current mini_batch : 657.005 step : 6700 loss in current mini_batch : 664.928 step : 6800 loss in current mini_batch : 748.706 step : 6900 loss in current mini_batch : 708.959 step : 7000 loss in current mini_batch : 689.302 step : 7100 loss in current mini_batch : 576.379 step : 7200 loss in current mini_batch : 633.845 step : 7300 loss in current mini_batch : 634.733 step : 7400 loss in current mini_batch : 633.668 step : 7500 loss in current mini_batch : 651.758 step : 7600 loss in current mini_batch : 682.321 step : 7700 loss in current mini_batch : 693.369 step : 7800 loss in current mini_batch : 692.234 step : 7900 loss in current mini_batch : 669.476 step : 8000 loss in current mini_batch : 682.369 step : 8100 loss in current mini_batch : 625.788 step : 8200 loss in current mini_batch : 677.573 step : 8300 loss in current mini_batch : 657.304 step : 8400 loss in current mini_batch : 661.556 step : 8500 loss in current mini_batch : 651.978 step : 8600 loss in current mini_batch : 605.606 step : 8700 loss in current mini_batch : 595.129 step : 8800 loss in current mini_batch : 605.027 step : 8900 loss in current mini_batch : 632.582 step : 9000 loss in current mini_batch : 688.383 step : 9100 loss in current mini_batch : 635.524 step : 9200 loss in current mini_batch : 660.438 step : 9300 loss in current mini_batch : 593.719 step : 9400 loss in current mini_batch : 655.906 step : 9500 loss in current mini_batch : 641.276 step : 9600 loss in current mini_batch : 620.561 step : 9700 loss in current mini_batch : 639.464 step : 9800 loss in current mini_batch : 713.408 step : 9900 loss in current mini_batch : 635.882 step : 10000 loss in current mini_batch : 616.373 step : 10100 loss in current mini_batch : 635.377 step : 10200 loss in current mini_batch : 617.724 step : 10300 loss in current mini_batch : 651.883 step : 10400 loss in current mini_batch : 624.633 step : 10500 loss in current mini_batch : 689.182 step : 10600 loss in current mini_batch : 643.464 step : 10700 loss in current mini_batch : 632.735 step : 10800 loss in current mini_batch : 657.008 step : 10900 loss in current mini_batch : 727.608 step : 11000 loss in current mini_batch : 604.399 step : 11100 loss in current mini_batch : 678.079 step : 11200 loss in current mini_batch : 602.736 step : 11300 loss in current mini_batch : 628.098 step : 11400 loss in current mini_batch : 631.935 step : 11500 loss in current mini_batch : 486.739 step : 11600 loss in current mini_batch : 600.978 step : 11700 loss in current mini_batch : 661.016 step : 11800 loss in current mini_batch : 658.212 step : 11900 loss in current mini_batch : 591.686 step : 12000 loss in current mini_batch : 561.555 step : 12100 loss in current mini_batch : 590.612 step : 12200 loss in current mini_batch : 625.416 step : 12300 loss in current mini_batch : 631.534 step : 12400 loss in current mini_batch : 576.341 step : 12500 loss in current mini_batch : 561.747 step : 12600 loss in current mini_batch : 610.397 step : 12700 loss in current mini_batch : 646.197 step : 12800 loss in current mini_batch : 571.696 step : 12900 loss in current mini_batch : 597.438 step : 13000 loss in current mini_batch : 571.774 step : 13100 loss in current mini_batch : 605.854 step : 13200 loss in current mini_batch : 587.422 step : 13300 loss in current mini_batch : 629.188 step : 13400 loss in current mini_batch : 580.812 step : 13500 loss in current mini_batch : 618.708 step : 13600 loss in current mini_batch : 601.535 step : 13700 loss in current mini_batch : 592.996 step : 13800 loss in current mini_batch : 513.31 step : 13900 loss in current mini_batch : 573.671 step : 14000 loss in current mini_batch : 568.322 step : 14100 loss in current mini_batch : 534.002 step : 14200 loss in current mini_batch : 530.757 step : 14300 loss in current mini_batch : 596.364 step : 14400 loss in current mini_batch : 617.588 step : 14500 loss in current mini_batch : 612.434 step : 14600 loss in current mini_batch : 544.609 step : 14700 loss in current mini_batch : 573.086 step : 14800 loss in current mini_batch : 658.637 step : 14900 loss in current mini_batch : 682.304 Finish stochastic gradient descent Optimization ! Accuracy for validation set: 0.8785 In&amp;nbsp;[24]: #show loss changes plt.plot(step_log[:10000], loss_log[:10000], &amp;quot;r&amp;quot;) plt.ylabel(&amp;quot;loss&amp;quot;) plt.show() Run the model&amp;#182;with tf.Session() as sess : sess.run(init) for step in range(3000) : sess.run(training ,feed_dict = {train_x : train_dataset[:data_len], train_y : train_labels[:data_len]}) ls = sess.run(loss_sum ,feed_dict = {train_x : train_dataset[:data_len], train_y : train_labels[:data_len]}) if step % 100 == 0 : print(&quot;step:&quot;, step, &quot;loss:&quot; ,ls) prediction = tf.equal(tf.argmax(prob ,1), tf.argmax(train_y, 1)) accuracy = tf.reduce_mean(tf.cast(prediction, &quot;float&quot;)) ac = sess.run(accuracy, feed_dict = {train_x : valid_dataset, train_y : valid_labels}) print(&quot;\n\n accuracy : &quot; , ac)</summary></entry></feed>