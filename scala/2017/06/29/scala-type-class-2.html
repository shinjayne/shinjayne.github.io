
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Analytics js-->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-101872700-1', 'auto');
    ga('send', 'pageview');
  </script>

  <!-- code highlight js / css-->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- BootStrap js / css-->
    <link href="/bootstrap-3.3.2/css/bootstrap.css" rel="stylesheet">
    <!-- jQuery (부트스트랩의 자바스크립트 플러그인을 위해 필요합니다) -->
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
     <!-- 모든 컴파일된 플러그인을 포함합니다 (아래), 원하지 않는다면 필요한 각각의 파일을 포함하세요 -->
     <script src="/bootstrap-3.3.2/js/bootstrap.js"></script>

    <!-- JUPYTER NOTEBOOK js / css-->

     <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

     <link href="/jupyterstyle/jupyterstyle.css" rel="stylesheet">


  <!-- Semantic UI js / css-->
    <link rel="stylesheet" type="text/css" href="/semantic/semantic.css">
    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="/semantic/semantic.js"></script>




    <title>Scala 의 Type Class 코드로 살펴보기 2</title>

  </head>
  <body>

    <div class = "ui container">

      <div class="ui top fixed menu">
        <div class="item">
          shinjayne
        </div>
        <h5> <a class="item" href = "https://shinjayne.github.io/">Home</a> </h5>
        <h5> <a class="item" href = "https://shinjayne.github.io//category">Categories</a> </h5>
        <h5> <a class="item" href = "https://shinjayne.github.io//about">About</a> </h5>
      </div>

      <div class="ui grid">
        <div class="two wide column">

        </div>

        <div class="twelve wide column">
          <img class="ui fluid rounded image" src="/pangyo_long.jpeg" >
        </div>

        <div class="two wide column">

        </div>

        <div class="two wide column">

</div>

<div class="twelve wide column">
  <div class = "ui segment">
    <h1>Scala 의 Type Class 코드로 살펴보기 2</h1>

    <li>
      작성일 : 29 June 2017
    </li>
    <li>
      카테고리 : <a href = "https://shinjayne.github.io//category">Scala</a>
    </li>
  </div>

  <div class = "ui segment">
    
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Turning-Type-Classes-into-OO-Classes">1. Turning Type Classes into OO Classes<a class="anchor-link" href="#1.-Turning-Type-Classes-into-OO-Classes">&#182;</a></h1><p><br/>
<br/>
<br/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Iter</span><span class="o">[</span><span class="kt">I</span>,<span class="kt">A</span><span class="o">]{</span>
    <span class="k">def</span> <span class="n">getValue</span><span class="o">(</span><span class="n">i</span> <span class="k">:</span> <span class="kt">I</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
    <span class="k">def</span> <span class="n">getNext</span><span class="o">(</span><span class="n">i</span> <span class="k">:</span> <span class="kt">I</span><span class="o">)</span> <span class="k">:</span> <span class="kt">I</span> 
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Iter</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">implicit</span> <span class="k">def</span> <span class="nc">ListIter</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">:</span> <span class="kt">Iter</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>, <span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Iter</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>, <span class="kt">A</span><span class="o">]{</span>
    <span class="k">def</span> <span class="n">getValue</span><span class="o">(</span><span class="n">i</span> <span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">i</span><span class="o">.</span><span class="n">headOption</span>
    <span class="k">def</span> <span class="n">getNext</span><span class="o">(</span> <span class="n">i</span> <span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">i</span><span class="o">.</span><span class="n">tail</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[2]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">ListIter</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">def</span> <span class="n">sumElements</span><span class="o">[</span><span class="kt">I</span><span class="o">](</span><span class="n">xs</span> <span class="k">:</span> <span class="kt">I</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">proxy</span> <span class="k">:</span> <span class="kt">Iter</span><span class="o">[</span><span class="kt">I</span>, <span class="kt">Int</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">getValue</span><span class="o">(</span><span class="n">xs</span><span class="o">)</span> <span class="k">match</span><span class="o">{</span>
    <span class="k">case</span> <span class="nc">None</span> <span class="k">=&gt;</span> <span class="mi">0</span> 
    <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="n">sumElement</span><span class="o">(</span><span class="n">proxy</span><span class="o">.</span><span class="n">getNext</span><span class="o">(</span><span class="n">xs</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">printElements</span><span class="o">[</span><span class="kt">I</span>, <span class="kt">X</span><span class="o">](</span><span class="n">xs</span> <span class="k">:</span> <span class="kt">I</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">proxy</span> <span class="k">:</span> <span class="kt">Iter</span><span class="o">[</span><span class="kt">I</span>, <span class="kt">X</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">getValue</span><span class="o">(</span><span class="n">xs</span><span class="o">)</span> <span class="k">match</span><span class="o">{</span>
    <span class="k">case</span> <span class="nc">None</span> <span class="k">=&gt;</span> 
    <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span><span class="n">println</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">;</span> <span class="n">printElements</span><span class="o">(</span><span class="n">proxy</span><span class="o">.</span><span class="n">getNext</span><span class="o">(</span><span class="n">xs</span><span class="o">))</span> <span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[5]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">sumElements</span>
defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">printElements</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">val</span> <span class="n">I</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">sumElements</span><span class="o">(</span><span class="n">I</span><span class="o">)</span>
<span class="n">printElements</span><span class="o">(</span><span class="n">I</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>3
4
5
1
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-cyan-fg">I</span>: <span class="ansi-green-fg">List</span>[<span class="ansi-green-fg">Int</span>] = <span class="ansi-yellow-fg">List</span>(<span class="ansi-green-fg">3</span>, <span class="ansi-green-fg">4</span>, <span class="ansi-green-fg">5</span>, <span class="ansi-green-fg">1</span>)
<span class="ansi-cyan-fg">res5_1</span>: <span class="ansi-green-fg">Int</span> = <span class="ansi-green-fg">13</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">import</span> <span class="nn">scala.language.higherKinds</span>
<span class="k">import</span> <span class="nn">scala.language.implicitConversions</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Dyn2</span><span class="o">[</span><span class="kt">S</span><span class="o">[</span><span class="k">_</span>,<span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">]{</span>
    <span class="k">type</span> <span class="kt">Data</span>
    <span class="k">val</span> <span class="n">d</span><span class="k">:</span> <span class="kt">Data</span>
    <span class="k">val</span> <span class="n">i</span> <span class="k">:</span> <span class="kt">S</span><span class="o">[</span><span class="kt">Data</span>, <span class="kt">A</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Dyn2</span> <span class="o">{</span>
    <span class="c1">// 실제 동작 함수. ii 에 incIter 동작 인스턴스가 들어가고</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="n">apply</span><span class="o">[</span><span class="kt">S</span><span class="o">[</span><span class="k">_</span>,<span class="k">_</span><span class="o">]</span>,<span class="kt">D</span>,<span class="kt">A</span><span class="o">](</span><span class="n">dd</span> <span class="k">:</span> <span class="kt">D</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">ii</span> <span class="k">:</span> <span class="kt">S</span><span class="o">[</span><span class="kt">D</span>,<span class="kt">A</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Dyn2</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">A</span><span class="o">]{</span>
        <span class="k">type</span> <span class="kt">Data</span> <span class="o">=</span> <span class="n">D</span>
        <span class="k">val</span> <span class="n">d</span> <span class="k">:</span> <span class="kt">Data</span> <span class="o">=</span> <span class="n">dd</span>
        <span class="k">val</span> <span class="n">i</span> <span class="k">:</span> <span class="kt">S</span><span class="o">[</span><span class="kt">Data</span>, <span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">ii</span> 
    <span class="o">}</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="n">methods</span><span class="o">[</span><span class="kt">S</span><span class="o">[</span><span class="k">_</span>,<span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">d</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">A</span><span class="o">])</span> <span class="k">:</span> <span class="kt">S</span><span class="o">[</span><span class="kt">d.Data</span>, <span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">d</span><span class="o">.</span><span class="n">i</span>
<span class="o">}</span>


<span class="cm">/*********************************************************************</span>
<span class="cm">&lt;&lt;  Dyn2 인스턴스 는 &lt;타입클래스 정보 S &gt; &lt;반환할 데이터 타입 A&gt; 로 초기화하고  </span>
<span class="cm">    &lt;타입 클래스가 다룰 데이터 구조 D&gt;를 입력받는다.    &gt;&gt;&gt;   </span>
<span class="cm">    </span>
<span class="cm">    val  x : Dyn2[S,A](D)  &gt;&gt;&gt;  x.d = 데이터구조 (주인공)  </span>
<span class="cm">                                    x.i = 타입클래스 인스턴스 정보( 실행기 ) </span>
<span class="cm">    </span>
<span class="cm">    &lt;Dyn2 인스턴스 x&gt; 를 만들면 무엇을 할 수 있는가? </span>
<span class="cm">    x : Dyn2[Iter, Int]  =  Dyn2(List(1,2,3))   </span>
<span class="cm">    y : Dyn2[Iter, Int]  = Dyn2(MyNode(1, Empty(), Empty()))   </span>
<span class="cm">    각각의 x, y 에 안에 들어있는 데이터구조와 타입클래스 인스턴스 정보로, Iter 타입클래스로 구현된 메서드를 모두 사용 가능하다. </span>
<span class="cm">    </span>
<span class="cm">    Iter type class 의  interface method 들 </span>
<span class="cm">    </span>
<span class="cm">    sumElements(x.d)(x.i)</span>
<span class="cm">    printElements(y.d)(y.i)</span>
<span class="cm"> </span>



<span class="cm">***********************************************************************/</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">scala.language.higherKinds
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">scala.language.implicitConversions

</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Dyn2</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Dyn2</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="c1">// type class 인스턴스  .... Int 데이터구조 들어왔을때  동작을 기술함 ... 하지만 직접 넣어줄 것이기 때문에 implicit 적지 않았다.</span>
<span class="k">def</span> <span class="n">incIter</span><span class="o">(</span><span class="n">max</span> <span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Iter</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Iter</span><span class="o">[</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">getValue</span><span class="o">(</span><span class="n">i</span> <span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">max</span><span class="o">)</span> <span class="nc">Some</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="k">else</span> <span class="nc">None</span>
    <span class="k">def</span> <span class="n">getNext</span><span class="o">(</span><span class="n">i</span> <span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> 
<span class="o">}</span>

<span class="c1">// Dyn2 인스턴스를 생성해내는 방법 </span>
<span class="c1">// getMyIter</span>
<span class="k">def</span> <span class="n">getMyIter</span><span class="o">(</span><span class="n">isInc</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">Iter</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span> <span class="c1">//Dyn2[Iter, Int] 로 초기화한다. </span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isInc</span><span class="o">)</span> <span class="nc">Dyn2</span><span class="o">(</span><span class="mi">0</span><span class="o">)(</span><span class="n">incIter</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span> <span class="c1">//Dyn2.apply(0)(incIter(10))   // Dyn2(0) Int라는 데이터구조 를 다룬다. </span>
    <span class="k">else</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>  <span class="c1">// Dyn2.apply(List(3,1,5))(listIter[Int])   // Dyn2(List[Int])   List[Int] 라는 데이터구조를 다룬다. </span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">incIter</span>
defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">getMyIter</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">val</span> <span class="n">i1</span>  <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">Iter</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">getMyIter</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="n">printElements</span><span class="o">(</span><span class="n">i1</span><span class="o">.</span><span class="n">d</span><span class="o">)(</span><span class="n">i1</span><span class="o">.</span><span class="n">i</span><span class="o">)</span>  <span class="c1">//printElements(0)(incIter(10))</span>

<span class="k">val</span> <span class="n">i2</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">Iter</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">getMyIter</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
<span class="n">printElements</span><span class="o">(</span><span class="n">i2</span><span class="o">.</span><span class="n">d</span><span class="o">)(</span><span class="n">i2</span><span class="o">.</span><span class="n">i</span><span class="o">)</span> <span class="c1">//printElements()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0
1
2
3
4
5
6
7
8
9
10
3
1
5
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>


<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-cyan-fg">i1</span>: <span class="ansi-green-fg">Dyn2</span>[<span class="ansi-green-fg">Iter</span>, <span class="ansi-green-fg">Int</span>] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@74086131
<span class="ansi-cyan-fg">i2</span>: <span class="ansi-green-fg">Dyn2</span>[<span class="ansi-green-fg">Iter</span>, <span class="ansi-green-fg">Int</span>] = $sess.cmd6Wrapper$Helper$Dyn2$$anon$1@67d4c1f6</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Dyn</span><span class="o">[</span><span class="kt">T</span><span class="o">[</span><span class="k">_</span><span class="o">]]{</span>
    <span class="k">type</span> <span class="kt">Data</span> 
    <span class="k">val</span> <span class="n">d</span> <span class="k">:</span> <span class="kt">Data</span>
    <span class="k">val</span> <span class="n">proxy</span> <span class="k">:</span> <span class="kt">T</span><span class="o">[</span><span class="kt">Data</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">Dyn</span><span class="o">{</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="n">apply</span><span class="o">[</span><span class="kt">D</span>, <span class="kt">T</span><span class="o">[</span><span class="k">_</span><span class="o">]](</span><span class="n">dd</span> <span class="k">:</span> <span class="kt">D</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">tt</span> <span class="k">:</span> <span class="kt">T</span><span class="o">[</span><span class="kt">D</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Dyn</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Dyn</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
        
        <span class="k">type</span> <span class="kt">Data</span> <span class="o">=</span> <span class="n">D</span>
        <span class="k">val</span> <span class="n">d</span> <span class="k">:</span> <span class="kt">Data</span> <span class="o">=</span> <span class="n">dd</span>
        <span class="k">val</span> <span class="n">proxy</span> <span class="k">:</span> <span class="kt">T</span><span class="o">[</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="n">tt</span> 
        
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[18]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Dyn</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Dyn</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="c1">// 데이터 구조 정보 </span>

<span class="k">sealed</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">MyTree</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
<span class="nc">case</span> <span class="k">class</span> <span class="nc">Empty</span><span class="o">[</span><span class="kt">A</span><span class="o">]()</span> <span class="k">extends</span> <span class="nc">MyTree</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">Node</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">value</span> <span class="k">:</span> <span class="kt">A</span><span class="o">,</span> <span class="n">left</span> <span class="k">:</span> <span class="kt">MyTree</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">right</span> <span class="k">:</span> <span class="kt">MyTree</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">MyTree</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[20]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">MyTree</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Empty</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Node</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="type-class-&#48376;&#52404;">type class &#48376;&#52404;<a class="anchor-link" href="#type-class-&#48376;&#52404;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="c1">// 데이터 구조 R 를 다루는 type class 본체  </span>
<span class="c1">// iter 메서드는 Dyn2</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Iterable</span><span class="o">[</span><span class="kt">R</span>,<span class="kt">A</span><span class="o">]{</span>
    <span class="k">def</span> <span class="n">iter</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">R</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">Iter</span> , <span class="kt">A</span><span class="o">]</span> <span class="c1">// 데이터구조 R 을 넣으면 R 을 다루는 Dyn2[Iter, A](R) 를 돌려줄 것이다. </span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Iterable</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="type-class-&#51064;&#49828;&#53556;&#49828;">type class &#51064;&#49828;&#53556;&#49828;<a class="anchor-link" href="#type-class-&#51064;&#49828;&#53556;&#49828;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">implicit</span> <span class="k">def</span> <span class="n">treeIterable</span> <span class="k">:</span> <span class="kt">Iterable</span><span class="o">[</span><span class="kt">MyTree</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Iterable</span><span class="o">[</span><span class="kt">MyTree</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>, <span class="kt">Int</span><span class="o">]{</span>
    <span class="k">def</span> <span class="n">iter</span><span class="o">(</span><span class="n">a</span> <span class="k">:</span> <span class="kt">MyTree</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">:</span> <span class="kt">Dyn2</span><span class="o">[</span><span class="kt">Iter</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
        <span class="k">def</span> <span class="n">go</span><span class="o">(</span><span class="n">I</span> <span class="k">:</span> <span class="kt">MyTree</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">I</span> <span class="k">match</span><span class="o">{</span>
            <span class="k">case</span> <span class="nc">Empty</span><span class="o">()</span> <span class="k">=&gt;</span> <span class="nc">Nil</span> 
            <span class="k">case</span> <span class="nc">Node</span><span class="o">(</span><span class="n">v</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">right</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">v</span> <span class="o">::</span> <span class="o">(</span><span class="n">go</span><span class="o">(</span><span class="n">left</span><span class="o">)</span> <span class="o">++</span> <span class="n">go</span><span class="o">(</span><span class="n">right</span><span class="o">))</span> 
        <span class="o">}</span>
        <span class="n">go</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>   <span class="c1">// List[Int]   --&gt; Dyn2[Iter, Int](List[Int]) --&gt; Dyn2[Iter,Int](List[Int])(listIter(List[Int], Int))</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">treeIterable</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="type-class-&#51064;&#53552;&#54168;&#51060;&#49828;-(&#49324;&#50857;)">type class &#51064;&#53552;&#54168;&#51060;&#49828; (&#49324;&#50857;)<a class="anchor-link" href="#type-class-&#51064;&#53552;&#54168;&#51060;&#49828;-(&#49324;&#50857;)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">def</span> <span class="n">sumElements2</span><span class="o">[</span><span class="kt">R</span><span class="o">](</span><span class="n">xs</span> <span class="k">:</span> <span class="kt">R</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">proxy</span> <span class="k">:</span> <span class="kt">Iterable</span><span class="o">[</span><span class="kt">R</span>, <span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">cs</span> <span class="k">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">iter</span><span class="o">(</span><span class="n">xs</span><span class="o">)</span>  <span class="c1">// Dyn2[Iter, Int](Iter 로 다룰수 있게 변형된 xs)</span>
    <span class="n">sumElements</span><span class="o">(</span><span class="n">cs</span><span class="o">.</span><span class="n">d</span><span class="o">)(</span><span class="n">cs</span><span class="o">.</span><span class="n">i</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">sumElements2</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">val</span> <span class="n">t</span> <span class="k">:</span> <span class="kt">MyTree</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Node</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Empty</span><span class="o">(),</span> <span class="nc">Empty</span><span class="o">())</span>
<span class="n">sumElements2</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>


<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-cyan-fg">t</span>: <span class="ansi-green-fg">MyTree</span>[<span class="ansi-green-fg">Int</span>] = Node(1,Empty(),Empty())
<span class="ansi-cyan-fg">res22_1</span>: <span class="ansi-green-fg">Int</span> = <span class="ansi-green-fg">1</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span>
</pre></div>

</div>
</div>
</div>

</div>
  </div>

</div>

<div class="two wide column">

</div>


        <div class="two wide column"></div>

        <div class="twelve wide column">
          <hr />
          <div id="disqus_thread" class = "ui segment"></div>
          <script>

          /**
          *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
          *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
          /*
          var disqus_config = function () {
          this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
          };
          */
          (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          s.src = 'https://shinjayne.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

        </div>

        <div class="two wide column"></div>



        <div class="two wide column">
        </div>
        <div class="twelve wide column">
          <hr />
          <p>
            powered by <a>Jupyter NoteBook</a> / <a>Jekyll</a> / <a>BootStrap</a> / <a>Semantic-UI</a> / <a>Github Pages</a>
          </p>
          <p>
            source code available on <a href="https://github.com/shinjayne/shinjayne.github.io">here</a>
          </p>

        </div>
        <div class="two wide column">
        </div>



      </div>






    </div>
  </body>
</html>
